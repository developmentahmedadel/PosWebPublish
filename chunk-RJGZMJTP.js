import{g as ee,h as te,j as ae,s as re}from"./chunk-PPWB5S3T.js";import{a as ie,b as ne}from"./chunk-FF7KVUSC.js";import{i as Z}from"./chunk-VNF6RC2R.js";import{a as oe}from"./chunk-H6HTMPGV.js";import"./chunk-GKF6IR3T.js";import"./chunk-76NAH4W4.js";import"./chunk-O7NQZYPY.js";import{k as X}from"./chunk-EWI5J5KH.js";import{a as G,b as H,c as U,d as Y}from"./chunk-X4LTGZKH.js";import{c as q,d as J,g as K}from"./chunk-OFZNSK7N.js";import{F as W,I as $,N as Q,Q as L,_ as z,d as j,i as N}from"./chunk-CXJLKQ4R.js";import{$b as y,Cb as a,Db as n,Eb as O,Ib as M,Mb as C,Nb as f,Wb as x,X as P,Xb as o,Yb as T,Zb as m,_b as A,ac as w,bc as D,db as t,dc as R,eb as b,ec as E,na as V,nc as s,oc as c,pc as k,vb as v,xa as S,xb as g,ya as I}from"./chunk-J5UB44FZ.js";import{a as B,b as F}from"./chunk-3EYC4JTX.js";var le=()=>({"min-width":"50rem"}),pe=()=>["Name","Storage","Code"];function se(i,d){if(i&1&&(a(0,"small",33),o(1),n()),i&2){let r=f();t(),A("Loaded ",r.Storages.length," of ",r._SharedObjectModelService.TotalItems,"")}}function ce(i,d){if(i&1&&o(0),i&2){let r=d.item;m(" ",r.Name," ")}}function de(i,d){if(i&1&&(a(0,"small",33),o(1),n()),i&2){let r=f();t(),A("Loaded ",r.Items.length," of ",r._SharedObjectModelService.TotalItems,"")}}function me(i,d){if(i&1&&o(0),i&2){let r=d.item;m(" ",r.NameAndCode," ")}}function _e(i,d){i&1&&(a(0,"tr")(1,"th",32),o(2),s(3,"translate"),n(),a(4,"th",32),o(5),s(6,"translate"),n(),a(7,"th",32),o(8),s(9,"translate"),n(),a(10,"th",32),o(11),s(12,"translate"),n(),a(13,"th",32),o(14),s(15,"translate"),n(),a(16,"th",32),o(17),s(18,"translate"),n(),a(19,"th",32),o(20),s(21,"translate"),n(),a(22,"th",32),o(23),s(24,"translate"),n(),a(25,"th",32),o(26),s(27,"translate"),n(),a(28,"th",32),o(29),s(30,"translate"),n(),a(31,"th",32),o(32),s(33,"translate"),n(),a(34,"th",32),o(35,"-"),n()()),i&2&&(t(2),T(c(3,11,"Table.Name")),t(3),T(c(6,13,"Table.CreateDate")),t(3),T(c(9,15,"Table.Quantity")),t(3),T(c(12,17,"Table.Total")),t(3),T(c(15,19,"Table.Storage")),t(3),T(c(18,21,"Table.Type")),t(3),T(c(21,23,"Table.DocNo")),t(3),T(c(24,25,"Table.DocType")),t(3),T(c(27,27,"Table.QuntityCumulative")),t(3),T(c(30,29,"Table.WA")),t(3),T(c(33,31,"Table.TotalCumulative")))}function he(i,d){i&1&&(a(0,"span",35),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.In")," "))}function ue(i,d){i&1&&(a(0,"span",35),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.Out")," "))}function ge(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.Sale")," "))}function Se(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.SaleReturn")," "))}function Ie(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.Buy")," "))}function Te(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.BuyReturn")," "))}function fe(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.Transfer")," "))}function ve(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.StoreAdjustmet")," "))}function xe(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.CreateInitGlRecept")," "))}function Ce(i,d){i&1&&(a(0,"span",34),o(1),s(2,"translate"),n()),i&2&&(t(),m(" ",c(2,1,"DocType.TransferBanches")," "))}function Me(i,d){if(i&1&&(a(0,"span",35),o(1),n()),i&2){let r=f().$implicit;t(),m(" ",r.OutInOutQty.toFixed(2),"")}}function ye(i,d){if(i&1&&(a(0,"span",44),o(1),n()),i&2){let r=f().$implicit;t(),m(" ",r.OutInOutQty.toFixed(2),"")}}function we(i,d){if(i&1&&(a(0,"span",35),o(1),n()),i&2){let r=f().$implicit;t(),m(" ",r.OutInPrice.toFixed(2),"")}}function De(i,d){if(i&1&&(a(0,"span",44),o(1),n()),i&2){let r=f().$implicit;t(),m(" ",r.OutInPrice.toFixed(2),"")}}function Pe(i,d){if(i&1){let r=M();a(0,"tr")(1,"td")(2,"span",34),o(3),n()(),a(4,"td")(5,"span",34),o(6),s(7,"date"),n()(),a(8,"td")(9,"span",35),o(10),n()(),a(11,"td")(12,"span",35),o(13),n()(),a(14,"td",36)(15,"span",34),o(16),n()(),a(17,"td"),v(18,he,3,3,"span",37)(19,ue,3,3,"span",37),n(),a(20,"td",38)(21,"span",35),o(22),n()(),a(23,"td"),v(24,ge,3,3,"span",39)(25,Se,3,3,"span",40)(26,Ie,3,3,"span",39)(27,Te,3,3,"span",39)(28,fe,3,3,"span",39)(29,ve,3,3,"span",39)(30,xe,3,3,"span",40)(31,Ce,3,3,"span",39),n(),a(32,"td"),v(33,Me,2,1,"span",37)(34,ye,2,1,"span",41),n(),a(35,"td")(36,"span",35),o(37),n()(),a(38,"td"),v(39,we,2,1,"span",37)(40,De,2,1,"span",41),n(),a(41,"td")(42,"button",42),C("click",function(){let l=S(r).$implicit,e=f();return I(e._SharedObjectModelService.ShowDocument(l.DocType,l.DocNo))}),o(43),s(44,"translate"),O(45,"i",43),n()()()}if(i&2){let r=d.$implicit,p=f();t(3),m(" ",r.ProductName,""),t(3),m(" ",k(7,23,r.DocDate,"d-M-yyyy h:mm:ss a")," "),t(4),m(" ",r.Qty,""),t(3),m(" ",r.TotalAfterVat.toFixed(2),""),t(3),m(" ",r.StoreName," "),t(2),g("ngIf",r.StockType==1),t(),g("ngIf",r.StockType==2),t(3),m(" ",r.DocNo," "),t(2),g("ngIf",r.DocType==1),t(),g("ngIf",r.DocType==2),t(),g("ngIf",r.DocType==3),t(),g("ngIf",r.DocType==4),t(),g("ngIf",r.DocType==5),t(),g("ngIf",r.DocType==11),t(),g("ngIf",r.DocType==12&&r.StockType==1),t(),g("ngIf",r.DocType==15),t(2),g("ngIf",r.OutInOutQty>=0),t(),g("ngIf",r.OutInOutQty<0),t(3),T(r.WA.toFixed(2)),t(2),g("ngIf",r.OutInPrice>=0),t(),g("ngIf",r.OutInPrice<0),t(2),g("disabled",p._AppModeService.DisabledButton),t(),m("",c(44,26,"Table.Show")," ")}}function be(i,d){if(i&1){let r=M();a(0,"p-paginator",45),C("onPageChange",function(l){S(r);let e=f();return I(e.onPageChange(l))}),n()}if(i&2){let r=f();g("first",r.first)("rows",r.rows)("totalRecords",r.Paging.TotalItems)("rowsPerPageOptions",r._Apiservice.RowCount)}}function Ae(i,d){if(i&1){let r=M();a(0,"p-paginator",46),C("onPageChange",function(l){S(r);let e=f();return I(e.onPageChange(l))}),n()}if(i&2){let r=f();g("first",r.first)("rows",r.rows)("totalRecords",r.Paging.TotalItems)}}var Xe=(()=>{let d=class d{constructor(p,l,e){this._SharedObjectModelService=p,this._AppModeService=l,this._Apiservice=e,this.Paging={PageSize:0,CurrentPage:0,TotalPages:0,TotalItems:0,DataReturn:void 0},this.SearchModel={FromDate:"",ToDate:"",StoreId:null,ProductId:null},this.Storages=[],this.Items=[],this.ItemBalance=0,this.AverageCost=0,this.TotalCapital=0,this.Arr=[],this.first=1,this.rows=10}ngOnInit(){this.SearchModel.FromDate=new Date(this._Apiservice.FromDate()),this.SearchModel.ToDate=new Date(this._Apiservice.ToNowDate())}ChangeSearchApi(p,l){let e=`${l.searchTerm}`.trim();(e==""||e=="null")&&(l.searchTerm="",e=""),this._AppModeService.CurrentPage+=1;let _={TableName:p,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:e,SearchField:"Name"};p=="Storages"&&(_.BranchFilter=!0),p=="Items"&&(_.Columns=["Id","Name","Code"],_.Conditions="ProductType != 2"),this._Apiservice.post("Global/GetAll",_,!1).pipe(P(this._Apiservice.destroy$)).subscribe({next:h=>{h.IsSuccess==!0&&h.Obj!=null?this.HandleResponse(h.Obj,p):this._AppModeService._Toastr.error(h.Message)}})}HandleResponse(p,l){this._SharedObjectModelService.TotalItems=p.TotalItems,l=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(p.DataReturn),"Id")),l=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(p.DataReturn),"Id"),this.Items=this.Items.map(e=>F(B({},e),{NameAndCode:`${e.Name} - ${e.Code}`})))}SelectValue(p,l){if(p!=null&&(p>0||p!="")){let e=[];l=="Store"&&(e=this.Storages),l=="Product"&&(e=this.Items);let _=e.find(h=>h.Id==p);if(_==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${l}Id`]=p,this.SearchModel[`${l}Name`]=_.Name,l=="Branch"&&(this.SearchModel.StoreId=null)}else this.SearchModel[`${l}Id`]=null,this.SearchModel[`${l}Name`]=""}onPageChange(p){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}p.page++,p.first,p.rows,this.rows=p.rows,this.first=p.first;let l={CurrentPage:p.page,PageSize:p.rows,FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId};this._Apiservice.post("ItemEP/ProductTransaction",l,!0).pipe(P(this._Apiservice.destroy$)).subscribe({next:e=>{e.IsSuccess==!0?(console.log(e),this.Paging.CurrentPage=e.Obj.CurrentPage,this.Paging.TotalItems=e.Obj.TotalItems,this.Arr=e.Obj.DataReturn,this.ItemBalance=0,this.AverageCost=0,this.TotalCapital=0,this.ItemBalance=e.OutInQty,this.AverageCost=e.WA.toFixed(2),this.TotalCapital=e.OutInPrice.toFixed(2)):this._AppModeService._Toastr.error(e.Message)}})}Search(){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}let p={FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId,CurrentPage:1,PageSize:this.rows};if(this._Apiservice.ValidateDate(p.FromDate,p.ToDate)==!1){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("StatementOfFinancial.Error.SmallDate"));return}this._Apiservice.post("ItemEP/ProductTransaction",p,!0).pipe(P(this._Apiservice.destroy$)).subscribe({next:l=>{l.IsSuccess==!0?(this.Paging.CurrentPage=l.Obj.CurrentPage,this.Paging.TotalItems=l.Obj.TotalItems,this.Arr=l.Obj.DataReturn,this.ItemBalance=0,this.AverageCost=0,this.TotalCapital=0,this.ItemBalance=l.OutInQty,this.AverageCost=l.WA.toFixed(2),this.TotalCapital=l.OutInPrice.toFixed(2)):this._AppModeService._Toastr.error(l.Message)}})}trackByMethod(p,l){return l.Id}ngOnDestroy(){this._Apiservice.destroy$.next(),this._Apiservice.destroy$.complete()}};d.\u0275fac=function(l){return new(l||d)(b(oe),b(K),b($))},d.\u0275cmp=V({type:d,selectors:[["app-item-transaction"]],standalone:!0,features:[R],decls:70,vars:59,consts:[["ddddd",""],["dddd",""],["SelectFromStore",""],["dt1",""],["clas","bg-light"],["id","container-page",1,"container-page","me-2"],[1,"page-wrapper"],[1,"main-content"],[1,"inner-box"],[1,"title-box","font-weight-normal"],[1,"d-flex","flex-wrap","justify-content-center","align-items-end"],[1,"col-12","col-md-2","px-1"],[1,"my-1"],[1,"formdate"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","showClear","appendTo","showOtherMonths","ngModel","showTime"],[1,"col-12","col-md-2","px-2"],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],[1,"col-12","col-md-3","px-2"],["for","Item"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-md-3","mx-auto","mt-4","mt-md-0","p-2","text-center"],[1,"btn","btn-success","mx-3","px-5","shadow-none",3,"click"],[1,"col-12","card","p-0","table-responsive","mt-4"],[3,"value","paginator","rows","tableStyle","globalFilterFields"],["pTemplate","header"],["pTemplate","body"],["appendTo","table",3,"first","rows","totalRecords","rowsPerPageOptions","onPageChange",4,"ngIf"],["appendTo","table",3,"first","rows","totalRecords","onPageChange",4,"ngIf"],[1,"table","table-striped","table-hover","my-0","d-none"],[1,"col-1"],[1,"form-text","text-muted"],[1,"text-dark"],[1,"text-dark","text-nowrap"],[1,""],["class","text-dark text-nowrap",4,"ngIf"],[1,"text-nowrap"],["class","text-dark ",4,"ngIf"],["class","text-dark",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-primary","text-white","shadow-none",3,"click","disabled"],[1,"mx-1","pi","pi-search"],[1,"text-danger"],["appendTo","table",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],["appendTo","table",3,"onPageChange","first","rows","totalRecords"]],template:function(l,e){if(l&1){let _=M();a(0,"section",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9),o(6),s(7,"translate"),n(),a(8,"div",10)(9,"div",11)(10,"p",12),o(11),s(12,"translate"),n(),a(13,"div",13,0)(15,"p-calendar",14),D("ngModelChange",function(u){return S(_),w(e.SearchModel.FromDate,u)||(e.SearchModel.FromDate=u),I(u)}),n()()(),a(16,"div",11)(17,"p",12),o(18),s(19,"translate"),n(),a(20,"div",13,1)(22,"p-calendar",14),D("ngModelChange",function(u){return S(_),w(e.SearchModel.ToDate,u)||(e.SearchModel.ToDate=u),I(u)}),n()()(),a(23,"div",15)(24,"p",16),o(25),s(26,"translate"),n(),a(27,"ng-select",17,2),C("clear",function(){return S(_),I(e.Storages=[])})("focus",function(){S(_);let u=x(28);return e.ChangeSearchApi("Storages",u),I(e._AppModeService.ResetCurrentPage())})("keyup",function(){S(_);let u=x(28);return e.ChangeSearchApi("Storages",u),I(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){S(_);let u=x(28);return I(e.ChangeSearchApi("Storages",u))})("close",function(){return S(_),I(e._AppModeService.ResetCurrentPage())})("open",function(){return S(_),I(e._AppModeService.ResetCurrentPage())})("change",function(){return S(_),I(e.SelectValue(e.SearchModel.StoreId,"Store"))}),D("ngModelChange",function(u){return S(_),w(e.SearchModel.StoreId,u)||(e.SearchModel.StoreId=u),I(u)}),v(29,se,2,2,"ng-template",18)(30,ce,1,1,"ng-template",19),n()(),a(31,"div",20)(32,"label",21),o(33),s(34,"translate"),n(),a(35,"ng-select",22,2),C("clear",function(){return S(_),I(e.Items=[])})("focus",function(){S(_);let u=x(28);return e.ChangeSearchApi("Items",u),I(e._AppModeService.ResetCurrentPage())})("keyup",function(){S(_);let u=x(28);return e.ChangeSearchApi("Items",u),I(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){S(_);let u=x(28);return I(e.ChangeSearchApi("Items",u))})("close",function(){return S(_),I(e._AppModeService.ResetCurrentPage())})("open",function(){return S(_),I(e._AppModeService.ResetCurrentPage())})("change",function(){return S(_),I(e.SelectValue(e.SearchModel.ProductId,"Product"))}),D("ngModelChange",function(u){return S(_),w(e.SearchModel.ProductId,u)||(e.SearchModel.ProductId=u),I(u)}),v(37,de,2,2,"ng-template",18)(38,me,1,1,"ng-template",19),n()(),a(39,"div",23)(40,"button",24),C("click",function(){return S(_),I(e.Search())}),o(41),s(42,"translate"),n()()(),a(43,"div",25)(44,"p-table",26,3),v(46,_e,36,33,"ng-template",27)(47,Pe,46,28,"ng-template",28),n(),v(48,be,1,4,"p-paginator",29)(49,Ae,1,3,"p-paginator",30),n(),a(50,"table",31)(51,"thead")(52,"tr")(53,"th",32),o(54),s(55,"translate"),n(),a(56,"th",32),o(57),s(58,"translate"),n(),a(59,"th",32),o(60),s(61,"translate"),n()()(),a(62,"tbody")(63,"tr")(64,"td"),o(65),n(),a(66,"td"),o(67),n(),a(68,"td"),o(69),n()()()()()()()()()}if(l&2){let _=x(14),h=x(21);t(6),m(" ",c(7,39,"ItemTransaction.ItemTransaction")," "),t(5),m(" ",c(12,41,"SupplierAccount.FromDate"),""),t(4),g("showClear",e.SearchModel.FromDate!=null&&e.SearchModel.FromDate!="")("appendTo",_)("showOtherMonths",!0),y("ngModel",e.SearchModel.FromDate),g("showTime",!0),t(3),m(" ",c(19,43,"SupplierAccount.ToDate"),""),t(4),g("showClear",e.SearchModel.ToDate!=null&&e.SearchModel.ToDate!="")("appendTo",h)("showOtherMonths",!0),y("ngModel",e.SearchModel.ToDate),g("showTime",!0),t(3),T(c(26,45,"BalanceItemBranch.Store")),t(2),g("items",e.Storages)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",e.SearchModel.StoreId),t(6),m(" ",c(34,47,"BalanceStorage.ItemId"),""),t(2),g("items",e.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",e.SearchModel.ProductId),t(6),T(c(42,49,"Model.Search")),t(3),g("value",e.Arr)("paginator",!1)("rows",e.rows)("tableStyle",E(57,le))("globalFilterFields",E(58,pe)),t(4),g("ngIf",e.Paging.TotalItems>=10),t(),g("ngIf",e.Paging.TotalItems<10),t(5),T(c(55,51,"ItemTransaction.ItemBalance")),t(3),T(c(58,53,"ItemTransaction.AverageCost")),t(3),T(c(61,55,"ItemTransaction.TotalCapital")),t(5),m(" ",e.ItemBalance," "),t(2),m(" ",e.AverageCost," "),t(2),m(" ",e.TotalCapital," ")}},dependencies:[te,ee,X,Q,L,ne,ie,Z,re,ae,W,j,z,N,J,q,Y,U,G,H]});let i=d;return i})();export{Xe as ItemTransactionComponent};
