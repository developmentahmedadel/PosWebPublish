import{j as ie}from"./chunk-GCFZKOIQ.js";import"./chunk-QI74C7BQ.js";import"./chunk-PWIKXZ6E.js";import{j as Z,n as ee,s as te}from"./chunk-VTL7OYUD.js";import"./chunk-73GIXY73.js";import{h as X,i as Y}from"./chunk-WL6N6SLT.js";import{a as ne}from"./chunk-64BGN5RD.js";import"./chunk-34JSETBR.js";import"./chunk-QFTVA365.js";import"./chunk-LNYZIAUP.js";import{k as Q}from"./chunk-HYE6JRVA.js";import{d as L}from"./chunk-YTUM3KNK.js";import{b as J}from"./chunk-BEBWNCBB.js";import{c as W,f as $,h as U,k as z,u as K}from"./chunk-SLSEXWRZ.js";import{c as q,d as H}from"./chunk-4L6P5Z5M.js";import{G as D,e as j}from"./chunk-JM67XKKX.js";import{$b as N,Bb as r,Cb as p,Db as V,Hb as y,Lb as x,Mb as h,Pb as C,Qb as w,Vb as O,Wb as d,Xb as G,Yb as v,_b as I,ac as E,cb as c,cc as F,db as M,dc as P,mc as b,na as k,nc as R,pc as B,ub as A,wb as u,xa as g,ya as S}from"./chunk-VIO7ZK3G.js";import"./chunk-3EYC4JTX.js";var oe=()=>({"min-width":"50rem"}),le=()=>["Name"];function re(o,a){o&1&&(r(0,"span"),d(1),b(2,"translate"),p()),o&2&&(c(),v(" ",R(2,1,"Model.Save"),""))}function pe(o,a){o&1&&(r(0,"span"),d(1),b(2,"translate"),p()),o&2&&(c(),v(" ",R(2,1,"Model.Update"),""))}function ae(o,a){if(o&1){let n=y();r(0,"div",8)(1,"div",9)(2,"p-button",10),x("onClick",function(){g(n);let e=h(2);return S(e.ExpandAll())}),p(),r(3,"p-button",11),x("onClick",function(){g(n);let e=h(2);return S(e.CollapseAll())}),p(),r(4,"div",12)(5,"input",13),x("change",function(e){g(n);let i=h(2);return S(i.SelectAll(e))}),p()()(),r(6,"div",14)(7,"input",15),b(8,"translate"),E("ngModelChange",function(e){g(n);let i=h(2);return N(i.RoleGroup.Name,e)||(i.RoleGroup.Name=e),S(e)}),p()(),r(9,"div",14)(10,"input",16),b(11,"translate"),E("ngModelChange",function(e){g(n);let i=h(2);return N(i.RoleGroup.Notes,e)||(i.RoleGroup.Notes=e),S(e)}),p()(),r(12,"div",17)(13,"button",18),x("click",function(){g(n);let e=h(2);return S(e.Send())}),A(14,re,3,3,"span",19)(15,pe,3,3,"span",19),p(),r(16,"button",20),x("click",function(){g(n);let e=h().$implicit;return S(e.close("close"))}),d(17),b(18,"translate"),p()()()}if(o&2){let n=h(2);c(5),C("value",-1),u("checked",n.RoleGroup.SelectAll==!0),c(2),C("placeholder",R(8,9,"Table.Name")),I("ngModel",n.RoleGroup.Name),c(3),C("placeholder",R(11,11,"Table.Notes")),I("ngModel",n.RoleGroup.Notes),c(4),u("ngIf",n.RoleGroup.Id==0),c(),u("ngIf",n.RoleGroup.Id!=0),c(2),G(R(18,13,"Model.Close"))}}function ce(o,a){o&1&&(r(0,"tr")(1,"th",21),d(2,"#"),p(),r(3,"th",21),d(4),b(5,"translate"),p(),r(6,"th"),d(7,"-"),p()()),o&2&&(c(4),G(R(5,1,"RoleGroup.SectionName")))}function se(o,a){if(o&1&&V(0,"p-button",27),o&2){let n=h(),t=n.$implicit,e=n.expanded,i=h(2);u("pRowToggler",t)("text",!0)("rounded",!0)("plain",!0)("icon",e?"pi pi-chevron-down":i._Apiservice.Language=="ar"?"pi pi-chevron-left":"pi pi-chevron-right")}}function _e(o,a){if(o&1){let n=y();r(0,"tr")(1,"td"),A(2,se,1,5,"p-button",22),p(),r(3,"td")(4,"span",23),d(5),p()(),r(6,"td",24)(7,"label",25)(8,"input",26),x("change",function(){let e=g(n).$implicit;return S(e.Visible=!e.Visible)}),p()()()()}if(o&2){let n=a.$implicit,t=a.rowIndex;c(2),u("ngIf",n.ScreenType==1&&n.Screen>1),c(3),v(" ",n.Name,""),c(2),w("for","country",t,""),c(),w("id","country",t,""),C("value",n.Id),u("checked",n.Visible==!0)}}function me(o,a){o&1&&(r(0,"tr")(1,"th"),d(2,"-"),p(),r(3,"th"),d(4),b(5,"translate"),p(),r(6,"th"),d(7," - "),p()()),o&2&&(c(4),v("",R(5,1,"RoleGroup.ScreenName")," "))}function de(o,a){if(o&1){let n=y();r(0,"tr")(1,"td"),V(2,"p-button",27),p(),r(3,"td")(4,"span",23),d(5),p()(),r(6,"td")(7,"label",25)(8,"input",26),x("change",function(){let e=g(n).$implicit;return S(e.Visible=!e.Visible)}),p()()()()}if(o&2){let n=a.$implicit,t=a.Subexpanded,e=a.rowIndex,i=h(3);c(2),u("pRowToggler",n)("text",!0)("rounded",!0)("plain",!0)("icon",t?"pi pi-chevron-down":i._Apiservice.Language=="ar"?"pi pi-chevron-left":"pi pi-chevron-right"),c(3),v(" ",n.Name," "),c(2),w("for","SubScreen",e,""),c(),w("id","SubScreen",e,""),C("value",n.Id),u("checked",n.Visible==!0)}}function ue(o,a){o&1&&(r(0,"tr")(1,"th",30),d(2),b(3,"translate"),p(),r(4,"th",30),d(5," - "),p()()),o&2&&(c(2),v("",R(3,1,"RoleGroup.ActionName")," "))}function ge(o,a){if(o&1){let n=y();r(0,"tr")(1,"td")(2,"span",23),d(3),p()(),r(4,"td")(5,"span",23)(6,"label",25)(7,"input",26),x("change",function(){let e=g(n).$implicit;return S(e.Visible=!e.Visible)}),p()()()()()}if(o&2){let n=a.$implicit,t=a.rowIndex;c(3),v(" ",n.Name," "),c(3),w("for","Action",t,""),c(),w("id","Action",t,""),C("value",n.Id),u("checked",n.Visible==!0)}}function Se(o,a){if(o&1&&(r(0,"tr")(1,"td",28)(2,"p-table",29),A(3,ue,6,3,"ng-template",5)(4,ge,8,7,"ng-template",6),p()()()),o&2){let n=a.$implicit;c(2),u("value",n.ViewActions)}}function he(o,a){if(o&1&&(r(0,"tr")(1,"td",28)(2,"p-table",29),A(3,me,8,3,"ng-template",5)(4,de,9,12,"ng-template",6)(5,Se,5,1,"ng-template",7),p()()()),o&2){let n=a.$implicit;c(2),u("value",n.RoleScreens)}}function fe(o,a){if(o&1&&(r(0,"p-table",3,1),A(2,ae,19,15,"ng-template",4)(3,ce,8,3,"ng-template",5)(4,_e,9,8,"ng-template",6)(5,he,6,1,"ng-template",7),p()),o&2){let n=h();u("expandedRowKeys",n.expandedRows)("value",n.RoleScreenForSelect)("paginator",!1)("tableStyle",P(5,oe))("globalFilterFields",P(6,le))}}var Oe=(()=>{let a=class a{constructor(t,e,i){this._SharedObjectModelService=t,this._AppModeService=e,this._Apiservice=i,this.TablePaging={InputType:"Table",Type:"TablePaging",GlobalData:{Url:"Global/GetAll",TableName:"RoleGroup",Columns:["Id","Name","Notes"]},Required:!1,TableCell:[{SortName:"Name",CellName:"Table.Name"},{SortName:"Notes",CellName:"Table.Notes"}]},this.SubscriptionArr=[],this.RoleGroup={RoleScreens:[],Id:0,Name:"",Notes:"",Code:"",SelectAll:!1},this.expandedRows={},this.RoleScreenForSelect=[]}ngOnInit(){}OpenModal(){this.GetPageInfo(),this.ResetPage()}ConvertRole(t){this.RoleScreenForSelect=[];for(let e=0;e<t.length;e++){let i=t[e];i.ParentNo==0&&(i.RoleScreens=t.filter(l=>l.ParentNo==i.Screen),this.RoleScreenForSelect.push(i))}}GetPageInfo(){let t=this._Apiservice.get("RoleGroupEP/GetPageInfo",!1).subscribe({next:e=>{e.IsSuccess==!0&&e.Obj!=null?this.ConvertRole(e.Obj):this._AppModeService._Toastr.error(e.Message)}});this.SubscriptionArr.push(t)}ExpandAll(){this.expandedRows=this.RoleScreenForSelect.reduce((t,e)=>(t[e.Screen]=!0)&&t,{})}CollapseAll(){this.expandedRows={}}ShowToEdite(){this.RoleGroup.Id=this._SharedObjectModelService.PageModel.model.Id,this.RoleGroup.Name=this._SharedObjectModelService.PageModel.model.Name,this.RoleGroup.Notes=this._SharedObjectModelService.PageModel.model.Notes,this.RoleGroup.SelectAll=this._SharedObjectModelService.PageModel.model.SelectAll;let t=this._SharedObjectModelService.PageModel.RoleScreens,e=this._SharedObjectModelService.PageModel.model.RoleScreens;for(let i=0;i<t.length;i++){let l=t[i],s=e.find(_=>_.Screen==l.Screen);if(s!=null){l.Visible=s.Visible;for(let _=0;_<l.ViewActions.length;_++){let m=l.ViewActions[_],f=s.ViewActions.find(T=>T.Action==m.Action);f!=null&&(f.Visible=m.Visible)}}}this.ConvertRole(t)}SelectAll(t){let e=t.target.checked;for(let i=0;i<this.RoleScreenForSelect.length;i++){let l=this.RoleScreenForSelect[i];l.Visible=e;for(let s=0;s<l.RoleScreens.length;s++){let _=l.RoleScreens[s];_.Visible=e;for(let m=0;m<_.ViewActions.length;m++){let f=_.ViewActions[m];f.Visible=e}}}}Send(){if(this.RoleGroup.Name.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("RoleGroup.Error.NameAr"));return}let t=[];for(let i=0;i<this.RoleScreenForSelect.length;i++){let l={Id:0,Name:"",Visible:!1,Screen:0,ScreenType:0,SelectAll:!1,ParentNo:0,ViewActions:[]},s=this.RoleScreenForSelect[i];s.Visible&&(l={Id:s.Id,Name:s.Name,Visible:!0,Screen:s.Screen,ScreenType:s.ScreenType,SelectAll:s.SelectAll,ParentNo:s.ParentNo,ViewActions:[]},t.push(l));for(let _=0;_<s.RoleScreens.length;_++){let m=s.RoleScreens[_];m.Visible&&(l={Id:m.Id,Name:m.Name,Visible:!0,Screen:m.Screen,ScreenType:m.ScreenType,SelectAll:m.SelectAll,ParentNo:m.ParentNo,ViewActions:[]},t.push(l));for(let f=0;f<m.ViewActions.length;f++){let T=m.ViewActions[f];T.Visible&&l.ViewActions.push(T)}if(l.Screen>0){let f=l.ViewActions;if(l.ScreenType>=2&&f.length==0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("RoleGroup.Error.Action")+" "+(_+1));return}}}}if(t.length<=0||t.filter(i=>i.ScreenType>=2).length==0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("RoleGroup.Error.SelectOneRole"));return}let e={Id:this.RoleGroup.Id,Name:this.RoleGroup.Name,Code:"",SelectAll:this.RoleGroup.SelectAll,RoleScreens:t};if(e.Id==0){let i=this._Apiservice.post("RoleGroupEP/Add",e,!0).subscribe({next:l=>{l.IsSuccess==!0&&l.Obj!=null?(this._AppModeService._Toastr.success(l.Message),this.ResetPage()):this._AppModeService._Toastr.error(l.Message)}});this.SubscriptionArr.push(i)}if(e.Id>0){let i=this._Apiservice.put("RoleGroupEP/Update",e,!0).subscribe({next:l=>{l.IsSuccess==!0&&l.Obj!=null?(this._AppModeService._Toastr.success(l.Message),this.ResetPage()):this._AppModeService._Toastr.error(l.Message)}});this.SubscriptionArr.push(i)}}ResetPage(){this.RoleGroup={SelectAll:!1,RoleScreens:[],Id:0,Name:"",Notes:"",Code:""};for(let t=0;t<this.RoleScreenForSelect.length;t++){let e=this.RoleScreenForSelect[t];e.Visible=!1;for(let i=0;i<e.RoleScreens.length;i++){let l=e.RoleScreens[i];l.Visible=!1;for(let s=0;s<l.ViewActions.length;s++){let _=l.ViewActions[s];_.Visible=!1}}}}ngOnDestroy(){this._AppModeService._NgbModal.dismissAll();for(let t=0;t<this.SubscriptionArr.length;t++)this.SubscriptionArr[t].unsubscribe()}};a.\u0275fac=function(e){return new(e||a)(M(ne),M(J),M(W))},a.\u0275cmp=k({type:a,selectors:[["app-role-group"]],standalone:!0,features:[F],decls:3,vars:6,consts:[["content",""],["dt1",""],[3,"OpenModalEvent","ShowToEditeEvent","PageTitle","TablePaging","FullScreen","GetById","DeleteUrl","OutModal"],["dataKey","Screen",3,"expandedRowKeys","value","paginator","tableStyle","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[1,"d-flex","flex-wrap","justify-content-between","align-items-center","py-3","px-4"],[1,"col-12","col-sm-3","d-flex","flex-wrap","align-items-center"],["label","Expand All","icon","pi pi-plus","text","",1,"mx-2",3,"onClick"],["label","Collapse All","icon","pi pi-minus","text","",1,"mx-2",3,"onClick"],[1,"text-center","mx-3"],["type","checkbox","id","SelectAll",1,"form-check-input","mx-auto",3,"change","checked","value"],[1,"col-12","col-sm-3","px-2"],["id","Name","type","text",1,"form-control","shadow-none","text-center",3,"ngModelChange","ngModel","placeholder"],["id","Notes","type","text",1,"form-control","shadow-none","text-center",3,"ngModelChange","ngModel","placeholder"],[1,"col-12","col-sm-3","text-start"],[1,"mx-2","px-5","py-3","btn","btn-success",3,"click"],[4,"ngIf"],[1,"mx-2","px-5","py-3","btn","btn-secondary",3,"click"],[1,"col-2"],["type","button","pRipple","",3,"pRowToggler","text","rounded","plain","icon",4,"ngIf"],[1,"text-dark"],[1,"cursor","p-0"],[1,"form-check-label","my-3","col-12","text-center","text-transparent",3,"for"],["type","checkbox",1,"form-check-input","mx-auto",3,"change","checked","id","value"],["type","button","pRipple","",3,"pRowToggler","text","rounded","plain","icon"],["colspan","7",1,"p-0"],["dataKey","Screen",3,"value"],[1,"col-6"]],template:function(e,i){if(e&1){let l=y();r(0,"app-dynamic-component",2),x("OpenModalEvent",function(){return g(l),S(i.OpenModal())})("ShowToEditeEvent",function(){return g(l),S(i.ShowToEdite())}),p(),A(1,fe,6,7,"ng-template",null,0,B)}if(e&2){let l=O(2);u("PageTitle","RoleGroup.AddRoleGroup")("TablePaging",i.TablePaging)("FullScreen",!0)("GetById","RoleGroupEP/GetById")("DeleteUrl","RoleGroupEP/Delete")("OutModal",l)}},dependencies:[te,Z,Q,ee,Y,X,K,$,U,z,D,H,q,j,L,ie],styles:["input.form-check-input[_ngcontent-%COMP%]{width:2rem!important;height:2rem!important}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:transparent!important}td.cursor[_ngcontent-%COMP%], td.cursor[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer}"]});let o=a;return o})();export{Oe as RoleGroupComponent};
