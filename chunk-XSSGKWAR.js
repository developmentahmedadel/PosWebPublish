import{g as ee,h as te,o as ae,x as re}from"./chunk-BHSN7HFD.js";import{a as ie,b as ne}from"./chunk-6BJKXUWP.js";import"./chunk-3Y7UQ2M3.js";import{a as oe}from"./chunk-LUZO7NCR.js";import{h as Z}from"./chunk-VUX2NRX2.js";import"./chunk-RXBBGPQB.js";import"./chunk-GEJP5WQO.js";import"./chunk-GNF256I6.js";import{a as Y,b as q,c as J,d as K}from"./chunk-MZIKAFPE.js";import"./chunk-EGE4BGUH.js";import{k as X}from"./chunk-RVJIMCIT.js";import{c as U}from"./chunk-NUFVOF6D.js";import{c as z,d as L}from"./chunk-KALZ37GW.js";import{c as $,h as Q,k as G,u as H}from"./chunk-N4FWSTCP.js";import{G as W,e as k,j as N}from"./chunk-VTADEU6K.js";import{$b as y,Cb as r,Db as n,Eb as E,Ib as x,Mb as M,Nb as f,Wb as C,X as D,Xb as o,Yb as T,Zb as d,_b as A,ac as w,bc as P,db as i,dc as j,eb as b,ec as O,na as F,nc as c,oc as m,pc as R,vb as v,xa as u,xb as h,ya as I}from"./chunk-J5UB44FZ.js";import{a as V,b as B}from"./chunk-3EYC4JTX.js";var le=()=>({"min-width":"50rem"}),pe=()=>["Name","Storage","Code"];function se(e,s){if(e&1&&(r(0,"small",27),o(1),n()),e&2){let a=f();i(),A("Loaded ",a.Storages.length," of ",a._SharedObjectModelService.TotalItems,"")}}function ce(e,s){if(e&1&&o(0),e&2){let a=s.item;d(" ",a.Name," ")}}function de(e,s){if(e&1&&(r(0,"small",27),o(1),n()),e&2){let a=f();i(),A("Loaded ",a.Items.length," of ",a._SharedObjectModelService.TotalItems,"")}}function me(e,s){if(e&1&&o(0),e&2){let a=s.item;d(" ",a.NameAndCode," ")}}function _e(e,s){e&1&&(r(0,"tr")(1,"th",28),o(2),c(3,"translate"),n(),r(4,"th",28),o(5," \u0627\u0644\u062C\u0647\u0629 "),n(),r(6,"th",28),o(7),c(8,"translate"),n(),r(9,"th",28),o(10),c(11,"translate"),n(),r(12,"th",28),o(13),c(14,"translate"),n(),r(15,"th",28),o(16),c(17,"translate"),n(),r(18,"th",28),o(19),c(20,"translate"),n(),r(21,"th",28),o(22),c(23,"translate"),n(),r(24,"th",28),o(25),c(26,"translate"),n(),r(27,"th",28),o(28),c(29,"translate"),n(),r(30,"th",28),o(31),c(32,"translate"),n(),r(33,"th",28),o(34),c(35,"translate"),n(),r(36,"th",28),o(37,"-"),n()()),e&2&&(i(2),T(m(3,11,"Table.Name")),i(5),T(m(8,13,"Table.DocDate")),i(3),T(m(11,15,"Table.Quantity")),i(3),T(m(14,17,"Table.Total")),i(3),T(m(17,19,"Table.Storage")),i(3),T(m(20,21,"Table.Type")),i(3),T(m(23,23,"Table.DocNo")),i(3),T(m(26,25,"Table.DocType")),i(3),T(m(29,27,"Table.QuntityCumulative")),i(3),T(m(32,29,"Table.WA")),i(3),T(m(35,31,"Table.TotalCumulative")))}function Se(e,s){e&1&&(r(0,"span",30),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.In")," "))}function ge(e,s){e&1&&(r(0,"span",30),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Out")," "))}function he(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Sale")," "))}function ue(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.SaleReturn")," "))}function Ie(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Buy")," "))}function Te(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.BuyReturn")," "))}function fe(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Transfer")," "))}function ve(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.StoreAdjustmet")," "))}function Me(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.CreateInitGlRecept")," "))}function Ce(e,s){e&1&&(r(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.TransferBanches")," "))}function xe(e,s){if(e&1&&(r(0,"span",30),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInOutQty,"")}}function ye(e,s){if(e&1&&(r(0,"span",39),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInOutQty,"")}}function we(e,s){if(e&1&&(r(0,"span",30),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInPrice,"")}}function Pe(e,s){if(e&1&&(r(0,"span",39),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInPrice,"")}}function De(e,s){if(e&1){let a=x();r(0,"tr")(1,"td")(2,"span",29),o(3),n()(),r(4,"td")(5,"span",29),o(6),n()(),r(7,"td")(8,"span",29),o(9),c(10,"date"),n()(),r(11,"td")(12,"span",30),o(13),n()(),r(14,"td")(15,"span",30),o(16),n()(),r(17,"td",31)(18,"span",29),o(19),n()(),r(20,"td"),v(21,Se,3,3,"span",32)(22,ge,3,3,"span",32),n(),r(23,"td",33)(24,"span",30),o(25),n()(),r(26,"td"),v(27,he,3,3,"span",34)(28,ue,3,3,"span",35)(29,Ie,3,3,"span",34)(30,Te,3,3,"span",34)(31,fe,3,3,"span",34)(32,ve,3,3,"span",34)(33,Me,3,3,"span",35)(34,Ce,3,3,"span",34),n(),r(35,"td"),v(36,xe,2,1,"span",32)(37,ye,2,1,"span",36),n(),r(38,"td")(39,"span",30),o(40),n()(),r(41,"td"),v(42,we,2,1,"span",32)(43,Pe,2,1,"span",36),n(),r(44,"td")(45,"button",37),M("click",function(){let l=u(a).$implicit,t=f();return I(t._SharedObjectModelService.ShowDocument(l.DocType,l.DocNo))}),E(46,"i",38),n()()()}if(e&2){let a=s.$implicit,p=f();i(3),d(" ",a.ProductName,""),i(3),d(" ",a.Notes,""),i(3),d(" ",R(10,23,a.DocDate,"d-M-yyyy h:mm:ss a")," "),i(4),d(" ",a.Qty,""),i(3),d(" ",a.TotalAfterVat,""),i(3),d(" ",a.StoreName," "),i(2),h("ngIf",a.StockType==1),i(),h("ngIf",a.StockType==2),i(3),d(" ",a.DocNo," "),i(2),h("ngIf",a.DocType==1),i(),h("ngIf",a.DocType==2),i(),h("ngIf",a.DocType==3),i(),h("ngIf",a.DocType==4),i(),h("ngIf",a.DocType==5),i(),h("ngIf",a.DocType==11),i(),h("ngIf",a.DocType==12&&a.StockType==1),i(),h("ngIf",a.DocType==15),i(2),h("ngIf",a.OutInOutQty>=0),i(),h("ngIf",a.OutInOutQty<0),i(3),T(a.WA),i(2),h("ngIf",a.OutInPrice>=0),i(),h("ngIf",a.OutInPrice<0),i(2),h("disabled",p._AppModeService.DisabledButton)}}function be(e,s){if(e&1){let a=x();r(0,"p-paginator",40),M("onPageChange",function(l){u(a);let t=f();return I(t.onPageChange(l))}),n()}if(e&2){let a=f();h("first",a._SharedObjectModelService.Paging.CurrentPage)("rows",a._SharedObjectModelService.Paging.PageSize)("totalRecords",a._SharedObjectModelService.Paging.TotalItems)("rowsPerPageOptions",a._Apiservice.RowCount)}}function Ee(e,s){if(e&1){let a=x();r(0,"p-paginator",41),M("onPageChange",function(l){u(a);let t=f();return I(t.onPageChange(l))}),n()}if(e&2){let a=f();h("first",a._SharedObjectModelService.Paging.CurrentPage)("rows",a._SharedObjectModelService.Paging.PageSize)("totalRecords",a._SharedObjectModelService.Paging.PageSize)}}var Xe=(()=>{let s=class s{constructor(p,l,t){this._SharedObjectModelService=p,this._AppModeService=l,this._Apiservice=t,this.SearchModel={FromDate:"",ToDate:"",StoreId:null,ProductId:null},this.Storages=[],this.Items=[]}ngOnInit(){this.SearchModel.FromDate=new Date(this._Apiservice.FromDate()),this.SearchModel.ToDate=new Date(this._Apiservice.ToNowDate())}ChangeSearchApi(p,l){let t=`${l.searchTerm}`.trim();(t==""||t=="null")&&(l.searchTerm="",t=""),this._AppModeService.CurrentPage+=1;let _={TableName:p,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:t,SearchField:"Name"};p=="Storages"&&(_.BranchFilter=!0),p=="Items"&&(_.Columns=["Id","Name","Code"],_.Conditions="ProductType != 2"),this._Apiservice.post("Global/GetAll",_,!1).pipe(D(this._Apiservice.destroy$)).subscribe({next:g=>{g.IsSuccess==!0&&g.Obj!=null?this.HandleResponse(g.Obj,p):this._AppModeService._Toastr.error(g.Message)}})}HandleResponse(p,l){this._SharedObjectModelService.TotalItems=p.TotalItems,l=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(p.DataReturn),"Id")),l=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(p.DataReturn),"Id"),this.Items=this.Items.map(t=>B(V({},t),{NameAndCode:`${t.Name} - ${t.Code}`})))}SelectValue(p,l){if(p!=null&&(p>0||p!="")){let t=[];l=="Store"&&(t=this.Storages),l=="Product"&&(t=this.Items);let _=t.find(g=>g.Id==p);if(_==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${l}Id`]=p,this.SearchModel[`${l}Name`]=_.Name,l=="Branch"&&(this.SearchModel.StoreId=null)}else this.SearchModel[`${l}Id`]=null,this.SearchModel[`${l}Name`]=""}onPageChange(p){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}p.page++,p.first,p.rows,this._SharedObjectModelService.Paging.CurrentPage=p.first,this._SharedObjectModelService.Paging.PageSize=p.rows;let l={CurrentPage:p.page,PageSize:this._SharedObjectModelService.Paging.PageSize,FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId};this._Apiservice.post("ItemEP/ProductTransaction",l,!0).pipe(D(this._Apiservice.destroy$)).subscribe({next:t=>{t.IsSuccess==!0?(this._SharedObjectModelService.Paging.DataReturn=t.Obj.DataReturn,this._SharedObjectModelService.Paging.TotalItems=t.Obj.TotalItems):this._AppModeService._Toastr.error(t.Message)}})}Search(){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}this._SharedObjectModelService.Paging.CurrentPage=1;let p={FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId,CurrentPage:1,PageSize:this._SharedObjectModelService.Paging.PageSize};if(this._Apiservice.ValidateDate(p.FromDate,p.ToDate)==!1){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("StatementOfFinancial.Error.SmallDate"));return}this._Apiservice.post("ItemEP/ProductTransaction",p,!0).pipe(D(this._Apiservice.destroy$)).subscribe({next:l=>{l.IsSuccess==!0?(this._SharedObjectModelService.Paging.DataReturn=l.Obj.DataReturn,this._SharedObjectModelService.Paging.TotalItems=l.Obj.TotalItems):this._AppModeService._Toastr.error(l.Message)}})}trackByMethod(p,l){return l.Id}ngOnDestroy(){this._Apiservice.destroy$.next(),this._Apiservice.destroy$.complete()}};s.\u0275fac=function(l){return new(l||s)(b(oe),b(U),b($))},s.\u0275cmp=F({type:s,selectors:[["app-item-transaction"]],standalone:!0,features:[j],decls:47,vars:47,consts:[["SelectFromStore",""],["dt1",""],["clas","bg-light"],[1,"title-box","font-weight-normal"],[1,"min","border"],[1,"d-flex","flex-wrap","align-items-end"],[1,"col-12","col-md-3","p-2"],[1,"my-1"],[1,"formdate"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","ngModel","showTime","showIcon","showOnFocus","showOtherMonths"],[1,"col-12","col-md-3","col-xl-2","p-2"],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],[1,"col-12","col-md-3","col-xl-3","p-2"],["for","Item"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-md-1","p-2","text-center"],[1,"btn-Add","btn",3,"click"],[1,"mx-1","pi","pi-save"],[1,"DivPaging","col-12","card","p-0","table-responsive","mt-4"],[3,"value","paginator","rows","tableStyle","globalFilterFields"],["pTemplate","header"],["pTemplate","body"],["appendTo","table",3,"first","rows","totalRecords","rowsPerPageOptions","onPageChange",4,"ngIf"],["appendTo","table",3,"first","rows","totalRecords","onPageChange",4,"ngIf"],[1,"form-text","text-muted"],[1,"col-1"],[1,"text-dark"],[1,"text-dark","text-nowrap"],[1,""],["class","text-dark text-nowrap",4,"ngIf"],[1,"text-nowrap"],["class","text-dark ",4,"ngIf"],["class","text-dark",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-Show",3,"click","disabled"],[1,"mx-1","pi","pi-search","fw-bold"],[1,"text-danger"],["appendTo","table",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],["appendTo","table",3,"onPageChange","first","rows","totalRecords"]],template:function(l,t){if(l&1){let _=x();r(0,"section",2)(1,"div",3)(2,"h4"),o(3),c(4,"translate"),n()(),r(5,"div",4)(6,"div",5)(7,"div",6)(8,"p",7),o(9),c(10,"translate"),n(),r(11,"div",8)(12,"p-calendar",9),P("ngModelChange",function(S){return u(_),w(t.SearchModel.FromDate,S)||(t.SearchModel.FromDate=S),I(S)}),n()()(),r(13,"div",6)(14,"p",7),o(15),c(16,"translate"),n(),r(17,"div",8)(18,"p-calendar",9),P("ngModelChange",function(S){return u(_),w(t.SearchModel.ToDate,S)||(t.SearchModel.ToDate=S),I(S)}),n()()(),r(19,"div",10)(20,"p",11),o(21),c(22,"translate"),n(),r(23,"ng-select",12,0),M("clear",function(){return u(_),I(t.Storages=[])})("focus",function(){u(_);let S=C(24);return t.ChangeSearchApi("Storages",S),I(t._AppModeService.ResetCurrentPage())})("keyup",function(){u(_);let S=C(24);return t.ChangeSearchApi("Storages",S),I(t._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){u(_);let S=C(24);return I(t.ChangeSearchApi("Storages",S))})("close",function(){return u(_),I(t._AppModeService.ResetCurrentPage())})("open",function(){return u(_),I(t._AppModeService.ResetCurrentPage())})("change",function(){return u(_),I(t.SelectValue(t.SearchModel.StoreId,"Store"))}),P("ngModelChange",function(S){return u(_),w(t.SearchModel.StoreId,S)||(t.SearchModel.StoreId=S),I(S)}),v(25,se,2,2,"ng-template",13)(26,ce,1,1,"ng-template",14),n()(),r(27,"div",15)(28,"label",16),o(29),c(30,"translate"),n(),r(31,"ng-select",17,0),M("clear",function(){return u(_),I(t.Items=[])})("focus",function(){u(_);let S=C(24);return t.ChangeSearchApi("Items",S),I(t._AppModeService.ResetCurrentPage())})("keyup",function(){u(_);let S=C(24);return t.ChangeSearchApi("Items",S),I(t._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){u(_);let S=C(24);return I(t.ChangeSearchApi("Items",S))})("close",function(){return u(_),I(t._AppModeService.ResetCurrentPage())})("open",function(){return u(_),I(t._AppModeService.ResetCurrentPage())})("change",function(){return u(_),I(t.SelectValue(t.SearchModel.ProductId,"Product"))}),P("ngModelChange",function(S){return u(_),w(t.SearchModel.ProductId,S)||(t.SearchModel.ProductId=S),I(S)}),v(33,de,2,2,"ng-template",13)(34,me,1,1,"ng-template",14),n()(),r(35,"div",18)(36,"button",19),M("click",function(){return u(_),I(t.Search())}),o(37),c(38,"translate"),E(39,"i",20),n()()(),r(40,"div",21)(41,"p-table",22,1),v(43,_e,38,33,"ng-template",23)(44,De,47,26,"ng-template",24),n(),v(45,be,1,4,"p-paginator",25)(46,Ee,1,3,"p-paginator",26),n()()()}l&2&&(i(3),T(m(4,33,"ItemTransaction.ItemTransaction")),i(6),d(" ",m(10,35,"SupplierAccount.FromDate"),""),i(3),y("ngModel",t.SearchModel.FromDate),h("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),i(3),d(" ",m(16,37,"SupplierAccount.ToDate"),""),i(3),y("ngModel",t.SearchModel.ToDate),h("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),i(3),T(m(22,39,"BalanceItemBranch.Store")),i(2),h("items",t.Storages)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",t.SearchModel.StoreId),i(6),d(" ",m(30,41,"BalanceStorage.ItemId"),""),i(2),h("items",t.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",t.SearchModel.ProductId),i(6),d("",m(38,43,"Model.Send")," "),i(4),h("value",t._SharedObjectModelService.Paging.DataReturn)("paginator",!1)("rows",t._SharedObjectModelService.Paging.PageSize)("tableStyle",O(45,le))("globalFilterFields",O(46,pe)),i(4),h("ngIf",t._SharedObjectModelService.Paging.TotalItems>=10),i(),h("ngIf",t._SharedObjectModelService.Paging.TotalItems<10))},dependencies:[te,ee,X,Q,G,ne,ie,Z,re,ae,W,k,H,N,L,z,K,J,Y,q],styles:[".min[_ngcontent-%COMP%]{min-height:100vh}"]});let e=s;return e})();export{Xe as ItemTransactionComponent};
