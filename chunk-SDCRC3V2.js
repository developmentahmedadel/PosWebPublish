import{g as ee,h as te,j as ae,s as re}from"./chunk-5VO5RH76.js";import{a as ie,b as ne}from"./chunk-2W5TGM3Y.js";import{i as Z}from"./chunk-CIOY3TMC.js";import{a as oe}from"./chunk-7XIF7JPY.js";import"./chunk-VB2SDBDM.js";import"./chunk-I6L65D3G.js";import"./chunk-KLFZIA63.js";import{k as X}from"./chunk-7FMAHILW.js";import{a as G,b as H,c as U,d as Y}from"./chunk-IBMBVOFU.js";import{c as q,d as J,g as K}from"./chunk-DLDN7W7Q.js";import{F as W,I as $,N as L,Q,_ as z,d as j,i as N}from"./chunk-XINR554T.js";import{$b as w,Cb as r,Db as n,Eb as O,Ib as M,Mb as x,Nb as f,Wb as C,X as P,Xb as o,Yb as T,Zb as d,_b as E,ac as y,bc as D,db as i,dc as R,eb as b,ec as A,na as B,nc as c,oc as m,pc as k,vb as v,xa as S,xb as g,ya as I}from"./chunk-J5UB44FZ.js";import{a as V,b as F}from"./chunk-3EYC4JTX.js";var le=()=>({"min-width":"50rem"}),pe=()=>["Name","Storage","Code"];function se(e,s){if(e&1&&(r(0,"small",30),o(1),n()),e&2){let a=f();i(),E("Loaded ",a.Storages.length," of ",a._SharedObjectModelService.TotalItems,"")}}function ce(e,s){if(e&1&&o(0),e&2){let a=s.item;d(" ",a.Name," ")}}function me(e,s){if(e&1&&(r(0,"small",30),o(1),n()),e&2){let a=f();i(),E("Loaded ",a.Items.length," of ",a._SharedObjectModelService.TotalItems,"")}}function de(e,s){if(e&1&&o(0),e&2){let a=s.item;d(" ",a.NameAndCode," ")}}function _e(e,s){e&1&&(r(0,"tr")(1,"th",31),o(2),c(3,"translate"),n(),r(4,"th",31),o(5," \u0627\u0644\u062C\u0647\u0629 "),n(),r(6,"th",31),o(7),c(8,"translate"),n(),r(9,"th",31),o(10),c(11,"translate"),n(),r(12,"th",31),o(13),c(14,"translate"),n(),r(15,"th",31),o(16),c(17,"translate"),n(),r(18,"th",31),o(19),c(20,"translate"),n(),r(21,"th",31),o(22),c(23,"translate"),n(),r(24,"th",31),o(25),c(26,"translate"),n(),r(27,"th",31),o(28),c(29,"translate"),n(),r(30,"th",31),o(31),c(32,"translate"),n(),r(33,"th",31),o(34),c(35,"translate"),n(),r(36,"th",31),o(37,"-"),n()()),e&2&&(i(2),T(m(3,11,"Table.Name")),i(5),T(m(8,13,"Table.DocDate")),i(3),T(m(11,15,"Table.Quantity")),i(3),T(m(14,17,"Table.Total")),i(3),T(m(17,19,"Table.Storage")),i(3),T(m(20,21,"Table.Type")),i(3),T(m(23,23,"Table.DocNo")),i(3),T(m(26,25,"Table.DocType")),i(3),T(m(29,27,"Table.QuntityCumulative")),i(3),T(m(32,29,"Table.WA")),i(3),T(m(35,31,"Table.TotalCumulative")))}function ue(e,s){e&1&&(r(0,"span",33),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.In")," "))}function he(e,s){e&1&&(r(0,"span",33),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Out")," "))}function ge(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Sale")," "))}function Se(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.SaleReturn")," "))}function Ie(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Buy")," "))}function Te(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.BuyReturn")," "))}function fe(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.Transfer")," "))}function ve(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.StoreAdjustmet")," "))}function xe(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.CreateInitGlRecept")," "))}function Ce(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),d(" ",m(2,1,"DocType.TransferBanches")," "))}function Me(e,s){if(e&1&&(r(0,"span",33),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInOutQty.toFixed(2),"")}}function we(e,s){if(e&1&&(r(0,"span",42),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInOutQty.toFixed(2),"")}}function ye(e,s){if(e&1&&(r(0,"span",33),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInPrice.toFixed(2),"")}}function De(e,s){if(e&1&&(r(0,"span",42),o(1),n()),e&2){let a=f().$implicit;i(),d(" ",a.OutInPrice.toFixed(2),"")}}function Pe(e,s){if(e&1){let a=M();r(0,"tr")(1,"td")(2,"span",32),o(3),n()(),r(4,"td")(5,"span",32),o(6),n()(),r(7,"td")(8,"span",32),o(9),c(10,"date"),n()(),r(11,"td")(12,"span",33),o(13),n()(),r(14,"td")(15,"span",33),o(16),n()(),r(17,"td",34)(18,"span",32),o(19),n()(),r(20,"td"),v(21,ue,3,3,"span",35)(22,he,3,3,"span",35),n(),r(23,"td",36)(24,"span",33),o(25),n()(),r(26,"td"),v(27,ge,3,3,"span",37)(28,Se,3,3,"span",38)(29,Ie,3,3,"span",37)(30,Te,3,3,"span",37)(31,fe,3,3,"span",37)(32,ve,3,3,"span",37)(33,xe,3,3,"span",38)(34,Ce,3,3,"span",37),n(),r(35,"td"),v(36,Me,2,1,"span",35)(37,we,2,1,"span",39),n(),r(38,"td")(39,"span",33),o(40),n()(),r(41,"td"),v(42,ye,2,1,"span",35)(43,De,2,1,"span",39),n(),r(44,"td")(45,"button",40),x("click",function(){let l=S(a).$implicit,t=f();return I(t._SharedObjectModelService.ShowDocument(l.DocType,l.DocNo))}),o(46),c(47,"translate"),O(48,"i",41),n()()()}if(e&2){let a=s.$implicit,p=f();i(3),d(" ",a.ProductName,""),i(3),d(" ",a.Notes,""),i(3),d(" ",k(10,24,a.DocDate,"d-M-yyyy h:mm:ss a")," "),i(4),d(" ",a.Qty,""),i(3),d(" ",a.TotalAfterVat.toFixed(2),""),i(3),d(" ",a.StoreName," "),i(2),g("ngIf",a.StockType==1),i(),g("ngIf",a.StockType==2),i(3),d(" ",a.DocNo," "),i(2),g("ngIf",a.DocType==1),i(),g("ngIf",a.DocType==2),i(),g("ngIf",a.DocType==3),i(),g("ngIf",a.DocType==4),i(),g("ngIf",a.DocType==5),i(),g("ngIf",a.DocType==11),i(),g("ngIf",a.DocType==12&&a.StockType==1),i(),g("ngIf",a.DocType==15),i(2),g("ngIf",a.OutInOutQty>=0),i(),g("ngIf",a.OutInOutQty<0),i(3),T(a.WA.toFixed(2)),i(2),g("ngIf",a.OutInPrice>=0),i(),g("ngIf",a.OutInPrice<0),i(2),g("disabled",p._AppModeService.DisabledButton),i(),d("",m(47,27,"Table.Show")," ")}}function be(e,s){if(e&1){let a=M();r(0,"p-paginator",43),x("onPageChange",function(l){S(a);let t=f();return I(t.onPageChange(l))}),n()}if(e&2){let a=f();g("first",a.first)("rows",a.rows)("totalRecords",a.Paging.TotalItems)("rowsPerPageOptions",a._Apiservice.RowCount)}}function Ee(e,s){if(e&1){let a=M();r(0,"p-paginator",44),x("onPageChange",function(l){S(a);let t=f();return I(t.onPageChange(l))}),n()}if(e&2){let a=f();g("first",a.first)("rows",a.rows)("totalRecords",a.Paging.TotalItems)}}var Xe=(()=>{let s=class s{constructor(p,l,t){this._SharedObjectModelService=p,this._AppModeService=l,this._Apiservice=t,this.Paging={PageSize:0,CurrentPage:0,TotalPages:0,TotalItems:0,DataReturn:void 0},this.SearchModel={FromDate:"",ToDate:"",StoreId:null,ProductId:null},this.Storages=[],this.Items=[],this.Arr=[],this.first=1,this.rows=10}ngOnInit(){this.SearchModel.FromDate=new Date(this._Apiservice.FromDate()),this.SearchModel.ToDate=new Date(this._Apiservice.ToNowDate())}ChangeSearchApi(p,l){let t=`${l.searchTerm}`.trim();(t==""||t=="null")&&(l.searchTerm="",t=""),this._AppModeService.CurrentPage+=1;let _={TableName:p,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:t,SearchField:"Name"};p=="Storages"&&(_.BranchFilter=!0),p=="Items"&&(_.Columns=["Id","Name","Code"],_.Conditions="ProductType != 2"),this._Apiservice.post("Global/GetAll",_,!1).pipe(P(this._Apiservice.destroy$)).subscribe({next:h=>{h.IsSuccess==!0&&h.Obj!=null?this.HandleResponse(h.Obj,p):this._AppModeService._Toastr.error(h.Message)}})}HandleResponse(p,l){this._SharedObjectModelService.TotalItems=p.TotalItems,l=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(p.DataReturn),"Id")),l=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(p.DataReturn),"Id"),this.Items=this.Items.map(t=>F(V({},t),{NameAndCode:`${t.Name} - ${t.Code}`})))}SelectValue(p,l){if(p!=null&&(p>0||p!="")){let t=[];l=="Store"&&(t=this.Storages),l=="Product"&&(t=this.Items);let _=t.find(h=>h.Id==p);if(_==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${l}Id`]=p,this.SearchModel[`${l}Name`]=_.Name,l=="Branch"&&(this.SearchModel.StoreId=null)}else this.SearchModel[`${l}Id`]=null,this.SearchModel[`${l}Name`]=""}onPageChange(p){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}p.page++,p.first,p.rows,this.rows=p.rows,this.first=p.first;let l={CurrentPage:p.page,PageSize:p.rows,FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId};this._Apiservice.post("ItemEP/ProductTransaction",l,!0).pipe(P(this._Apiservice.destroy$)).subscribe({next:t=>{t.IsSuccess==!0?(this.Paging.CurrentPage=t.Obj.CurrentPage,this.Paging.TotalItems=t.Obj.TotalItems,this.Arr=t.Obj.DataReturn):this._AppModeService._Toastr.error(t.Message)}})}Search(){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}let p={FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId,CurrentPage:1,PageSize:this.rows};if(this._Apiservice.ValidateDate(p.FromDate,p.ToDate)==!1){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("StatementOfFinancial.Error.SmallDate"));return}this._Apiservice.post("ItemEP/ProductTransaction",p,!0).pipe(P(this._Apiservice.destroy$)).subscribe({next:l=>{l.IsSuccess==!0?(this.Paging.CurrentPage=l.Obj.CurrentPage,this.Paging.TotalItems=l.Obj.TotalItems,this.Arr=l.Obj.DataReturn):this._AppModeService._Toastr.error(l.Message)}})}trackByMethod(p,l){return l.Id}ngOnDestroy(){this._Apiservice.destroy$.next(),this._Apiservice.destroy$.complete()}};s.\u0275fac=function(l){return new(l||s)(b(oe),b(K),b($))},s.\u0275cmp=B({type:s,selectors:[["app-item-transaction"]],standalone:!0,features:[R],decls:49,vars:47,consts:[["SelectFromStore",""],["dt1",""],["clas","bg-light"],["id","container-page",1,"container-page","me-2"],[1,"page-wrapper"],[1,"main-content"],[1,"inner-box"],[1,"title-box","font-weight-normal"],[1,"PageTitle","fs-1","fw-bold","px-2"],[1,"d-flex","flex-wrap","justify-content-center","align-items-end"],[1,"col-12","col-md-2","px-1"],[1,"my-1"],[1,"formdate"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","ngModel","showTime","showIcon","showOnFocus","showOtherMonths"],[1,"col-12","col-md-2","px-2"],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],[1,"col-12","col-md-3","px-2"],["for","Item"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-md-3","mx-auto","mt-4","mt-md-0","p-2","text-center"],[1,"btn","btn-primary","py-3","mx-3","px-5","shadow-none",3,"click"],[1,"col-12","card","p-0","table-responsive","mt-4"],[3,"value","paginator","rows","tableStyle","globalFilterFields"],["pTemplate","header"],["pTemplate","body"],["appendTo","table",3,"first","rows","totalRecords","rowsPerPageOptions","onPageChange",4,"ngIf"],["appendTo","table",3,"first","rows","totalRecords","onPageChange",4,"ngIf"],[1,"form-text","text-muted"],[1,"col-1"],[1,"text-dark"],[1,"text-dark","text-nowrap"],[1,""],["class","text-dark text-nowrap",4,"ngIf"],[1,"text-nowrap"],["class","text-dark ",4,"ngIf"],["class","text-dark",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-primary","text-white","shadow-none",3,"click","disabled"],[1,"mx-1","pi","pi-search"],[1,"text-danger"],["appendTo","table",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],["appendTo","table",3,"onPageChange","first","rows","totalRecords"]],template:function(l,t){if(l&1){let _=M();r(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"i",8),o(7),c(8,"translate"),n()(),r(9,"div",9)(10,"div",10)(11,"p",11),o(12),c(13,"translate"),n(),r(14,"div",12)(15,"p-calendar",13),D("ngModelChange",function(u){return S(_),y(t.SearchModel.FromDate,u)||(t.SearchModel.FromDate=u),I(u)}),n()()(),r(16,"div",10)(17,"p",11),o(18),c(19,"translate"),n(),r(20,"div",12)(21,"p-calendar",13),D("ngModelChange",function(u){return S(_),y(t.SearchModel.ToDate,u)||(t.SearchModel.ToDate=u),I(u)}),n()()(),r(22,"div",14)(23,"p",15),o(24),c(25,"translate"),n(),r(26,"ng-select",16,0),x("clear",function(){return S(_),I(t.Storages=[])})("focus",function(){S(_);let u=C(27);return t.ChangeSearchApi("Storages",u),I(t._AppModeService.ResetCurrentPage())})("keyup",function(){S(_);let u=C(27);return t.ChangeSearchApi("Storages",u),I(t._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){S(_);let u=C(27);return I(t.ChangeSearchApi("Storages",u))})("close",function(){return S(_),I(t._AppModeService.ResetCurrentPage())})("open",function(){return S(_),I(t._AppModeService.ResetCurrentPage())})("change",function(){return S(_),I(t.SelectValue(t.SearchModel.StoreId,"Store"))}),D("ngModelChange",function(u){return S(_),y(t.SearchModel.StoreId,u)||(t.SearchModel.StoreId=u),I(u)}),v(28,se,2,2,"ng-template",17)(29,ce,1,1,"ng-template",18),n()(),r(30,"div",19)(31,"label",20),o(32),c(33,"translate"),n(),r(34,"ng-select",21,0),x("clear",function(){return S(_),I(t.Items=[])})("focus",function(){S(_);let u=C(27);return t.ChangeSearchApi("Items",u),I(t._AppModeService.ResetCurrentPage())})("keyup",function(){S(_);let u=C(27);return t.ChangeSearchApi("Items",u),I(t._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){S(_);let u=C(27);return I(t.ChangeSearchApi("Items",u))})("close",function(){return S(_),I(t._AppModeService.ResetCurrentPage())})("open",function(){return S(_),I(t._AppModeService.ResetCurrentPage())})("change",function(){return S(_),I(t.SelectValue(t.SearchModel.ProductId,"Product"))}),D("ngModelChange",function(u){return S(_),y(t.SearchModel.ProductId,u)||(t.SearchModel.ProductId=u),I(u)}),v(36,me,2,2,"ng-template",17)(37,de,1,1,"ng-template",18),n()(),r(38,"div",22)(39,"button",23),x("click",function(){return S(_),I(t.Search())}),o(40),c(41,"translate"),n()()(),r(42,"div",24)(43,"p-table",25,1),v(45,_e,38,33,"ng-template",26)(46,Pe,49,29,"ng-template",27),n(),v(47,be,1,4,"p-paginator",28)(48,Ee,1,3,"p-paginator",29),n()()()()()()}l&2&&(i(7),T(m(8,33,"ItemTransaction.ItemTransaction")),i(5),d(" ",m(13,35,"SupplierAccount.FromDate"),""),i(3),w("ngModel",t.SearchModel.FromDate),g("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),i(3),d(" ",m(19,37,"SupplierAccount.ToDate"),""),i(3),w("ngModel",t.SearchModel.ToDate),g("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),i(3),T(m(25,39,"BalanceItemBranch.Store")),i(2),g("items",t.Storages)("autofocus",!1)("virtualScroll",!0)("searchable",!0),w("ngModel",t.SearchModel.StoreId),i(6),d(" ",m(33,41,"BalanceStorage.ItemId"),""),i(2),g("items",t.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),w("ngModel",t.SearchModel.ProductId),i(6),T(m(41,43,"Model.Search")),i(3),g("value",t.Arr)("paginator",!1)("rows",t.rows)("tableStyle",A(45,le))("globalFilterFields",A(46,pe)),i(4),g("ngIf",t.Paging.TotalItems>=10),i(),g("ngIf",t.Paging.TotalItems<10))},dependencies:[te,ee,X,L,Q,ne,ie,Z,re,ae,W,j,z,N,J,q,Y,U,G,H]});let e=s;return e})();export{Xe as ItemTransactionComponent};
