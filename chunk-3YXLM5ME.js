import{a as be,b as Ne,c as we}from"./chunk-BZPR73YG.js";import{a as Ae}from"./chunk-RI6KAADW.js";import{a as Ce}from"./chunk-3UDBFBON.js";import{a as Se,b as fe,h as De}from"./chunk-ZV4STMPN.js";import{a as Te}from"./chunk-VSYXDL23.js";import{o as ye,x as ge}from"./chunk-BHSN7HFD.js";import{a as de,b as he}from"./chunk-6BJKXUWP.js";import{a as xe}from"./chunk-LUZO7NCR.js";import{a as ue,b as _e,c as me,d as ve}from"./chunk-MZIKAFPE.js";import{k as Ie}from"./chunk-RVJIMCIT.js";import{c as pe}from"./chunk-NUFVOF6D.js";import{c as X,d as ee}from"./chunk-KALZ37GW.js";import{b as J,c as K,f as te,h as ie,k as ne,m as oe,o as re,p as ae,q as ce,s as le,u as se}from"./chunk-N4FWSTCP.js";import{A as Y,d as $,e as q,j as z}from"./chunk-VTADEU6K.js";import{$b as A,Cb as a,Db as c,Eb as R,Fb as O,Gb as G,Ib as x,Mb as T,Nb as l,Qb as f,Rb as W,Tb as P,Ub as M,Vb as k,Wb as D,X as w,Xb as s,Yb as h,Zb as y,_b as U,ac as C,bc as b,db as r,dc as F,eb as V,na as L,nc as m,oc as v,pc as H,qc as Z,vb as g,wa as j,xa as p,xb as I,ya as u}from"./chunk-J5UB44FZ.js";var Be=["GLComponent"],Ee=["dynamiccomponent"],Pe=["content"];function Me(o,_){if(o&1){let i=x();a(0,"div",48)(1,"div",49)(2,"input",50),m(3,"translate"),T("keyup",function(){p(i);let e=l(2);return u(e.ResetPage())})("change",function(){p(i);let e=l(2);return u(e.ResetPage())}),b("ngModelChange",function(e){p(i);let n=l(2);return C(n.InvoiceDocNo,e)||(n.InvoiceDocNo=e),u(e)}),c()(),a(4,"button",51),T("click",function(){p(i);let e=l(2);return u(e.Search())}),s(5),m(6,"translate"),c()()}if(o&2){let i=l(2);r(2),f("placeholder",v(3,4,"ReturnBuyInvoice.InvoiceNo")),A("ngModel",i.InvoiceDocNo),r(2),I("disabled",i._AppModeService.DisabledButton),r(),y(" ",v(6,6,"Model.Search")," ")}}function ke(o,_){o&1&&(a(0,"span",42),s(1," - "),c())}function Ue(o,_){o&1&&(a(0,"span",42),s(1),m(2,"translate"),c()),o&2&&(r(),y("",v(2,1,"SaleInvoice.Cash")," "))}function Qe(o,_){o&1&&(a(0,"span",42),s(1),m(2,"translate"),c()),o&2&&(r(),y("",v(2,1,"SaleInvoice.Debt")," "))}function Oe(o,_){o&1&&(a(0,"span",42),s(1),m(2,"translate"),c()),o&2&&(r(),y("",v(2,1,"SaleInvoice.Delivery")," "))}function Ge(o,_){if(o&1&&(a(0,"div")(1,"span",12),s(2),m(3,"translate"),c(),a(4,"span"),s(5),c()()),o&2){let i=l(2);r(2),h(v(3,2,"SaleInvoice.Cash")),r(3),h(i.InvoiceCash)}}function We(o,_){if(o&1&&(a(0,"div")(1,"span",12),s(2),m(3,"translate"),c(),a(4,"span"),s(5),c()()),o&2){let i=l(2);r(2),h(v(3,2,"SaleInvoice.Visa")),r(3),h(i.InvoiceVisa)}}function Le(o,_){if(o&1&&(a(0,"div")(1,"span",12),s(2),m(3,"translate"),c(),a(4,"span"),s(5),c()()),o&2){let i=l(2);r(2),h(v(3,2,"SaleInvoice.Debt")),r(3),h(i.InvoiceDept)}}function je(o,_){o&1&&(a(0,"tr")(1,"th"),s(2,"#"),c(),a(3,"th",52),s(4),m(5,"translate"),c(),a(6,"th",53),s(7),m(8,"translate"),c(),a(9,"th",53),s(10),m(11,"translate"),c(),a(12,"th",53),s(13),m(14,"translate"),c(),a(15,"th",53),s(16),m(17,"translate"),c(),a(18,"th",53),s(19),m(20,"translate"),c(),a(21,"th",53),s(22),m(23,"translate"),c(),a(24,"th",53),s(25),m(26,"translate"),c(),a(27,"th",53),s(28),m(29,"translate"),c()()),o&2&&(r(4),h(v(5,9,"SaleInvoice.Name")),r(3),h(v(8,11,"SaleInvoice.Unit")),r(3),h(v(11,13,"ReturnBuyInvoice.LastReturnQuantity")),r(3),h(v(14,15,"ReturnBuyInvoice.ReturnQuantity")),r(3),h(v(17,17,"ReturnBuyInvoice.Quantity")),r(3),h(v(20,19,"SaleInvoice.Price")),r(3),y("",v(23,21,"SaleInvoice.DiscountRate")," %"),r(3),h(v(26,23,"SaleInvoice.Discount")),r(3),h(v(29,25,"SaleInvoice.NetTotal")))}function Fe(o,_){if(o&1&&(a(0,"p",62),s(1),c()),o&2){let i=l(2).$implicit;r(),y(" ",i.ProductName," ")}}function He(o,_){if(o&1&&(O(0),g(1,Fe,2,1,"p",61),G()),o&2){let i=_.$implicit,t=l().$implicit;r(),I("ngIf",t.ProductId==i.Id)}}function Ze(o,_){if(o&1&&(a(0,"p",62),s(1),c()),o&2){let i=l(2).$implicit;r(),y(" ",i.ProductUnitName," ")}}function $e(o,_){if(o&1&&(O(0),g(1,Ze,2,1,"p",61),G()),o&2){let i=_.$implicit,t=l().$implicit;r(),I("ngIf",t.ProductUnitId==i.Id)}}function qe(o,_){if(o&1){let i=x();a(0,"tr")(1,"td",54)(2,"span"),s(3),c()(),a(4,"td",55),m(5,"translate"),g(6,He,2,1,"ng-container",56),c(),a(7,"td",55),m(8,"translate"),g(9,$e,2,1,"ng-container",56),c(),a(10,"td",57),m(11,"translate"),a(12,"span",58),s(13),c()(),a(14,"td",57),m(15,"translate"),a(16,"div",59)(17,"input",60),T("change",function(){let e=p(i).rowIndex,n=l(2);return u(n.LowQuantity(e))})("keyup",function(){let e=p(i).rowIndex,n=l(2);return u(n.LowQuantity(e))}),b("ngModelChange",function(e){let n=p(i).$implicit;return C(n.Quantity,e)||(n.Quantity=e),u(e)}),c()()(),a(18,"td",57),m(19,"translate"),a(20,"span",58),s(21),c()(),a(22,"td",57),m(23,"translate"),a(24,"span",58),s(25),c()(),a(26,"td",57),m(27,"translate"),a(28,"span",58),s(29),c()(),a(30,"td",57),m(31,"translate"),a(32,"span",58),s(33),c()(),a(34,"td",57),m(35,"translate"),a(36,"span"),s(37),c()()()}if(o&2){let i=_.$implicit,t=_.rowIndex,e=l(2);r(),f("title",t+1),r(2),h(t+1),r(),f("title",v(5,24,"SaleInvoice.Name")),r(2),I("ngForOf",i.Items),r(),f("title",v(8,26,"SaleInvoice.Unit")),r(2),I("ngForOf",i.ProductUnits),r(),f("title",v(11,28,"ReturnBuyInvoice.LastReturnQuantity")),r(3),y(" ",i.ReturnedQty,""),r(),f("title",v(15,30,"ReturnBuyInvoice.ReturnQuantity")),r(3),W("id","ReturnQuantity",t,""),W("name","ReturnQuantity",t,""),A("ngModel",i.Quantity),r(),f("title",v(19,32,"ReturnBuyInvoice.Quantity")),r(3),y(" ",i.SaveQuantity,""),r(),f("title",v(23,34,"SaleInvoice.Price")),r(3),y(" ",i.Price,""),r(),f("title",v(27,36,"SaleInvoice.DiscountRate")),r(3),y(" ",e._AppModeService.GetTwoNumberAfterZero(i.DiscountRate),""),r(),f("title",v(31,38,"SaleInvoice.Discount")),r(3),y(" ",e._AppModeService.GetTwoNumberAfterZero(i.Discount),""),r(),f("title",v(35,40,"SaleInvoice.NetTotal")),r(3),h(e._AppModeService.GetTwoNumberAfterZero(i.TotalPriceAfterDiscount))}}function ze(o,_){if(o&1&&(a(0,"span",63),s(1),m(2,"date"),c()),o&2){let i=l(2);r(),y(" ",H(2,1,i.Invoice.DocDate,"d-M-yyyy h:mm:ss a")," ")}}function Ye(o,_){if(o&1){let i=x();a(0,"p-calendar",64),b("ngModelChange",function(e){p(i);let n=l(2);return C(n.Invoice.DocDate,e)||(n.Invoice.DocDate=e),u(e)}),c()}if(o&2){let i=l(2);A("ngModel",i.Invoice.DocDate),I("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0)}}function Je(o,_){if(o&1&&s(0),o&2){let i=_.item;y(" ",i.Name," ")}}function Ke(o,_){if(o&1&&s(0),o&2){let i=_.item;y(" ",i.Name," ")}}function Xe(o,_){if(o&1){let i=x();a(0,"div",24)(1,"ng-select",27),m(2,"translate"),b("ngModelChange",function(e){p(i);let n=l(2);return C(n.Invoice.ClientId,e)||(n.Invoice.ClientId=e),u(e)}),g(3,Ke,1,1,"ng-template",28),c()()}if(o&2){let i=l(2);r(),f("placeholder",v(2,6,"SaleOffer.Client")),I("items",i.ClientArr)("dropdownPosition","top")("disabled",!0)("virtualScroll",!0),A("ngModel",i.Invoice.ClientId)}}function et(o,_){if(o&1&&s(0),o&2){let i=_.item;y(" ",i.Name," ")}}function tt(o,_){if(o&1){let i=x();a(0,"div",24)(1,"ng-select",27),m(2,"translate"),b("ngModelChange",function(e){p(i);let n=l(2);return C(n.Invoice.SupplierId,e)||(n.Invoice.SupplierId=e),u(e)}),g(3,et,1,1,"ng-template",28),c()()}if(o&2){let i=l(2);r(),f("placeholder",v(2,6,"BuyOffer.Supplier")),I("items",i.SupplierArr)("dropdownPosition","top")("disabled",!0)("virtualScroll",!0),A("ngModel",i.Invoice.SupplierId)}}function it(o,_){o&1&&(a(0,"option",33),s(1),m(2,"translate"),c()),o&2&&(I("value",3),r(),h(v(2,2,"SaleInvoice.Delivery")))}function nt(o,_){if(o&1){let i=x();a(0,"div",24)(1,"input",65),m(2,"translate"),T("keyup",function(){p(i);let e=l(2);return u(e.ChangeCash())})("change",function(){p(i);let e=l(2);return u(e.ChangeCash())}),b("ngModelChange",function(e){p(i);let n=l(2);return C(n.Invoice.Cash,e)||(n.Invoice.Cash=e),u(e)}),c()()}if(o&2){let i=l(2);r(),f("placeholder",v(2,2,"SaleInvoice.Cash")),A("ngModel",i.Invoice.Cash)}}function ot(o,_){if(o&1&&(a(0,"small",66),s(1),c()),o&2){let i=l(2);r(),U("Loaded ",i.TreasuryArr.length," of ",i._SharedObjectModelService.TotalItems,"")}}function rt(o,_){if(o&1&&s(0),o&2){let i=_.item;y(" ",i.Name," ")}}function at(o,_){if(o&1){let i=x();a(0,"div",24)(1,"input",67),m(2,"translate"),T("keyup",function(){p(i);let e=l(2);return u(e.ChangeCash())})("change",function(){p(i);let e=l(2);return u(e.ChangeCash())}),b("ngModelChange",function(e){p(i);let n=l(2);return C(n.Invoice.Visa,e)||(n.Invoice.Visa=e),u(e)}),c()()}if(o&2){let i=l(2);r(),f("placeholder",v(2,2,"SaleInvoice.Visa")),A("ngModel",i.Invoice.Visa)}}function ct(o,_){if(o&1&&(a(0,"small",66),s(1),c()),o&2){let i=l(2);r(),U("Loaded ",i.BankAccountArr.length," of ",i._SharedObjectModelService.TotalItems,"")}}function lt(o,_){if(o&1&&s(0),o&2){let i=_.item;y(" ",i.Name," ")}}function st(o,_){if(o&1&&(a(0,"small",66),s(1),c()),o&2){let i=l(3);r(),U("Loaded ",i.EmployeeArr.length," of ",i._SharedObjectModelService.TotalItems,"")}}function pt(o,_){if(o&1&&s(0),o&2){let i=_.item;y(" ",i.Name," ")}}function ut(o,_){if(o&1){let i=x();a(0,"div",68)(1,"p",69),s(2),m(3,"translate"),c(),a(4,"ng-select",70,5),T("clear",function(){p(i);let e=l(2);return u(e.EmployeeArr=[])})("focus",function(){p(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("keyup",function(){p(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("change",function(){p(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("scrollToEnd",function(){p(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("close",function(){p(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("open",function(){p(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("change",function(){p(i);let e=l(2);return u(e.SelectValue(e.Invoice.EmployeeId,"Employee"))}),b("ngModelChange",function(e){p(i);let n=l(2);return C(n.Invoice.EmployeeId,e)||(n.Invoice.EmployeeId=e),u(e)}),g(6,st,2,2,"ng-template",36)(7,pt,1,1,"ng-template",28),c()()}if(o&2){let i=l(2);r(2),h(v(3,7,"BuyReport.Employee")),r(2),I("items",i.EmployeeArr)("dropdownPosition","top")("autofocus",!1)("virtualScroll",!0)("searchable",!0),A("ngModel",i.Invoice.EmployeeId)}}function _t(o,_){if(o&1&&R(0,"input",71),o&2){let i=l(2);f("value",i.Invoice.Debt),I("disabled",!0)}}function mt(o,_){if(o&1){let i=x();a(0,"button",72),T("click",function(){p(i);let e=l(2);return u(e.Save())}),s(1),m(2,"translate"),R(3,"i",73),c()}if(o&2){let i=l(2);I("disabled",i._AppModeService.DisabledButton),r(),y(" ",v(2,2,"Model.Save")," ")}}function vt(o,_){if(o&1){let i=x();a(0,"button",75),T("click",function(){p(i);let e=l(3);return u(e.Save())}),s(1),m(2,"translate"),R(3,"i",73),c()}if(o&2){let i=l(3);I("disabled",i._AppModeService.DisabledButton),r(),y(" ",v(2,2,"Model.Update")," ")}}function It(o,_){if(o&1&&(a(0,"span"),g(1,vt,4,4,"button",74),c()),o&2){let i=l(2);r(),I("ngIf",i.Invoice.Id!=0)}}function dt(o,_){if(o&1){let i=x();a(0,"button",76),T("click",function(){p(i);let e=l(2);return u(e.OpenGl())}),s(1),m(2,"translate"),c()}o&2&&(r(),y(" ",v(2,1,"Model.Gl")," "))}function ht(o,_){if(o&1){let i=x();R(0,"app-modal-header",7),a(1,"div",8)(2,"div",9),g(3,Me,7,8,"div",10),a(4,"div",11)(5,"div")(6,"span",12),s(7),m(8,"translate"),c(),g(9,ke,2,0,"span",13)(10,Ue,3,3,"span",13)(11,Qe,3,3,"span",13)(12,Oe,3,3,"span",13),c(),g(13,Ge,6,4,"div",14)(14,We,6,4,"div",14)(15,Le,6,4,"div",14),c()(),a(16,"div",15)(17,"p-table",16),g(18,je,30,27,"ng-template",17)(19,qe,38,42,"ng-template",18),c()()(),a(20,"div",19)(21,"div",20),R(22,"input",21),c(),a(23,"div",22)(24,"input",23),m(25,"translate"),b("ngModelChange",function(e){p(i);let n=l();return C(n.Invoice.Notes,e)||(n.Invoice.Notes=e),u(e)}),c()(),a(26,"div",24),g(27,ze,3,4,"span",25)(28,Ye,1,5,"p-calendar",26),c(),a(29,"div",24)(30,"ng-select",27),m(31,"translate"),b("ngModelChange",function(e){p(i);let n=l();return C(n.Invoice.StoreId,e)||(n.Invoice.StoreId=e),u(e)}),g(32,Je,1,1,"ng-template",28),c()(),g(33,Xe,4,8,"div",29)(34,tt,4,8,"div",29),c(),a(35,"div",30)(36,"div",31)(37,"select",32),T("change",function(){p(i);let e=l();return u(e.ChangePamentType(e.Invoice.PaymentType))}),b("ngModelChange",function(e){p(i);let n=l();return C(n.Invoice.PaymentType,e)||(n.Invoice.PaymentType=e),u(e)}),a(38,"option",33),s(39),m(40,"translate"),c(),a(41,"option",33),s(42),m(43,"translate"),c(),g(44,it,3,4,"option",34),c()(),g(45,nt,3,4,"div",29),a(46,"div",24)(47,"ng-select",35,3),m(49,"translate"),T("clear",function(){p(i);let e=l();return u(e.TreasuryArr=[])})("focus",function(){p(i);let e=D(48),n=l();return u(n.ChangeSearchApi("Treasury",e))})("keyup",function(){p(i);let e=D(48),n=l();return u(n.ChangeSearchApi("Treasury",e))})("change",function(){p(i);let e=D(48),n=l();return u(n.ChangeSearchApi("Treasury",e))})("scrollToEnd",function(){p(i);let e=D(48),n=l();return u(n.ChangeSearchApi("Treasury",e))})("close",function(){p(i);let e=l();return u(e._AppModeService.CurrentPage=0)})("open",function(){p(i);let e=l();return u(e._AppModeService.CurrentPage=0)})("change",function(){p(i);let e=l();return u(e.SelectValue(e.Invoice.TreasuryId,"Treasury"))}),b("ngModelChange",function(e){p(i);let n=l();return C(n.Invoice.TreasuryId,e)||(n.Invoice.TreasuryId=e),u(e)}),g(50,ot,2,2,"ng-template",36)(51,rt,1,1,"ng-template",28),c()(),g(52,at,3,4,"div",29),a(53,"div",24)(54,"ng-select",37,4),m(56,"translate"),T("clear",function(){p(i);let e=l();return u(e.BankAccountArr=[])})("focus",function(){p(i);let e=D(55),n=l();return u(n.ChangeSearchApi("BankAccounts",e))})("keyup",function(){p(i);let e=D(55),n=l();return u(n.ChangeSearchApi("BankAccounts",e))})("change",function(){p(i);let e=D(55),n=l();return u(n.ChangeSearchApi("BankAccounts",e))})("scrollToEnd",function(){p(i);let e=D(55),n=l();return u(n.ChangeSearchApi("BankAccounts",e))})("close",function(){p(i);let e=l();return u(e._AppModeService.CurrentPage=0)})("open",function(){p(i);let e=l();return u(e._AppModeService.CurrentPage=0)})("change",function(){p(i);let e=l();return u(e.SelectValue(e.Invoice.BankAccountId,"BankAccount"))}),b("ngModelChange",function(e){p(i);let n=l();return C(n.Invoice.BankAccountId,e)||(n.Invoice.BankAccountId=e),u(e)}),g(57,ct,2,2,"ng-template",36)(58,lt,1,1,"ng-template",28),c()(),g(59,ut,8,9,"div",38),a(60,"div",39),g(61,_t,1,2,"input",40),c()(),a(62,"div",41)(63,"div")(64,"span",12),s(65),m(66,"translate"),c(),a(67,"span",42),s(68),c()(),a(69,"div")(70,"span",12),s(71),m(72,"translate"),c(),a(73,"span",42),s(74),c()(),a(75,"div")(76,"span",12),s(77),m(78,"translate"),c(),a(79,"span",42),s(80),c()(),a(81,"div")(82,"span",12),s(83),m(84,"translate"),c(),a(85,"span",42),s(86),c()(),a(87,"div")(88,"span")(89,"i",12),s(90),m(91,"translate"),a(92,"i",43),s(93),c()()(),a(94,"span",42),s(95),c()(),a(96,"div")(97,"span",12),s(98),m(99,"translate"),c(),a(100,"span",42),s(101),c()()(),a(102,"div",44),g(103,mt,4,4,"button",45)(104,It,2,1,"span",14)(105,dt,3,3,"button",46),a(106,"button",47),T("click",function(){let e=p(i).$implicit,n=l();return e.close("Close click"),u(n.ResetPage())}),s(107),m(108,"translate"),c()()}if(o&2){let i=l();I("PageTitle",i.PageTitle),r(3),I("ngIf",i.Invoice.Id==0),r(4),h(v(8,69,"ReturnSaleInvoice.Status")),r(2),I("ngIf",i.InvoiceType==0),r(),I("ngIf",i.InvoiceType==1),r(),I("ngIf",i.InvoiceType==2),r(),I("ngIf",i.InvoiceType==3),r(),I("ngIf",i.InvoiceCash>=0),r(),I("ngIf",i.InvoiceVisa>=0),r(),I("ngIf",i.InvoiceDept>=0),r(2),I("value",i.Invoice.InvoiceDetails)("responsive",!0)("scrollable",!0),r(5),I("value",i.Invoice.DocNo)("disabled",!0),r(2),f("placeholder",v(25,71,"Table.Notes")),A("ngModel",i.Invoice.Notes),r(3),I("ngIf",i._DefaultSettingsService.DefaultSettings.DateTimeReadOnly==!1),r(),I("ngIf",i._DefaultSettingsService.DefaultSettings.DateTimeReadOnly==!0),r(2),f("placeholder",v(31,73,"Place")),I("items",i.StoreArr)("dropdownPosition","top")("disabled",!0)("virtualScroll",!0),A("ngModel",i.Invoice.StoreId),r(3),I("ngIf",i.ScreenName=="ReturnSaleInvoice"),r(),I("ngIf",i.ScreenName=="ReturnBuyInvoice"),r(3),A("ngModel",i.Invoice.PaymentType),r(),I("value",1),r(),h(v(40,75,"SaleInvoice.Cash")),r(2),I("value",2),r(),h(v(43,77,"SaleInvoice.Debt")),r(2),I("ngIf",i.ScreenName=="ReturnSaleInvoice"),r(),I("ngIf",i.Invoice.PaymentType!=3),r(2),f("placeholder",v(49,79,"BuyInvoice.Treasury")),I("items",i.TreasuryArr)("dropdownPosition","top")("autofocus",!1)("virtualScroll",!0)("searchable",!0)("disabled",i.Invoice.PaymentType==3||i.Invoice.Cash==""||i.Invoice.Cash==0),A("ngModel",i.Invoice.TreasuryId),r(5),I("ngIf",i.Invoice.PaymentType!=3),r(2),f("placeholder",v(56,81,"BuyInvoice.Bank")),I("items",i.BankAccountArr)("dropdownPosition","top")("virtualScroll",!0)("searchable",!0)("disabled",i.Invoice.PaymentType==3||i.Invoice.Visa==""||i.Invoice.Visa==0),A("ngModel",i.Invoice.BankAccountId),r(5),I("ngIf",i.Invoice.PaymentType==3),r(2),I("ngIf",i.Invoice.PaymentType==2),r(4),h(v(66,83,"ProductCount")),r(3),h(i.Invoice.InvoiceDetails.length),r(3),h(v(72,85,"SaleInvoice.TotalInvoice")),r(3),y(" ",i._AppModeService.GetTwoNumberAfterZero(i.Invoice.TotalInvoice)," "),r(3),h(v(78,87,"SaleInvoice.TotalDiscount")),r(3),y("",i._AppModeService.GetTwoNumberAfterZero(i.Invoice.TotalDisc)," "),r(3),h(v(84,89,"SaleInvoice.DiscountRate")),r(3),y("",i._AppModeService.GetTwoNumberAfterZero(i.Invoice.TotalDiscRate)," "),r(4),y(" ",v(91,91,"SaleInvoice.TotalVat")," "),r(3),y(" ",i._AppModeService.GetTwoNumberAfterZero(i.Invoice.TotalVatRate)," % "),r(2),h(i._AppModeService.GetTwoNumberAfterZero(i.Invoice.TotalInvoiceVatAmount)),r(3),h(v(99,93,"SaleInvoice.TotalAfterVat")),r(3),y("",i._AppModeService.GetTwoNumberAfterZero(i.Invoice.TotalInvoiceAfterVat)," "),r(2),I("ngIf",i.Invoice.Id==0),r(),I("ngIf",i._Apiservice.environment.SystemUpdate),r(),I("ngIf",i.Invoice.Id>0&&(i.ScreenName=="SaleInvoice"||"BuyInvoice")),r(2),h(v(108,95,"Model.Close"))}}var Ft=(()=>{let _=class _{constructor(t,e,n,d,S){this._ActivatedRoute=t,this._SharedObjectModelService=e,this._DefaultSettingsService=n,this._AppModeService=d,this._Apiservice=S,this.SignalR=!1,this.GlResponse=!1,this.TablePaging={},this.PageTitle="",this.ScreenName="",this.InvoiceName="",this.PrintUrl="",this.AddUrl="",this.UpdateUrl="",this.DeleteUrl="",this.GetById="",this.Invoice={InvoiceCollected:!1,ClientType:2,DocNo:0,DocDate:"",InvoiceDetails:[],TotalInvoice:0,TotalDiscRate:0,TotalDisc:0,TotalInvoiceAfterDisc:0,TotalInvoiceAfterVat:0,TotalInvoiceVatAmount:0,TotalVatRate:0,Cash:"",Visa:"",Debt:"",TreasuryId:null,TreasuryName:"",BankAccountId:null,BankAccountName:"",EmployeeId:null,EmployeeName:"",StoreId:null,StoreName:"",ClientId:null,ClientName:"",SupplierId:null,SupplierName:"",Id:0,PaymentType:1,Name:"",Notes:"",Code:""},this.SupplierArr=[],this.ClientArr=[],this.StoreArr=[],this.TreasuryArr=[],this.BankAccountArr=[],this.EmployeeArr=[],this.ItemBalanceList=[],this.InvoiceDocNo="",this.InvoiceType=0,this.InvoiceCash=0,this.InvoiceVisa=0,this.InvoiceDept=0}ngOnChanges(t){let e=Number(this._ActivatedRoute.snapshot.queryParams.Id);e>0&&this.GetByIdRoute(e)}ngOnInit(){this.SignalR&&(this.StartConnection(),this.Hub_Connection?.state=="Connecting"&&this.ServerListener())}GetByIdRoute(t){this._Apiservice.getById(this.GetById,t,!0).pipe(w(this._Apiservice.destroy$)).subscribe({next:e=>{e.IsSuccess==!0&&e.Obj!=null?(this.GLComponent.Gl=e.Obj.Gl,this.Drow(e.Obj.model),this._AppModeService._NgbModal.open(this.ContentModel,{fullscreen:!0,backdrop:"static"})):this._AppModeService._Toastr.error(e.Message)}})}GetPageInfo(){this._AppModeService.DisabledButton=!0,this._Apiservice.get(`${this.ScreenName}EP/GetPageInfo`,!1).pipe(w(this._Apiservice.destroy$)).subscribe({next:t=>{t.IsSuccess==!0&&t.Obj!=null?(this.Invoice.DocNo=t.Obj,this._AppModeService.DisabledButton=!1):(this._AppModeService.DisabledButton=!1,this._AppModeService._Toastr.error(t.Message))},error:t=>{this._AppModeService.DisabledButton=!1}})}StartConnection(){this.Hub_Connection=new we().withUrl(`${J.signalrUrl}/${this.ScreenName}`,{skipNegotiation:!0,transport:Ne.WebSockets,accessTokenFactory:()=>this._Apiservice.getToken()}).configureLogging(be.Error).build(),this.Hub_Connection.start().then(()=>{console.log("Hub Connection Success")}).catch(t=>{console.log(t)})}ServerListener(){this.Hub_Connection?.on(`Update${this.ScreenName}`,t=>{let e=this._Apiservice.UserIdFromCookies();Number(e.BranchId)==t.BranchId&&t.UserId!=e.Id&&t.Id==this.Invoice.Id&&(this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Show.UpdateModelAnother"),t.User),this._AppModeService._NgbModal.dismissAll())}),this.Hub_Connection?.on(`Delete${this.ScreenName}`,t=>{let e=this._Apiservice.UserIdFromCookies();Number(e.BranchId)==t.BranchId&&t.UserId!=e.Id&&t.Id==this.Invoice.Id&&(this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Show.DeleteModelAnother"),t.User),this.DynamicComponent.Paging.DataReturn=this.DynamicComponent.Paging.DataReturn.filter(n=>n.Id!=t.Id),this._AppModeService._NgbModal.dismissAll())})}OpenModal(){this.InvoiceDocNo="",this.ResetPage()}OpenGl(){this.GLComponent.Open()}ChangeSearchApi(t,e){let n=`${e.searchTerm}`.trim();(n==""||n=="null")&&(e.searchTerm="",n=""),this._AppModeService.CurrentPage+=1;let d={TableName:t,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:n,SearchField:"Name"};t=="Storages"&&(d.BranchFilter=!0),t=="Treasury"&&(d.BranchFilter=!0),this._Apiservice.post("Global/GetAll",d,!1).pipe(w(this._Apiservice.destroy$)).subscribe({next:S=>{S.IsSuccess==!0&&S.Obj!=null?this.HandleResponse(S.Obj,t):this._AppModeService._Toastr.error(S.Message)}})}HandleResponse(t,e){this._SharedObjectModelService.TotalItems=0,this._SharedObjectModelService.TotalItems=t.TotalItems,e=="Suppliers"&&(this.SupplierArr=this._SharedObjectModelService.RemoveDuplicates(this.SupplierArr.concat(t.DataReturn),"Id")),e=="Clients"&&(this.ClientArr=this._SharedObjectModelService.RemoveDuplicates(this.ClientArr.concat(t.DataReturn),"Id")),e=="Storages"&&(this.StoreArr=this._SharedObjectModelService.RemoveDuplicates(this.StoreArr.concat(t.DataReturn),"Id")),e=="Treasury"&&(this.TreasuryArr=this._SharedObjectModelService.RemoveDuplicates(this.TreasuryArr.concat(t.DataReturn),"Id")),e=="BankAccounts"&&(this.BankAccountArr=this._SharedObjectModelService.RemoveDuplicates(this.BankAccountArr.concat(t.DataReturn),"Id")),e=="Employee"&&(this.EmployeeArr=this._SharedObjectModelService.RemoveDuplicates(this.EmployeeArr.concat(t.DataReturn),"Id"))}SelectValue(t,e){if(t!=null&&(t>0||t!="")){let n=[];e=="Supplier"&&(n=this.SupplierArr),e=="Client"&&(n=this.ClientArr),e=="Store"&&(n=this.StoreArr),e=="Treasury"&&(n=this.TreasuryArr),e=="BankAccount"&&(n=this.BankAccountArr),e=="Employee"&&(n=this.EmployeeArr);let d=n.find(S=>S.Id==t);if(d==null){this._AppModeService.DontPlay();return}else this.Invoice[`${e}Id`]=t,this.Invoice[`${e}Name`]=d.Name}else this.Invoice[`${e}Id`]=null,this.Invoice[`${e}Name`]=""}ChangePamentType(t){this.Invoice.BankAccountId=null,this.Invoice.BankAccountName="",this.Invoice.TreasuryId=null,this.Invoice.TreasuryName="",this.Invoice.EmployeeId=null,this.Invoice.EmployeeName="",t==1&&(this.Invoice.PaymentType=1,this.Invoice.Visa="",this.Invoice.Debt="",this.Invoice.Cash=this.Invoice.TotalInvoiceAfterVat),t==2&&(this.Invoice.PaymentType=2,this.Invoice.Cash="",this.Invoice.Visa="",this.Invoice.Debt=this.Invoice.TotalInvoiceAfterVat),t==3&&(this.Invoice.Visa="",this.Invoice.Cash="",this.Invoice.Debt="",this.Invoice.TreasuryId=null,this.Invoice.TreasuryName="",this.Invoice.BankAccountId=null,this.Invoice.BankAccountName=""),this.ChangeCash()}ChangeCash(){this.Invoice.PaymentType==1&&(this.Invoice.Cash=Number(this.Invoice.TotalInvoiceAfterVat-Number(this.Invoice.Visa)),this.Invoice.Visa=Number(this.Invoice.TotalInvoiceAfterVat-Number(this.Invoice.Cash))),this.Invoice.PaymentType==2&&(this.Invoice.Debt=Number(this.Invoice.TotalInvoiceAfterVat-(Number(this.Invoice.Cash)+Number(this.Invoice.Visa)))),this.Invoice.TreasuryId=Number(this.Invoice.Cash)==0?null:this.Invoice.TreasuryId,this.Invoice.BankAccountId=Number(this.Invoice.Visa)==0?null:this.Invoice.BankAccountId,this.Invoice.TreasuryName=Number(this.Invoice.Cash)==0?"":this.Invoice.TreasuryName,this.Invoice.BankAccountName=Number(this.Invoice.Visa)==0?"":this.Invoice.BankAccountName,this.Invoice.Cash=Number(this.Invoice.Cash)==0?"":this._AppModeService.GetTwoNumberAfterZero(this.Invoice.Cash),this.Invoice.Visa=Number(this.Invoice.Visa)==0?"":this._AppModeService.GetTwoNumberAfterZero(this.Invoice.Visa),this.Invoice.Debt=Number(this.Invoice.Debt)==0?"":this._AppModeService.GetTwoNumberAfterZero(this.Invoice.Debt),this.DefaultBankTreasury()}HandleMyDefaultSettings(){let t=this._DefaultSettingsService.DefaultSettings;this.ScreenName=="ReturnSaleInvoice"&&(this.Invoice.PaymentType=t.SaleInvoicePaymentType>0?t.SaleInvoicePaymentType:1),this.ScreenName=="ReturnBuyInvoice"&&(this.Invoice.PaymentType=t.BuyInvoicePaymentType>0?t.BuyInvoicePaymentType:1)}DefaultBankTreasury(){let t=this._DefaultSettingsService.DefaultSettings;this.ScreenName=="ReturnSaleInvoice"&&(this.Invoice.Cash>0&&t.ReturnSaleInvoiceTreasuryId>0&&this.Invoice.Id==0&&(this.TreasuryArr=[],this.Invoice.TreasuryId=t.ReturnSaleInvoiceTreasuryId,this.TreasuryArr.push({Id:t.ReturnSaleInvoiceTreasuryId,Name:t.ReturnSaleInvoiceTreasuryName})),this.Invoice.Visa>0&&t.ReturnSaleInvoiceBankAccountId>0&&this.Invoice.Id==0&&(this.BankAccountArr=[],this.Invoice.BankAccountId=t.ReturnSaleInvoiceBankAccountId,this.BankAccountArr.push({Id:t.ReturnSaleInvoiceBankAccountId,Name:t.ReturnSaleInvoiceBankAccountName}))),this.ScreenName=="ReturnBuyInvoice"&&(this.Invoice.Cash>0&&t.ReturnBuyInvoiceTreasuryId>0&&this.Invoice.Id==0&&(this.TreasuryArr=[],this.Invoice.TreasuryId=t.ReturnBuyInvoiceTreasuryId,this.TreasuryArr.push({Id:t.ReturnBuyInvoiceTreasuryId,Name:t.ReturnBuyInvoiceTreasuryName})),this.Invoice.Visa>0&&t.ReturnBuyInvoiceBankAccountId>0&&this.Invoice.Id==0&&(this.BankAccountArr=[],this.Invoice.BankAccountId=t.ReturnBuyInvoiceBankAccountId,this.BankAccountArr.push({Id:t.ReturnBuyInvoiceBankAccountId,Name:t.ReturnBuyInvoiceBankAccountName})))}ConvertToNumer(t){return Number(t)}LowQuantity(t){let e=Number(this.Invoice.InvoiceDetails[t].Quantity),n=Number(this.Invoice.InvoiceDetails[t].Price),d=Number(this.Invoice.InvoiceDetails[t].Vat),S=Number(this.Invoice.InvoiceDetails[t].SaveQuantity),N=Number(this.Invoice.InvoiceDetails[t].SaveDiscount),Re=Number(this.Invoice.InvoiceDetails[t].SaveTotalPrice),B=Number(this.Invoice.InvoiceDetails[t].SaveDiscountRate),Ve=Number(this.Invoice.InvoiceDetails[t].RealQuantity);if(e==0||e<0||e>S){this.Invoice.InvoiceDetails[t].SaveQuantity=S,this.Invoice.InvoiceDetails[t].Discount=this.Invoice.InvoiceDetails[t].SaveDiscount,this.Invoice.InvoiceDetails[t].DiscountRate=this.Invoice.InvoiceDetails[t].SaveDiscountRate,this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=0,this.Invoice.InvoiceDetails[t].TotalPriceAfterVat=0,e<0&&(this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorQuantity")),this.Invoice.InvoiceDetails[t].Quantity=""),e>S&&(this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ReturnedQtyUpQuantity")),this.Invoice.InvoiceDetails[t].Quantity=""),this.Confirm();return}if(e>0){let E=Number(e)/Ve;if(N>0){let Q=N*E;this.Invoice.InvoiceDetails[t].Discount=Q,this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=e*n-N*E}if(B>0){let Q=Re*B/100;this.Invoice.InvoiceDetails[t].DiscountRate=B*E,this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=e*n-Q*E}B==0&&N==0&&(this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=e*n,this.Invoice.InvoiceDetails[t].TotalPriceAfterVat=e*n*d/100),this.Confirm()}}TotalInvoiceVatAmount(){let t=0;for(let e=0;e<this.Invoice.InvoiceDetails.length;e++){let n=Number(this.Invoice.InvoiceDetails[e].Quantity),d=Number(this.Invoice.InvoiceDetails[e].TotalPriceAfterDiscount);if(n>0){let S=Number(this.Invoice.InvoiceDetails[e].Vat);t+=d*(S/100)}}return Number(t)}Confirm(){this.Invoice.TotalDiscRate=0,this.Invoice.TotalInvoiceAfterDisc=0,this.Invoice.TotalInvoiceAfterVat=0,this.Invoice.TotalVatRate=0,this.Invoice.TotalDisc=0,this.Invoice.TotalInvoice=0,this.Invoice.TotalInvoiceVatAmount=0;let t=this.Invoice.InvoiceDetails.filter(e=>Number(e.Quantity)>0);for(let e=0;e<t.length;e++){let n=Number(t[e].SaveQuantity),d=Number(t[e].Quantity),S=Number(t[e].Price),N=Number(t[e].TotalPriceAfterDiscount);if(d>n)return this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ReturnedQtyUpQuantity")),!1;this.Invoice.TotalInvoice+=S*d,this.Invoice.TotalDisc+=S*d-N}return this.Invoice.TotalDiscRate=this.Invoice.TotalInvoice==0?0:Number(this.Invoice.TotalDisc/this.Invoice.TotalInvoice*100),this.Invoice.TotalInvoiceAfterDisc=Number(this.Invoice.TotalInvoice-this.Invoice.TotalDisc),this.Invoice.TotalInvoiceVatAmount=this.TotalInvoiceVatAmount(),this.Invoice.TotalInvoiceAfterVat=Number(this.Invoice.TotalInvoiceAfterDisc+this.Invoice.TotalInvoiceVatAmount),this.Invoice.TotalVatRate=this.Invoice.TotalInvoiceAfterDisc==0?0:Number(this.Invoice.TotalInvoiceVatAmount/this.Invoice.TotalInvoiceAfterDisc*100),this.Invoice.TotalInvoiceAfterVat=this._AppModeService.GetTwoNumberAfterZero(Number(this.Invoice.TotalInvoiceAfterVat)),this.ChangeCash(),!0}ShowToEdite(t){this.InvoiceDocNo="",this.GLComponent.Gl=t.Gl,this.Drow(t.PageModel)}Drow(t){this.Invoice={ClientType:t.ClientType,DocNo:t.DocNo,DocDate:new Date(t.DocDate),Id:t.Id,PaymentType:t.PaymentType,Name:t.Name,Notes:t.Notes,Code:t.Code,TotalInvoice:t.TotalInvoice,TotalDiscRate:t.TotalDiscRate,TotalDisc:t.TotalDisc,TotalInvoiceAfterDisc:t.TotalInvoiceAfterDisc,TotalInvoiceAfterVat:t.TotalInvoiceAfterVat,TotalInvoiceVatAmount:t.TotalInvoiceVatAmount,TotalVatRate:t.TotalVatRate,Cash:t.Cash,Visa:t.Visa,Debt:t.Debt,TreasuryId:t.TreasuryId,TreasuryName:t.TreasuryName,BankAccountId:t.BankAccountId,BankAccountName:t.BankAccountName,EmployeeId:t.EmployeeId,EmployeeName:t.EmployeeName,StoreId:t.StoreId,StoreName:t.StoreName,ClientId:t.ClientId,ClientName:t.ClientName,SupplierId:t.SupplierId,SupplierName:t.SupplierName,InvoiceDetails:t[`${this.ScreenName}Details`]},t.SupplierId>0&&(this.SupplierArr=[{Id:t.SupplierId,Name:t.SupplierName}]),t.ClientId>0&&(this.ClientArr=[{Id:t.ClientId,Name:t.ClientName}]),t.TreasuryId>0&&(this.TreasuryArr=[{Id:t.TreasuryId,Name:t.TreasuryName}]),t.BankAccountId>0&&(this.BankAccountArr=[{Id:t.BankAccountId,Name:t.BankAccountName}]),t.EmployeeId>0&&(this.EmployeeArr=[{Id:t.EmployeeId,Name:t.EmployeeName}]),t.StoreId>0&&(this.StoreArr=[{Id:t.StoreId,Name:t.StoreName}]);for(let e=0;e<this.Invoice.InvoiceDetails.length;e++){let n=this.Invoice.InvoiceDetails[e];this.Invoice.InvoiceDetails[e].Items=[{Id:n.ProductId,Name:n.ProductName,NameAndCode:n.ProductName}],this.Invoice.InvoiceDetails[e].ProductUnits=[{Id:n.ProductUnitId,Name:n.ProductUnitName,NameAndUnitFactor:n.ProductUnitName}]}this._AppModeService.DisabledButton=!1}Search(){if(Number(this.InvoiceDocNo)==0||this.InvoiceDocNo==null||isNaN(Number(this.InvoiceDocNo))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.EnterInvoiceNumber"));return}this._AppModeService.DisabledButton=!0,this._Apiservice.getById(`${this.InvoiceName}EP/GetByDocNo`,Number(this.InvoiceDocNo),!0).pipe(w(this._Apiservice.destroy$)).subscribe({next:t=>{if(t.IsSuccess==!0&&t.Obj!=null){this._AppModeService.DisabledButton=!1;let e=t.Obj;this.ResetPage(),this.GetPageInfo(),this.InvoiceCash=e.Cash,this.InvoiceVisa=e.Visa,this.InvoiceDept=e.Debt,this.InvoiceType=e.PaymentType,this.Invoice[`${this.InvoiceName}DocNo`]=e.DocNo,this.Invoice[`${this.InvoiceName}Id`]=e.Id,this.InvoiceName=="BuyInvoice"&&(this.Invoice.SupplierId=e.SupplierId,this.Invoice.SupplierName=e.SupplierName,this.SupplierArr=[{Id:e.SupplierId,Name:e.SupplierName}]),this.InvoiceName=="SaleInvoice"&&(this.Invoice.ClientId=e.ClientId,this.Invoice.ClientName=e.ClientName,this.ClientArr=[{Id:e.ClientId,Name:e.ClientName}]),this.Invoice.StoreId=e.StoreId,this.Invoice.StoreName=e.StoreName,this.StoreArr=[{Id:e.StoreId,Name:e.StoreName}],this.Invoice.PaymentType=1,this.Invoice.InvoiceDetails=e[`${this.InvoiceName}Details`];for(let n=0;n<this.Invoice.InvoiceDetails.length;n++)this.Invoice.InvoiceDetails[n].Id=0,this.Invoice.InvoiceDetails[n].SaveDiscount=Number(this.Invoice.InvoiceDetails[n].Discount),this.Invoice.InvoiceDetails[n].SaveDiscountRate=Number(this.Invoice.InvoiceDetails[n].DiscountRate),this.Invoice.InvoiceDetails[n].SavePrice=Number(this.Invoice.InvoiceDetails[n].Price),this.Invoice.InvoiceDetails[n].SaveTotalPrice=Number(this.Invoice.InvoiceDetails[n].TotalPrice),this.Invoice.InvoiceDetails[n].SaveTotalPriceAfterDiscount=Number(this.Invoice.InvoiceDetails[n].TotalPriceAfterDiscount),this.Invoice.InvoiceDetails[n].RealQuantity=Number(this.Invoice.InvoiceDetails[n].Quantity),this.Invoice.InvoiceDetails[n].SaveQuantity=Number(this.Invoice.InvoiceDetails[n].Quantity)-Number(this.Invoice.InvoiceDetails[n].ReturnedQty),this.Invoice.InvoiceDetails[n].Quantity="",this.Invoice.InvoiceDetails[n].TotalPrice=this.Invoice.InvoiceDetails[n].SaveQuantity*Number(this.Invoice.InvoiceDetails[n].SavePrice),this.Invoice.InvoiceDetails[n].TotalPriceAfterDiscount=0,this.Invoice.InvoiceDetails[n].Items=[{Id:this.Invoice.InvoiceDetails[n].ProductId,Name:this.Invoice.InvoiceDetails[n].ProductName}],this.Invoice.InvoiceDetails[n].ProductUnits=[{Id:this.Invoice.InvoiceDetails[n].ProductUnitId,Name:this.Invoice.InvoiceDetails[n].ProductUnitName,NameAndUnitFactor:this.Invoice.InvoiceDetails[n].ProductUnitName}]}else this._AppModeService.DisabledButton=!1,this.ResetPage(),this._AppModeService._Toastr.error(t.Message)},error:t=>{this._AppModeService.DisabledButton=!1}})}Save(){if(this.Invoice.DocDate==""||this.Invoice.DocDate==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BuyInvoice.Error.EnterDate"));return}if(this.Confirm()==!1)return;if(this.Invoice.TotalInvoice<0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(this.Invoice.TotalInvoiceAfterVat<0||this.Invoice.TotalInvoiceAfterVat<0&&this.Invoice.TotalInvoiceAfterDisc<0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BuyInvoice.Error.ErrorTotal"));return}if(Number(this.Invoice.Visa)<0||isNaN(Number(this.Invoice.Visa))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(Number(this.Invoice.Cash)<0||isNaN(Number(this.Invoice.Cash))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(Number(this.Invoice.Debt)<0||isNaN(Number(this.Invoice.Debt))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorDebt"));return}if(Number(this.Invoice.Visa)>0&&(this.Invoice.BankAccountId<=0||this.Invoice.BankAccountId==null)){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.EnterBank"));return}if(Number(this.Invoice.Cash)>0&&(this.Invoice.TreasuryId<=0||this.Invoice.TreasuryId==null)){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.EnterTreasury"));return}if(this.Invoice.PaymentType==1&&Number(this.Invoice.Cash)+Number(this.Invoice.Visa)!=this.Invoice.TotalInvoiceAfterVat){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(this.Invoice.PaymentType==2&&Number(this.Invoice.Cash)+Number(this.Invoice.Visa)+Number(this.Invoice.Debt)!=this.Invoice.TotalInvoiceAfterVat){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorDebt"));return}if(this.Invoice.PaymentType==2&&Number(this.Invoice.Debt)<=0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorDebt"));return}if(this.Invoice.PaymentType==3&&this.Invoice.EmployeeId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("SalesReport.ChooseEmployee"));return}let t={InvoiceDetails:this.Invoice.InvoiceDetails.filter(e=>Number(e.Quantity)>0),Id:this.Invoice.Id,Name:this.Invoice.Name,Notes:this.Invoice.Notes,Code:this.Invoice.Code,TotalInvoice:this.Invoice.TotalInvoice,TotalDisc:this.Invoice.TotalDisc,TotalDiscRate:this.Invoice.TotalDiscRate,TotalInvoiceAfterDisc:this.Invoice.TotalInvoiceAfterDisc,TotalInvoiceAfterVat:this.Invoice.TotalInvoiceAfterVat,TotalInvoiceVatAmount:this.Invoice.TotalInvoiceVatAmount,TotalVatRate:this.Invoice.TotalVatRate,Cash:Number(this.Invoice.Cash),Visa:Number(this.Invoice.Visa),Debt:Number(this.Invoice.Debt),PaymentType:Number(this.Invoice.PaymentType),DocDate:this._Apiservice.ConvertISODate(this.Invoice.DocDate),DocNo:this.Invoice.DocNo,SupplierId:this.Invoice.SupplierId,SupplierName:this.Invoice.SupplierName,StoreId:this.Invoice.StoreId,StoreName:this.Invoice.StoreName,TreasuryId:this.Invoice.TreasuryId,TreasuryName:this.Invoice.TreasuryName,BankAccountId:this.Invoice.BankAccountId,BankAccountName:this.Invoice.BankAccountName,EmployeeId:this.Invoice.EmployeeId,EmployeeName:this.Invoice.EmployeeName,ClientId:this.Invoice.ClientId,ClientName:this.Invoice.ClientName};t[`Return${this.InvoiceName}Details`]=this.Invoice.InvoiceDetails.filter(e=>Number(e.Quantity)>0),t[`${this.InvoiceName}DocNo`]=this.Invoice[`${this.InvoiceName}DocNo`],t[`${this.InvoiceName}Id`]=this.Invoice[`${this.InvoiceName}Id`],t.Id==0&&this._Apiservice.post(`${this.AddUrl}`,t,!0).pipe(w(this._Apiservice.destroy$)).subscribe({next:e=>{e.IsSuccess==!0&&e.Obj!=null?(this._AppModeService._Toastr.success(this._AppModeService._Translate.instant("Success.AddSuccess")),this.InvoiceDocNo="",this.ResetPage(),this.DynamicComponent.Paging.DataReturn.push(e.Obj)):this._AppModeService._Toastr.error(e.Message)}}),t.Id>0&&this._Apiservice.put(this.UpdateUrl,t,!0).pipe(w(this._Apiservice.destroy$)).subscribe({next:e=>{if(e.IsSuccess==!0&&e.Obj!=null){this._AppModeService._Toastr.success(e.Message);let n=e.Obj,d=this.DynamicComponent.Paging.DataReturn.find(S=>S.Id==n.Id);d!=null&&Object.assign(d,n),this.ResetPage(),this.GetPageInfo()}else this._AppModeService._Toastr.error(e.Message)}})}ConfirmDelete(t,e=void 0){e!=null&&e!=null&&(e.Id>0||e.Id!="")&&(this.Invoice.Id=e.Id),this._AppModeService._NgbModal.open(t,{size:"xxl",centered:!0})}ResetPage(){this._AppModeService.DisabledButton=!1,this.Invoice={InvoiceCollected:!1,ClientType:2,DocNo:0,DocDate:"",InvoiceDetails:[],TotalInvoice:0,TotalDiscRate:0,TotalDisc:0,TotalInvoiceAfterDisc:0,TotalInvoiceAfterVat:0,TotalInvoiceVatAmount:0,TotalVatRate:0,Cash:"",Visa:"",Debt:"",TreasuryId:null,TreasuryName:"",BankAccountId:null,BankAccountName:"",EmployeeId:null,EmployeeName:"",StoreId:null,StoreName:"",ClientId:null,ClientName:"",SupplierId:null,SupplierName:"",Id:0,PaymentType:1,Name:"",Notes:"",Code:"",InvoiceCollection:0},this.InvoiceCash=0,this.InvoiceVisa=0,this.InvoiceDept=0,this._DefaultSettingsService.ResetDate(this.Invoice),this.HandleMyDefaultSettings()}trackByMethod(t,e){return e.Id}ngOnDestroy(){this._Apiservice.destroy$.next(),this._Apiservice.destroy$.complete()}};_.\u0275fac=function(e){return new(e||_)(V(Y),V(xe),V(Ce),V(pe),V(K))},_.\u0275cmp=L({type:_,selectors:[["app-dynamic-return-invoice"]],viewQuery:function(e,n){if(e&1&&(P(Be,5),P(Ee,5),P(Pe,5)),e&2){let d;M(d=k())&&(n.GLComponent=d.first),M(d=k())&&(n.DynamicComponent=d.first),M(d=k())&&(n.ContentModel=d.first)}},inputs:{SignalR:"SignalR",GlResponse:"GlResponse",TablePaging:"TablePaging",PageTitle:"PageTitle",ScreenName:"ScreenName",InvoiceName:"InvoiceName",PrintUrl:"PrintUrl",AddUrl:"AddUrl",UpdateUrl:"UpdateUrl",DeleteUrl:"DeleteUrl",GetById:"GetById"},standalone:!0,features:[j,F],decls:6,vars:8,consts:[["dynamiccomponent",""],["content",""],["GLComponent",""],["SelectTreasury",""],["SelectBank",""],["SelectEmployee",""],[3,"OpenModalEvent","ShowToEditeEvent","PageTitle","TablePaging","FullScreen","GlResponse","GetById","PrintUrl","DeleteUrl","OutModal"],[3,"PageTitle"],[1,"modal-body","bg-white","p-0","m-0","Invoicemodalbody"],[1,"d-flex","flex-wrap","justify-content-between","align-items-start","col-12","py-2"],["class","col-12 col-sm-6 col-md-4 col-lg-2 p-1 d-flex flex-wrap ",4,"ngIf"],[1,"TotalsContainer","d-flex","flex-wrap","px-lg-2","col-12","col-sm-6","col-md-8","col-lg-10"],[1,"smal-header"],["class","",4,"ngIf"],[4,"ngIf"],["id","Table",1,"DivPaging","table-responsive","col-12","p-0","ProductTable"],[1,"",3,"value","responsive","scrollable"],["pTemplate","header"],["pTemplate","body"],[1,"bg-white","d-flex","flex-wrap","align-items-end","col-12"],[1,"col-12","col-md-6","col-xl-1","p-1"],["type","number","appNumericInput","",1,"form-control","text-center",3,"value","disabled"],[1,"col-12","col-md-6","col-xl-2","p-1"],["type","text",1,"form-control","text-center",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","col-lg-3","col-xl-2","p-1"],["class","d-block text-center ",4,"ngIf"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12","class"," shadow-none text-center w-100",3,"ngModel","showTime","showIcon","showOnFocus","showOtherMonths","ngModelChange",4,"ngIf"],["bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"ngModelChange","items","dropdownPosition","disabled","placeholder","virtualScroll","ngModel"],["ng-option-tmp",""],["class","col-12 col-md-4 col-lg-3 col-xl-2 p-1",4,"ngIf"],[1,"bg-white","d-flex","flex-wrap","align-items-end","col-12","py-2","InvoiceContent"],[1,"col-12","col-md-4","col-lg-2","col-xl-1","p-1"],["name","","id","",1,"form-select",3,"change","ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngIf"],["bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","dropdownPosition","autofocus","placeholder","virtualScroll","searchable","disabled","ngModel"],["ng-header-tmp",""],["bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","dropdownPosition","placeholder","virtualScroll","searchable","disabled","ngModel"],["class","col-12 col-md-4 col-lg-2 my-1 px-2",4,"ngIf"],[1,"col-12","col-md-4","col-lg-2","px-3","my-1","my-lg-0"],["id","Debt","min","0","type","number","appNumericInput","","class","form-control shadow-none text-center",3,"disabled","value",4,"ngIf"],[1,"d-flex","flex-wrap","px-lg-2","TotalsContainer"],[1,""],[1,"mx-1"],[1,"modal-footer","bg-white","py-2","px-4","m-0"],["class","btn btn-Add m-0",3,"disabled","click",4,"ngIf"],["class","btn btn-Add",3,"click",4,"ngIf"],["type","button",1,"btn","btn-light","btn-Close","border","border-1","border-dark",3,"click"],[1,"col-12","col-sm-6","col-md-4","col-lg-2","p-1","d-flex","flex-wrap"],[1,"col-9","px-1"],["min","0","id","InvoiceNo","type","number","appNumericInput","","autofocus","",1,"form-control","shadow-none","text-center",3,"keyup","change","ngModelChange","ngModel","placeholder"],[1,"btn","btn-Primary",3,"click","disabled"],[1,"col-3"],[1,"col-2"],[1,"",3,"title"],[1,"text-center",3,"title"],[4,"ngFor","ngForOf"],[3,"title"],[1,"text-dark"],[1,"col-10","col-xl-12","mx-auto"],["min","0","type","number","appNumericInput","",1,"form-control","text-center","mx-auto",3,"change","keyup","ngModelChange","id","name","ngModel"],["class","text-dark text-center d-block",4,"ngIf"],[1,"text-dark","text-center","d-block"],[1,"d-block","text-center"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","ngModel","showTime","showIcon","showOnFocus","showOtherMonths"],["min","0","type","number","appNumericInput","","id","Cash",1,"form-control","py-2","shadow-none","text-center",3,"keyup","change","ngModelChange","placeholder","ngModel"],[1,"form-text","text-muted"],["min","0","type","number","appNumericInput","","id","Visa",1,"form-control","py-2","shadow-none","text-center",3,"keyup","change","ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","col-lg-2","my-1","px-2"],[1,"m-0"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","dropdownPosition","autofocus","virtualScroll","searchable","ngModel"],["id","Debt","min","0","type","number","appNumericInput","",1,"form-control","shadow-none","text-center",3,"disabled","value"],[1,"btn","btn-Add","m-0",3,"click","disabled"],[1,"mx-1","pi","pi-save"],["class","btn btn-Refresh",3,"disabled","click",4,"ngIf"],[1,"btn","btn-Refresh",3,"click","disabled"],[1,"btn","btn-Add",3,"click"]],template:function(e,n){if(e&1){let d=x();a(0,"app-dynamic-component",6,0),T("OpenModalEvent",function(){return p(d),u(n.OpenModal())})("ShowToEditeEvent",function(N){return p(d),u(n.ShowToEdite(N))}),c(),g(2,ht,109,97,"ng-template",null,1,Z),R(4,"app-glsheard",null,2)}if(e&2){let d=D(3);I("PageTitle",n.PageTitle)("TablePaging",n.TablePaging)("FullScreen",!0)("GlResponse",!0)("GetById",n.GetById)("PrintUrl",n.PrintUrl)("DeleteUrl",n.DeleteUrl)("OutModal",d)}},dependencies:[z,he,de,Ie,ve,me,ue,_e,se,ae,ce,te,oe,re,ie,le,ne,ge,ye,$,q,Se,ee,X,De,Ae,fe,Te]});let o=_;return o})();export{Ft as a};
