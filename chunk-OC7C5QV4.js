import{a as te}from"./chunk-OZ63RRZR.js";import{a as X,b as Y,c as Z,d as ee}from"./chunk-SU7IEUNK.js";import{c as K}from"./chunk-F7IHWOEY.js";import{c as H,d as G}from"./chunk-GJAIQ3XH.js";import{c as P,d as U,i as q,l as z,v as J}from"./chunk-UA6GT64L.js";import{G as $,d as Q}from"./chunk-GOUT62LL.js";import{$b as V,Cb as d,Db as _,Eb as k,Ib as x,Mb as v,Nb as T,Tb as O,Ub as L,Vb as N,Wb as u,X as A,Xb as h,Yb as S,Zb as I,_b as w,ac as b,bc as y,cc as j,db as p,dc as W,eb as M,ia as R,na as D,nc as g,oc as f,vb as B,xa as i,xb as C,ya as a}from"./chunk-RH76WUG2.js";import{a as E,b as F}from"./chunk-3EYC4JTX.js";var ne=["SelectItems"];function re(l,m){if(l&1&&(d(0,"small",21),h(1),_()),l&2){let s=T();p(),w("Loaded ",s.Branches.length," of ",s._SharedObjectModelService.TotalItems,"")}}function ie(l,m){if(l&1&&h(0),l&2){let s=m.item;I(" ",s.Name," ")}}function ae(l,m){if(l&1&&(d(0,"small",21),h(1),_()),l&2){let s=T();p(),w("Loaded ",s.Storages.length," of ",s._SharedObjectModelService.TotalItems,"")}}function oe(l,m){if(l&1&&h(0),l&2){let s=m.item;I(" ",s.Name," ")}}function le(l,m){if(l&1&&(d(0,"small",21),h(1),_()),l&2){let s=T();p(),w("Loaded ",s.Items.length," of ",s._SharedObjectModelService.TotalItems,"")}}function ce(l,m){if(l&1&&h(0),l&2){let s=m.item;I(" ",s.NameAndCode," ")}}function se(l,m){if(l&1&&(d(0,"tr")(1,"td")(2,"span",22),h(3),_()(),d(4,"td")(5,"span",22),h(6),_()()()),l&2){let s=m.$implicit;p(3),I(" ",s.UnitName+" - "+s.UnitFactor," "),p(3),S(s.Qty)}}var be=(()=>{let m=class m{constructor(c,o,e){this._SharedObjectModelService=c,this._AppModeService=o,this._Apiservice=e,this._ServiceLifeTime=R(P),this.SearchModel={BranchId:null,StoreId:null,ProductId:null},this.ItemBalanceFrom=[],this.Branches=[],this.Storages=[],this.Items=[]}ngOnInit(){}ChangeSearchApi(c,o){let e=`${o.searchTerm}`.trim();(e==""||e=="null")&&(o.searchTerm="",e=""),this._AppModeService.CurrentPage+=1;let t={TableName:c,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:e,SearchField:"Name"};c=="Storages"&&(t.Conditions=`BranchId = ${this.SearchModel.BranchId}`),c=="Items"&&(t.Columns=["Id","Name","Code"],t.Conditions="ProductType != 2"),this._Apiservice.post("Global/GetAll",t,!1).pipe(A(this._ServiceLifeTime.Destroyed$)).subscribe({next:r=>{this.HandleResponse(r.Obj,c)}})}HandleResponse(c,o){this._SharedObjectModelService.TotalItems=c.TotalItems,o=="Branch"&&(this.Branches=this._SharedObjectModelService.RemoveDuplicates(this.Branches.concat(c.DataReturn),"Id")),o=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(c.DataReturn),"Id")),o=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(c.DataReturn),"Id"),this.Items=this.Items.map(e=>F(E({},e),{NameAndCode:`${e.Name} - ${e.Code}`})))}SelectValue(c,o){if(c!=null&&(c>0||c!="")){let e=[];o=="Branch"&&(e=this.Branches),o=="Store"&&(e=this.Storages),o=="Product"&&(e=this.Items);let t=e.find(r=>r.Id==c);if(t==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${o}Id`]=c,this.SearchModel[`${o}Name`]=t.Name}else this.SearchModel[`${o}Id`]=null,this.SearchModel[`${o}Name`]="";o=="Branch"&&(this.SearchModel.StoreId=null,this.Storages=[])}Search(){if(this.SearchModel.BranchId==0||this.SearchModel.BranchId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.BranchId"));return}if(this.SearchModel.StoreId==0||this.SearchModel.StoreId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.StoreId"));return}if(this.SearchModel.ProductId==0||this.SearchModel.ProductId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.SelectItem"));return}this._Apiservice.post("ItemEP/ProductBalance",this.SearchModel,!0).pipe(A(this._ServiceLifeTime.Destroyed$)).subscribe({next:c=>{this.ItemBalanceFrom=c.Obj.StorageBalance}})}ngOnDestroy(){}};m.\u0275fac=function(o){return new(o||m)(M(te),M(K),M(U))},m.\u0275cmp=D({type:m,selectors:[["app-balance-item-branch"]],viewQuery:function(o,e){if(o&1&&O(ne,5),o&2){let t;L(t=N())&&(e.ngSelectComponent=t.first)}},standalone:!0,features:[j([P]),W],decls:48,vars:38,consts:[["Select1",""],["SelectFromStore",""],["clas","bg-light"],[1,"title-box","font-weight-normal"],[1,"min","border"],[1,"d-flex","flex-wrap","align-items-end"],[1,"col-12","col-md-3","p-2"],[1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","disabled","virtualScroll","searchable","ngModel"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-sm-6","col-md-3","px-2","text-center"],[1,"btn-Add","btn",3,"click"],[1,"mx-1","pi","pi-save"],[1,"DivPaging","p-0","table-responsive"],[1,"table","table-striped","table-hover"],[1,"col-2"],[4,"ngFor","ngForOf"],[1,"form-text","text-muted"],[1,"text-dark"]],template:function(o,e){if(o&1){let t=x();d(0,"section",2)(1,"div",3)(2,"h4"),h(3),g(4,"translate"),_()(),d(5,"div",4)(6,"div",5)(7,"div",6)(8,"p",7),h(9),g(10,"translate"),_(),d(11,"ng-select",8,0),v("clear",function(){return i(t),a(e.Branches=[])})("focus",function(){i(t);let n=u(12);return a(e.ChangeSearchApi("Branch",n))})("keyup",function(){i(t);let n=u(12);return a(e.ChangeSearchApi("Branch",n))})("change",function(){i(t);let n=u(12);return a(e.ChangeSearchApi("Branch",n))})("scrollToEnd",function(){i(t);let n=u(12);return a(e.ChangeSearchApi("Branch",n))})("close",function(){return i(t),a(e._AppModeService.CurrentPage=0)})("open",function(){return i(t),a(e._AppModeService.CurrentPage=0)})("change",function(){return i(t),a(e.SelectValue(e.SearchModel.BranchId,"Branch"))}),y("ngModelChange",function(n){return i(t),b(e.SearchModel.BranchId,n)||(e.SearchModel.BranchId=n),a(n)}),B(13,re,2,2,"ng-template",9)(14,ie,1,1,"ng-template",10),_()(),d(15,"div",6)(16,"p",11),h(17),g(18,"translate"),_(),d(19,"ng-select",12,1),v("clear",function(){return i(t),a(e.Storages=[])})("focus",function(){i(t);let n=u(20);return e.ChangeSearchApi("Storages",n),a(e._AppModeService.ResetCurrentPage())})("keyup",function(){i(t);let n=u(20);return e.ChangeSearchApi("Storages",n),a(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){i(t);let n=u(20);return a(e.ChangeSearchApi("Storages",n))})("close",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("open",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("change",function(){return i(t),a(e.SelectValue(e.SearchModel.StoreId,"Store"))}),y("ngModelChange",function(n){return i(t),b(e.SearchModel.StoreId,n)||(e.SearchModel.StoreId=n),a(n)}),B(21,ae,2,2,"ng-template",9)(22,oe,1,1,"ng-template",10),_()(),d(23,"div",6)(24,"p",11),h(25),g(26,"translate"),_(),d(27,"ng-select",13,1),v("clear",function(){return i(t),a(e.Items=[])})("focus",function(){i(t);let n=u(20);return e.ChangeSearchApi("Items",n),a(e._AppModeService.ResetCurrentPage())})("keyup",function(){i(t);let n=u(20);return e.ChangeSearchApi("Items",n),a(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){i(t);let n=u(20);return a(e.ChangeSearchApi("Items",n))})("close",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("open",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("change",function(){return i(t),a(e.SelectValue(e.SearchModel.ProductId,"Product"))}),y("ngModelChange",function(n){return i(t),b(e.SearchModel.ProductId,n)||(e.SearchModel.ProductId=n),a(n)}),B(29,le,2,2,"ng-template",9)(30,ce,1,1,"ng-template",10),_()(),d(31,"div",14)(32,"button",15),v("click",function(){return i(t),a(e.Search())}),h(33),g(34,"translate"),k(35,"i",16),_()()(),d(36,"div",17)(37,"table",18)(38,"thead")(39,"tr")(40,"th",19),h(41),g(42,"translate"),_(),d(43,"th",19),h(44),g(45,"translate"),_()()(),d(46,"tbody"),B(47,se,7,2,"tr",20),_()()()()()}o&2&&(p(3),S(f(4,24,"BalanceItemBranch.BalanceItemBranch")),p(6),S(f(10,26,"BalanceItemBranch.Branch")),p(2),C("items",e.Branches)("autofocus",!1)("virtualScroll",!0)("searchable",!0),V("ngModel",e.SearchModel.BranchId),p(6),S(f(18,28,"BalanceItemBranch.Store")),p(2),C("items",e.Storages)("autofocus",!1)("disabled",e.SearchModel.BranchId==null)("virtualScroll",!0)("searchable",!0),V("ngModel",e.SearchModel.StoreId),p(6),S(f(26,30,"Table.Item")),p(2),C("items",e.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),V("ngModel",e.SearchModel.ProductId),p(6),I("",f(34,32,"Model.Search")," "),p(8),S(f(42,34,"Table.Name")),p(3),S(f(45,36,"Table.No")),p(3),C("ngForOf",e.ItemBalanceFrom))},dependencies:[$,Q,J,q,z,G,H,ee,Z,X,Y],styles:[".min[_ngcontent-%COMP%]{min-height:100vh}"]});let l=m;return l})();export{be as BalanceItemBranchComponent};
