import{g as ne,h as ae,o as le,x as pe}from"./chunk-RAAURFHQ.js";import{a as re,b as oe}from"./chunk-UVSBIWKY.js";import"./chunk-5EQTOVFJ.js";import{a as se}from"./chunk-OZ63RRZR.js";import{h as ie}from"./chunk-3T7HRBK4.js";import"./chunk-G323P4PR.js";import"./chunk-NZD6IPKE.js";import"./chunk-EKOK3I7J.js";import{a as K,b as X,c as Z,d as ee}from"./chunk-SU7IEUNK.js";import"./chunk-MYPGER6Q.js";import{k as te}from"./chunk-CETGYK4I.js";import{c as J}from"./chunk-F7IHWOEY.js";import{c as G,d as H}from"./chunk-GJAIQ3XH.js";import{c as V,d as Q,i as U,l as Y,v as q}from"./chunk-UA6GT64L.js";import{G as z,e as L,j as $}from"./chunk-GOUT62LL.js";import{$b as y,Cb as a,Db as n,Eb as E,Ib as M,Mb as C,Nb as f,Wb as x,X as D,Xb as o,Yb as I,Zb as d,_b as O,ac as w,bc as P,cc as k,db as t,dc as N,eb as b,ec as A,ia as j,na as R,nc as c,oc as m,pc as W,vb as v,xa as u,xb as g,ya as h}from"./chunk-RH76WUG2.js";import{a as B,b as F}from"./chunk-3EYC4JTX.js";var ce=()=>({"min-width":"50rem"}),de=()=>["Name","Storage","Code"];function me(e,s){if(e&1&&(a(0,"small",27),o(1),n()),e&2){let r=f();t(),O("Loaded ",r.Storages.length," of ",r._SharedObjectModelService.TotalItems,"")}}function _e(e,s){if(e&1&&o(0),e&2){let r=s.item;d(" ",r.Name," ")}}function Se(e,s){if(e&1&&(a(0,"small",27),o(1),n()),e&2){let r=f();t(),O("Loaded ",r.Items.length," of ",r._SharedObjectModelService.TotalItems,"")}}function ge(e,s){if(e&1&&o(0),e&2){let r=s.item;d(" ",r.NameAndCode," ")}}function ue(e,s){e&1&&(a(0,"tr")(1,"th",28),o(2),c(3,"translate"),n(),a(4,"th",28),o(5," \u0627\u0644\u062C\u0647\u0629 "),n(),a(6,"th",28),o(7),c(8,"translate"),n(),a(9,"th",28),o(10),c(11,"translate"),n(),a(12,"th",28),o(13),c(14,"translate"),n(),a(15,"th",28),o(16),c(17,"translate"),n(),a(18,"th",28),o(19),c(20,"translate"),n(),a(21,"th",28),o(22),c(23,"translate"),n(),a(24,"th",28),o(25),c(26,"translate"),n(),a(27,"th",28),o(28),c(29,"translate"),n(),a(30,"th",28),o(31),c(32,"translate"),n(),a(33,"th",28),o(34),c(35,"translate"),n(),a(36,"th",28),o(37,"-"),n()()),e&2&&(t(2),I(m(3,11,"Table.Name")),t(5),I(m(8,13,"Table.DocDate")),t(3),I(m(11,15,"Table.Quantity")),t(3),I(m(14,17,"Table.Total")),t(3),I(m(17,19,"Table.Storage")),t(3),I(m(20,21,"Table.Type")),t(3),I(m(23,23,"Table.DocNo")),t(3),I(m(26,25,"Table.DocType")),t(3),I(m(29,27,"Table.QuntityCumulative")),t(3),I(m(32,29,"Table.WA")),t(3),I(m(35,31,"Table.TotalCumulative")))}function he(e,s){e&1&&(a(0,"span",30),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.In")," "))}function Te(e,s){e&1&&(a(0,"span",30),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.Out")," "))}function Ie(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.Sale")," "))}function fe(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.SaleReturn")," "))}function ve(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.Buy")," "))}function Ce(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.BuyReturn")," "))}function xe(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.Transfer")," "))}function Me(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.StoreAdjustmet")," "))}function ye(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.CreateInitGlRecept")," "))}function we(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.TransferBanches")," "))}function Pe(e,s){e&1&&(a(0,"span",29),o(1),c(2,"translate"),n()),e&2&&(t(),d(" ",m(2,1,"DocType.ManufactureOrder")," "))}function De(e,s){if(e&1&&(a(0,"span",30),o(1),n()),e&2){let r=f().$implicit;t(),d(" ",r.OutInOutQty,"")}}function be(e,s){if(e&1&&(a(0,"span",39),o(1),n()),e&2){let r=f().$implicit;t(),d(" ",r.OutInOutQty,"")}}function Ee(e,s){if(e&1&&(a(0,"span",30),o(1),n()),e&2){let r=f().$implicit;t(),d(" ",r.OutInPrice,"")}}function Oe(e,s){if(e&1&&(a(0,"span",39),o(1),n()),e&2){let r=f().$implicit;t(),d(" ",r.OutInPrice,"")}}function Ae(e,s){if(e&1){let r=M();a(0,"tr")(1,"td")(2,"span",29),o(3),n()(),a(4,"td")(5,"span",29),o(6),n()(),a(7,"td")(8,"span",29),o(9),c(10,"date"),n()(),a(11,"td")(12,"span",30),o(13),n()(),a(14,"td")(15,"span",30),o(16),n()(),a(17,"td",31)(18,"span",29),o(19),n()(),a(20,"td"),v(21,he,3,3,"span",32)(22,Te,3,3,"span",32),n(),a(23,"td",33)(24,"span",30),o(25),n()(),a(26,"td"),v(27,Ie,3,3,"span",34)(28,fe,3,3,"span",35)(29,ve,3,3,"span",34)(30,Ce,3,3,"span",34)(31,xe,3,3,"span",34)(32,Me,3,3,"span",34)(33,ye,3,3,"span",35)(34,we,3,3,"span",34)(35,Pe,3,3,"span",34),n(),a(36,"td"),v(37,De,2,1,"span",32)(38,be,2,1,"span",36),n(),a(39,"td")(40,"span",30),o(41),n()(),a(42,"td"),v(43,Ee,2,1,"span",32)(44,Oe,2,1,"span",36),n(),a(45,"td")(46,"button",37),C("click",function(){let p=u(r).$implicit,i=f();return h(i._SharedObjectModelService.ShowDocument(p.DocType,p.DocNo))}),E(47,"i",38),n()()()}if(e&2){let r=s.$implicit,l=f();t(3),d(" ",r.ProductName,""),t(3),d(" ",r.Notes,""),t(3),d(" ",W(10,24,r.DocDate,"d-M-yyyy h:mm:ss a")," "),t(4),d(" ",r.Qty,""),t(3),d(" ",r.TotalAfterVat,""),t(3),d(" ",r.StoreName," "),t(2),g("ngIf",r.StockType==1),t(),g("ngIf",r.StockType==2),t(3),d(" ",r.DocNo," "),t(2),g("ngIf",r.DocType==1),t(),g("ngIf",r.DocType==2),t(),g("ngIf",r.DocType==3),t(),g("ngIf",r.DocType==4),t(),g("ngIf",r.DocType==5),t(),g("ngIf",r.DocType==11),t(),g("ngIf",r.DocType==12),t(),g("ngIf",r.DocType==15),t(),g("ngIf",r.DocType==19),t(2),g("ngIf",r.OutInOutQty>=0),t(),g("ngIf",r.OutInOutQty<0),t(3),I(r.WA),t(2),g("ngIf",r.OutInPrice>=0),t(),g("ngIf",r.OutInPrice<0),t(2),g("disabled",l._Apiservice.DisabledButton)}}function Ve(e,s){if(e&1){let r=M();a(0,"p-paginator",40),C("onPageChange",function(p){u(r);let i=f();return h(i.onPageChange(p))}),n()}if(e&2){let r=f();g("first",r._SharedObjectModelService.Paging.CurrentPage)("rows",r._SharedObjectModelService.Paging.PageSize)("totalRecords",r._SharedObjectModelService.Paging.TotalItems)("rowsPerPageOptions",r._Apiservice.RowCount)}}function Be(e,s){if(e&1){let r=M();a(0,"p-paginator",41),C("onPageChange",function(p){u(r);let i=f();return h(i.onPageChange(p))}),n()}if(e&2){let r=f();g("first",r._SharedObjectModelService.Paging.CurrentPage)("rows",r._SharedObjectModelService.Paging.PageSize)("totalRecords",r._SharedObjectModelService.Paging.PageSize)}}var rt=(()=>{let s=class s{constructor(l,p,i){this._SharedObjectModelService=l,this._AppModeService=p,this._Apiservice=i,this._ServiceLifeTime=j(V),this.SearchModel={FromDate:"",ToDate:"",StoreId:null,ProductId:null},this.Storages=[],this.Items=[]}ngOnInit(){this.SearchModel.FromDate=new Date(this._Apiservice.FromDate()),this.SearchModel.ToDate=new Date(this._Apiservice.ToNowDate())}ChangeSearchApi(l,p){let i=`${p.searchTerm}`.trim();(i==""||i=="null")&&(p.searchTerm="",i=""),this._AppModeService.CurrentPage+=1;let _={TableName:l,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:i,SearchField:"Name"};l=="Storages"&&(_.BranchFilter=!0),l=="Items"&&(_.Columns=["Id","Name","Code"],_.Conditions="ProductType != 2"),this._Apiservice.post("Global/GetAll",_,!1).pipe(D(this._ServiceLifeTime.Destroyed$)).subscribe({next:T=>{this.HandleResponse(T.Obj,l)}})}HandleResponse(l,p){this._SharedObjectModelService.TotalItems=l.TotalItems,p=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(l.DataReturn),"Id")),p=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(l.DataReturn),"Id"),this.Items=this.Items.map(i=>F(B({},i),{NameAndCode:`${i.Name} - ${i.Code}`})))}SelectValue(l,p){if(l!=null&&(l>0||l!="")){let i=[];p=="Store"&&(i=this.Storages),p=="Product"&&(i=this.Items);let _=i.find(T=>T.Id==l);if(_==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${p}Id`]=l,this.SearchModel[`${p}Name`]=_.Name,p=="Branch"&&(this.SearchModel.StoreId=null)}else this.SearchModel[`${p}Id`]=null,this.SearchModel[`${p}Name`]=""}onPageChange(l){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}l.page++,l.first,l.rows,this._SharedObjectModelService.Paging.CurrentPage=l.first,this._SharedObjectModelService.Paging.PageSize=l.rows;let p={CurrentPage:l.page,PageSize:this._SharedObjectModelService.Paging.PageSize,FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId};this._Apiservice.post("ItemEP/ProductTransaction",p,!0).pipe(D(this._ServiceLifeTime.Destroyed$)).subscribe({next:i=>{this._SharedObjectModelService.Paging.DataReturn=i.Obj.DataReturn,this._SharedObjectModelService.Paging.TotalItems=i.Obj.TotalItems}})}Search(){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}this._SharedObjectModelService.Paging.CurrentPage=1;let l={FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId,CurrentPage:1,PageSize:this._SharedObjectModelService.Paging.PageSize};if(this._Apiservice.ValidateDate(l.FromDate,l.ToDate)==!1){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("StatementOfFinancial.Error.SmallDate"));return}this._Apiservice.post("ItemEP/ProductTransaction",l,!0).pipe(D(this._ServiceLifeTime.Destroyed$)).subscribe({next:p=>{this._SharedObjectModelService.Paging.DataReturn=p.Obj.DataReturn,this._SharedObjectModelService.Paging.TotalItems=p.Obj.TotalItems}})}trackByMethod(l,p){return p.Id}ngOnDestroy(){}};s.\u0275fac=function(p){return new(p||s)(b(se),b(J),b(Q))},s.\u0275cmp=R({type:s,selectors:[["app-item-transaction"]],standalone:!0,features:[k([V]),N],decls:47,vars:48,consts:[["SelectFromStore",""],["dt1",""],["clas","bg-light"],[1,"title-box","font-weight-normal"],[1,"min","border"],[1,"d-flex","flex-wrap","align-items-end"],[1,"col-12","col-md-3","p-2"],[1,"my-1"],[1,"formdate"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","ngModel","showTime","showIcon","showOnFocus","showOtherMonths"],[1,"col-12","col-md-3","col-xl-2","p-2"],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],[1,"col-12","col-md-3","col-xl-3","p-2"],["for","Item"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-md-1","p-2","text-center"],[1,"btn-Add","btn",3,"click","disabled"],[1,"mx-1","pi","pi-save"],[1,"DivPaging","col-12","card","p-0","table-responsive","mt-4"],[3,"value","paginator","rows","tableStyle","globalFilterFields"],["pTemplate","header"],["pTemplate","body"],["appendTo","table",3,"first","rows","totalRecords","rowsPerPageOptions","onPageChange",4,"ngIf"],["appendTo","table",3,"first","rows","totalRecords","onPageChange",4,"ngIf"],[1,"form-text","text-muted"],[1,"col-1"],[1,"text-dark"],[1,"text-dark","text-nowrap"],[1,""],["class","text-dark text-nowrap",4,"ngIf"],[1,"text-nowrap"],["class","text-dark ",4,"ngIf"],["class","text-dark",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-Show",3,"click","disabled"],[1,"mx-1","pi","pi-search","fw-bold"],[1,"text-danger"],["appendTo","table",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],["appendTo","table",3,"onPageChange","first","rows","totalRecords"]],template:function(p,i){if(p&1){let _=M();a(0,"section",2)(1,"div",3)(2,"h4"),o(3),c(4,"translate"),n()(),a(5,"div",4)(6,"div",5)(7,"div",6)(8,"p",7),o(9),c(10,"translate"),n(),a(11,"div",8)(12,"p-calendar",9),P("ngModelChange",function(S){return u(_),w(i.SearchModel.FromDate,S)||(i.SearchModel.FromDate=S),h(S)}),n()()(),a(13,"div",6)(14,"p",7),o(15),c(16,"translate"),n(),a(17,"div",8)(18,"p-calendar",9),P("ngModelChange",function(S){return u(_),w(i.SearchModel.ToDate,S)||(i.SearchModel.ToDate=S),h(S)}),n()()(),a(19,"div",10)(20,"p",11),o(21),c(22,"translate"),n(),a(23,"ng-select",12,0),C("clear",function(){return u(_),h(i.Storages=[])})("focus",function(){u(_);let S=x(24);return i.ChangeSearchApi("Storages",S),h(i._AppModeService.ResetCurrentPage())})("keyup",function(){u(_);let S=x(24);return i.ChangeSearchApi("Storages",S),h(i._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){u(_);let S=x(24);return h(i.ChangeSearchApi("Storages",S))})("close",function(){return u(_),h(i._AppModeService.ResetCurrentPage())})("open",function(){return u(_),h(i._AppModeService.ResetCurrentPage())})("change",function(){return u(_),h(i.SelectValue(i.SearchModel.StoreId,"Store"))}),P("ngModelChange",function(S){return u(_),w(i.SearchModel.StoreId,S)||(i.SearchModel.StoreId=S),h(S)}),v(25,me,2,2,"ng-template",13)(26,_e,1,1,"ng-template",14),n()(),a(27,"div",15)(28,"label",16),o(29),c(30,"translate"),n(),a(31,"ng-select",17,0),C("clear",function(){return u(_),h(i.Items=[])})("focus",function(){u(_);let S=x(24);return i.ChangeSearchApi("Items",S),h(i._AppModeService.ResetCurrentPage())})("keyup",function(){u(_);let S=x(24);return i.ChangeSearchApi("Items",S),h(i._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){u(_);let S=x(24);return h(i.ChangeSearchApi("Items",S))})("close",function(){return u(_),h(i._AppModeService.ResetCurrentPage())})("open",function(){return u(_),h(i._AppModeService.ResetCurrentPage())})("change",function(){return u(_),h(i.SelectValue(i.SearchModel.ProductId,"Product"))}),P("ngModelChange",function(S){return u(_),w(i.SearchModel.ProductId,S)||(i.SearchModel.ProductId=S),h(S)}),v(33,Se,2,2,"ng-template",13)(34,ge,1,1,"ng-template",14),n()(),a(35,"div",18)(36,"button",19),C("click",function(){return u(_),h(i.Search())}),o(37),c(38,"translate"),E(39,"i",20),n()()(),a(40,"div",21)(41,"p-table",22,1),v(43,ue,38,33,"ng-template",23)(44,Ae,48,27,"ng-template",24),n(),v(45,Ve,1,4,"p-paginator",25)(46,Be,1,3,"p-paginator",26),n()()()}p&2&&(t(3),I(m(4,34,"ItemTransaction.ItemTransaction")),t(6),d(" ",m(10,36,"SupplierAccount.FromDate"),""),t(3),y("ngModel",i.SearchModel.FromDate),g("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),t(3),d(" ",m(16,38,"SupplierAccount.ToDate"),""),t(3),y("ngModel",i.SearchModel.ToDate),g("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),t(3),I(m(22,40,"BalanceItemBranch.Store")),t(2),g("items",i.Storages)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",i.SearchModel.StoreId),t(6),d(" ",m(30,42,"BalanceStorage.ItemId"),""),t(2),g("items",i.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",i.SearchModel.ProductId),t(5),g("disabled",i._Apiservice.DisabledButton),t(),d("",m(38,44,"Model.Send")," "),t(4),g("value",i._SharedObjectModelService.Paging.DataReturn)("paginator",!1)("rows",i._SharedObjectModelService.Paging.PageSize)("tableStyle",A(46,ce))("globalFilterFields",A(47,de)),t(4),g("ngIf",i._SharedObjectModelService.Paging.TotalItems>=10),t(),g("ngIf",i._SharedObjectModelService.Paging.TotalItems<10))},dependencies:[ae,ne,te,U,Y,oe,re,ie,pe,le,z,L,q,$,H,G,ee,Z,K,X],styles:[".min[_ngcontent-%COMP%]{min-height:100vh}"]});let e=s;return e})();export{rt as ItemTransactionComponent};
