import{a as xe,b as Te}from"./chunk-6T4APQIW.js";import{a as De}from"./chunk-SB45HR2Z.js";import{a as Ce}from"./chunk-PBWISRCH.js";import{a as he,c as ge,j as fe}from"./chunk-D4UU44IK.js";import{a as Se}from"./chunk-VSYXDL23.js";import{a as de,b as Ie}from"./chunk-FF7KVUSC.js";import{a as ye}from"./chunk-H6HTMPGV.js";import{a as le,b as se,c as pe,d as _e}from"./chunk-X4LTGZKH.js";import{c as ue,d as me,g as ve}from"./chunk-OFZNSK7N.js";import{H as K,I as X,L as Z,N as ee,Q as te,S as ie,U as ne,V as oe,W as re,Y as ae,_ as ce,c as q,d as z,i as Y,z as J}from"./chunk-CXJLKQ4R.js";import{$b as C,Cb as a,Db as c,Eb as R,Fb as k,Gb as O,Ib as x,Mb as f,Nb as l,Qb as T,Rb as U,Tb as Q,Ub as F,Vb as W,Wb as D,X as N,Xb as s,Yb as I,Zb as y,_b as w,ac as A,bc as b,db as o,dc as G,eb as B,na as j,nc as p,oc as m,pc as H,qc as $,vb as g,wa as L,xa as _,xb as d,ya as u}from"./chunk-J5UB44FZ.js";var Ne=["GLComponent"],Re=["content"];function we(r,v){if(r&1){let i=x();a(0,"div",57)(1,"label",58),s(2),p(3,"translate"),c(),a(4,"div",59)(5,"input",60),f("keyup",function(){_(i);let e=l(2);return u(e.ResetPage())})("change",function(){_(i);let e=l(2);return u(e.ResetPage())}),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.InvoiceDocNo,e)||(n.InvoiceDocNo=e),u(e)}),c()(),a(6,"button",61),f("click",function(){_(i);let e=l(2);return u(e.Search())}),s(7),p(8,"translate"),c()()}if(r&2){let i=l(2);o(2),y(" ",m(3,4,"ReturnBuyInvoice.InvoiceNo")," "),o(3),C("ngModel",i.InvoiceDocNo),o(),d("disabled",i._AppModeService.DisabledButton),o(),y(" ",m(8,6,"Model.Search")," ")}}function Ve(r,v){if(r&1&&(a(0,"span",62),s(1),p(2,"date"),c()),r&2){let i=l(2);o(),y(" ",H(2,1,i.Invoice.DocDate,"d-M-yyyy h:mm:ss a")," ")}}function Be(r,v){if(r&1){let i=x();a(0,"p-calendar",63),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.DocDate,e)||(n.Invoice.DocDate=e),u(e)}),c()}if(r&2){let i=l(2);d("showOtherMonths",!0)("showTime",!0)("showIcon",!0)("showOnFocus",!1),C("ngModel",i.Invoice.DocDate)}}function Ee(r,v){if(r&1&&s(0),r&2){let i=v.item;y(" ",i.Name," ")}}function Me(r,v){if(r&1){let i=x();a(0,"div",10)(1,"p",19),s(2),p(3,"translate"),c(),a(4,"ng-select",20),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.ClientId,e)||(n.Invoice.ClientId=e),u(e)}),g(5,Ee,1,1,"ng-template",21),c()()}if(r&2){let i=l(2);o(2),I(m(3,5,"SaleOffer.Client")),o(2),d("items",i.ClientArr)("disabled",!0)("virtualScroll",!0),C("ngModel",i.Invoice.ClientId)}}function Pe(r,v){if(r&1&&s(0),r&2){let i=v.item;y(" ",i.Name," ")}}function ke(r,v){if(r&1){let i=x();a(0,"div",10)(1,"p",19),s(2),p(3,"translate"),c(),a(4,"ng-select",20),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.SupplierId,e)||(n.Invoice.SupplierId=e),u(e)}),g(5,Pe,1,1,"ng-template",21),c()()}if(r&2){let i=l(2);o(2),I(m(3,5,"BuyOffer.Supplier")),o(2),d("items",i.SupplierArr)("disabled",!0)("virtualScroll",!0),C("ngModel",i.Invoice.SupplierId)}}function Oe(r,v){if(r&1&&s(0),r&2){let i=v.item;y(" ",i.Name," ")}}function Ue(r,v){r&1&&(a(0,"option",26),s(1),p(2,"translate"),c()),r&2&&(d("value",3),o(),I(m(2,2,"SaleInvoice.Delivery")))}function Qe(r,v){if(r&1&&(a(0,"small",70),s(1),c()),r&2){let i=l(3);o(),w("Loaded ",i.TreasuryArr.length," of ",i._SharedObjectModelService.TotalItems,"")}}function Fe(r,v){if(r&1&&s(0),r&2){let i=v.item;y(" ",i.Name," ")}}function We(r,v){if(r&1){let i=x();a(0,"div",64)(1,"div",65)(2,"p",24),s(3),p(4,"translate"),c(),a(5,"input",66),p(6,"translate"),f("keyup",function(){_(i);let e=l(2);return u(e.ChangeCash())})("change",function(){_(i);let e=l(2);return u(e.ChangeCash())}),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.Cash,e)||(n.Invoice.Cash=e),u(e)}),c()(),a(7,"div",67)(8,"p",24),s(9),p(10,"translate"),c(),a(11,"ng-select",68,2),f("clear",function(){_(i);let e=l(2);return u(e.TreasuryArr=[])})("focus",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("Treasury",e))})("keyup",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("Treasury",e))})("change",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("Treasury",e))})("scrollToEnd",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("Treasury",e))})("close",function(){_(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("open",function(){_(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("change",function(){_(i);let e=l(2);return u(e.SelectValue(e.Invoice.TreasuryId,"Treasury"))}),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.TreasuryId,e)||(n.Invoice.TreasuryId=e),u(e)}),g(13,Qe,2,2,"ng-template",69)(14,Fe,1,1,"ng-template",21),c()()()}if(r&2){let i=l(2);o(3),I(m(4,11,"BuyInvoice.Cash")),o(2),T("placeholder",m(6,13,"SaleInvoice.Cash")),d("disabled",i.Invoice.PaymentType==3),C("ngModel",i.Invoice.Cash),o(4),I(m(10,15,"BuyInvoice.Treasury")),o(2),d("items",i.TreasuryArr)("autofocus",!1)("virtualScroll",!0)("searchable",!0)("disabled",i.Invoice.PaymentType==3||i.Invoice.Cash==""||i.Invoice.Cash==0),C("ngModel",i.Invoice.TreasuryId)}}function je(r,v){if(r&1&&(a(0,"small",70),s(1),c()),r&2){let i=l(3);o(),w("Loaded ",i.BankAccountArr.length," of ",i._SharedObjectModelService.TotalItems,"")}}function Le(r,v){if(r&1&&s(0),r&2){let i=v.item;y(" ",i.Name," ")}}function Ge(r,v){if(r&1){let i=x();a(0,"div",64)(1,"div",67)(2,"p",24),s(3),p(4,"translate"),c(),a(5,"input",71),p(6,"translate"),f("keyup",function(){_(i);let e=l(2);return u(e.ChangeCash())})("change",function(){_(i);let e=l(2);return u(e.ChangeCash())}),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.Visa,e)||(n.Invoice.Visa=e),u(e)}),c()(),a(7,"div",67)(8,"p",24),s(9),p(10,"translate"),c(),a(11,"ng-select",72,3),f("clear",function(){_(i);let e=l(2);return u(e.BankAccountArr=[])})("focus",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("BankAccounts",e))})("keyup",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("BankAccounts",e))})("change",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("BankAccounts",e))})("scrollToEnd",function(){_(i);let e=D(12),n=l(2);return u(n.ChangeSearchApi("BankAccounts",e))})("close",function(){_(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("open",function(){_(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("change",function(){_(i);let e=l(2);return u(e.SelectValue(e.Invoice.BankAccountId,"BankAccount"))}),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.BankAccountId,e)||(n.Invoice.BankAccountId=e),u(e)}),g(13,je,2,2,"ng-template",69)(14,Le,1,1,"ng-template",21),c()()()}if(r&2){let i=l(2);o(3),I(m(4,10,"BuyInvoice.Visa")),o(2),T("placeholder",m(6,12,"SaleInvoice.Visa")),d("disabled",i.Invoice.PaymentType==3),C("ngModel",i.Invoice.Visa),o(4),I(m(10,14,"BuyInvoice.Bank")),o(2),d("items",i.BankAccountArr)("virtualScroll",!0)("searchable",!0)("disabled",i.Invoice.PaymentType==3||i.Invoice.Visa==""||i.Invoice.Visa==0),C("ngModel",i.Invoice.BankAccountId)}}function He(r,v){if(r&1&&(a(0,"small",70),s(1),c()),r&2){let i=l(3);o(),w("Loaded ",i.EmployeeArr.length," of ",i._SharedObjectModelService.TotalItems,"")}}function $e(r,v){if(r&1&&s(0),r&2){let i=v.item;y(" ",i.Name," ")}}function qe(r,v){if(r&1){let i=x();a(0,"div",73)(1,"p",19),s(2),p(3,"translate"),c(),a(4,"ng-select",74,4),f("clear",function(){_(i);let e=l(2);return u(e.EmployeeArr=[])})("focus",function(){_(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("keyup",function(){_(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("change",function(){_(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("scrollToEnd",function(){_(i);let e=D(5),n=l(2);return u(n.ChangeSearchApi("Employee",e))})("close",function(){_(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("open",function(){_(i);let e=l(2);return u(e._AppModeService.CurrentPage=0)})("change",function(){_(i);let e=l(2);return u(e.SelectValue(e.Invoice.EmployeeId,"Employee"))}),b("ngModelChange",function(e){_(i);let n=l(2);return A(n.Invoice.EmployeeId,e)||(n.Invoice.EmployeeId=e),u(e)}),g(6,He,2,2,"ng-template",69)(7,$e,1,1,"ng-template",21),c()()}if(r&2){let i=l(2);o(2),I(m(3,6,"BuyReport.Employee")),o(2),d("items",i.EmployeeArr)("autofocus",!1)("virtualScroll",!0)("searchable",!0),C("ngModel",i.Invoice.EmployeeId)}}function ze(r,v){r&1&&(a(0,"p",24),s(1),p(2,"translate"),c()),r&2&&(o(),y("",m(2,1,"BuyInvoice.Debt")," : "))}function Ye(r,v){if(r&1&&R(0,"input",75),r&2){let i=l(2);T("value",i.Invoice.Debt.toFixed(2)),d("disabled",!0)}}function Je(r,v){r&1&&(a(0,"span",76),s(1),p(2,"translate"),c()),r&2&&(o(),y("",m(2,1,"SaleInvoice.Cash")," "))}function Ke(r,v){r&1&&(a(0,"span",76),s(1),p(2,"translate"),c()),r&2&&(o(),y("",m(2,1,"SaleInvoice.Debt")," "))}function Xe(r,v){if(r&1&&(a(0,"span",77),s(1),p(2,"translate"),c()),r&2){let i=l(2);o(),w("",m(2,2,"SaleInvoice.Cash")," : ",i.InvoiceCash,"")}}function Ze(r,v){if(r&1&&(a(0,"span",77),s(1),p(2,"translate"),c()),r&2){let i=l(2);o(),w("",m(2,2,"SaleInvoice.Visa")," : ",i.InvoiceVisa,"")}}function et(r,v){if(r&1&&(a(0,"span",77),s(1),p(2,"translate"),c()),r&2){let i=l(2);o(),w("",m(2,2,"SaleInvoice.Debt")," : ",i.InvoiceDept,"")}}function tt(r,v){if(r&1&&(a(0,"p",85),s(1),c()),r&2){let i=l(2).$implicit;o(),y(" ",i.ProductName," ")}}function it(r,v){if(r&1&&(k(0),g(1,tt,2,1,"p",84),O()),r&2){let i=v.$implicit,t=l().$implicit;o(),d("ngIf",t.ProductId==i.Id)}}function nt(r,v){if(r&1&&(a(0,"p",85),s(1),c()),r&2){let i=l(2).$implicit;o(),y(" ",i.ProductUnitName," ")}}function ot(r,v){if(r&1&&(k(0),g(1,nt,2,1,"p",84),O()),r&2){let i=v.$implicit,t=l().$implicit;o(),d("ngIf",t.ProductUnitId==i.Id)}}function rt(r,v){if(r&1){let i=x();a(0,"tr"),R(1,"td",78),a(2,"td",79),p(3,"translate"),g(4,it,2,1,"ng-container",80),c(),a(5,"td",79),p(6,"translate"),g(7,ot,2,1,"ng-container",80),c(),a(8,"td",81),p(9,"translate"),a(10,"span",82),s(11),c()(),a(12,"td",81),p(13,"translate"),a(14,"input",83),f("change",function(){let e=_(i).index,n=l(2);return u(n.LowQuantity(e))})("keyup",function(){let e=_(i).index,n=l(2);return u(n.LowQuantity(e))}),b("ngModelChange",function(e){let n=_(i).$implicit;return A(n.Quantity,e)||(n.Quantity=e),u(e)}),c()(),a(15,"td",81),p(16,"translate"),a(17,"span",82),s(18),c()(),a(19,"td",81),p(20,"translate"),a(21,"span",82),s(22),c()(),a(23,"td",81),p(24,"translate"),a(25,"span",82),s(26),c()(),a(27,"td",81),p(28,"translate"),a(29,"span",82),s(30),c()(),a(31,"td",81),p(32,"translate"),a(33,"span"),s(34),c()()()}if(r&2){let i=v.$implicit,t=v.index,e=l(2);o(),T("title",t+1),o(),T("title",m(3,23,"SaleInvoice.Name")),o(2),d("ngForOf",i.Items),o(),T("title",m(6,25,"SaleInvoice.Unit")),o(2),d("ngForOf",i.ProductUnits),o(),T("title",m(9,27,"ReturnBuyInvoice.LastReturnQuantity")),o(3),y(" ",i.ReturnedQty,""),o(),T("title",m(13,29,"ReturnBuyInvoice.ReturnQuantity")),o(2),U("id","ReturnQuantity",t,""),U("name","ReturnQuantity",t,""),C("ngModel",i.Quantity),o(),T("title",m(16,31,"ReturnBuyInvoice.Quantity")),o(3),y(" ",i.SaveQuantity,""),o(),T("title",m(20,33,"SaleInvoice.Price")),o(3),y(" ",i.Price,""),o(),T("title",m(24,35,"SaleInvoice.DiscountRate")),o(3),y(" ",i.DiscountRate.toFixed(2),""),o(),T("title",m(28,37,"SaleInvoice.Discount")),o(3),y(" ",e.ConvertToNumer(i.Discount).toFixed(2),""),o(),T("title",m(32,39,"SaleInvoice.NetTotal")),o(3),I(i.TotalPriceAfterDiscount.toFixed(2))}}function at(r,v){if(r&1){let i=x();a(0,"button",86),f("click",function(){_(i);let e=l(2);return u(e.Save())}),s(1),p(2,"translate"),a(3,"span",87),s(4,"Ctrl + Space"),c(),R(5,"i",88),c()}if(r&2){let i=l(2);d("disabled",i._AppModeService.DisabledButton),o(),y(" ",m(2,2,"Model.Save")," ")}}function ct(r,v){if(r&1){let i=x();a(0,"button",90),f("click",function(){_(i);let e=l(3);return u(e.Save())}),s(1),p(2,"translate"),c()}if(r&2){let i=l(3);d("disabled",i._AppModeService.DisabledButton),o(),y(" ",m(2,2,"Model.Update")," ")}}function lt(r,v){if(r&1&&(a(0,"span"),g(1,ct,3,4,"button",89),c()),r&2){let i=l(2);o(),d("ngIf",i.Invoice.Id!=0)}}function st(r,v){if(r&1){let i=x();a(0,"button",91),f("click",function(){_(i);let e=l(2);return u(e.OpenGl())}),s(1),p(2,"translate"),c()}r&2&&(o(),y(" ",m(2,1,"Model.Gl")," "))}function pt(r,v){if(r&1){let i=x();R(0,"app-modal-header",6),a(1,"div",7)(2,"div",8),g(3,we,9,8,"div",9),a(4,"div",10)(5,"label",11),s(6),p(7,"translate"),c(),R(8,"input",12),c(),a(9,"div",10)(10,"label",13),s(11),p(12,"translate"),c(),a(13,"input",14),b("ngModelChange",function(e){_(i);let n=l();return A(n.Invoice.Notes,e)||(n.Invoice.Notes=e),u(e)}),c()(),a(14,"div",15),g(15,Ve,3,4,"span",16)(16,Be,1,5,"p-calendar",17),c(),g(17,Me,6,7,"div",18)(18,ke,6,7,"div",18),a(19,"div",10)(20,"p",19),s(21),p(22,"translate"),c(),a(23,"ng-select",20),b("ngModelChange",function(e){_(i);let n=l();return A(n.Invoice.StoreId,e)||(n.Invoice.StoreId=e),u(e)}),g(24,Oe,1,1,"ng-template",21),c()(),a(25,"div",22)(26,"div",23)(27,"p",24),s(28),p(29,"translate"),c(),a(30,"select",25),f("change",function(){_(i);let e=l();return u(e.ChangePamentType(e.Invoice.PaymentType))}),b("ngModelChange",function(e){_(i);let n=l();return A(n.Invoice.PaymentType,e)||(n.Invoice.PaymentType=e),u(e)}),a(31,"option",26),s(32),p(33,"translate"),c(),a(34,"option",26),s(35),p(36,"translate"),c(),g(37,Ue,3,4,"option",27),c()(),g(38,We,15,17,"div",28)(39,Ge,15,16,"div",28)(40,qe,8,8,"div",29),a(41,"div",30),g(42,ze,3,3,"p",31)(43,Ye,1,2,"input",32),c()(),a(44,"div",33)(45,"p",34),s(46),p(47,"translate"),c(),g(48,Je,3,3,"span",35)(49,Ke,3,3,"span",35),c(),a(50,"div",36),g(51,Xe,3,4,"span",37)(52,Ze,3,4,"span",37)(53,et,3,4,"span",37),c()(),a(54,"div",38)(55,"table",39)(56,"thead")(57,"tr")(58,"th"),s(59,"#"),c(),a(60,"th",40),s(61),p(62,"translate"),c(),a(63,"th",41),s(64),p(65,"translate"),c(),a(66,"th",41),s(67),p(68,"translate"),c(),a(69,"th",41),s(70),p(71,"translate"),c(),a(72,"th",41),s(73),p(74,"translate"),c(),a(75,"th",41),s(76),p(77,"translate"),c(),a(78,"th",41),s(79),p(80,"translate"),c(),a(81,"th",41),s(82),p(83,"translate"),c(),a(84,"th",41),s(85),p(86,"translate"),c()()(),a(87,"tbody"),g(88,rt,35,41,"tr",42),c()()()(),a(89,"div",43)(90,"div",44)(91,"span",45),s(92),p(93,"translate"),c(),a(94,"span",46),s(95),c()(),a(96,"div",47)(97,"span",45),s(98),p(99,"translate"),c(),a(100,"span",46),s(101),c()(),a(102,"div",47)(103,"span",48),s(104),p(105,"translate"),c(),a(106,"span",46),s(107),c()(),a(108,"div",47)(109,"span",49),s(110),p(111,"translate"),c(),a(112,"span",46),s(113),c()(),a(114,"div",47)(115,"span",50)(116,"span"),s(117),p(118,"translate"),c(),a(119,"span"),s(120),c()(),a(121,"span",46),s(122),c()(),a(123,"div",47)(124,"span",51),s(125),p(126,"translate"),c(),a(127,"span",46),s(128),c()()(),a(129,"div",52),g(130,at,6,4,"button",53)(131,lt,2,1,"span",54)(132,st,3,3,"button",55),a(133,"button",56),f("click",function(){let e=_(i).$implicit,n=l();return e.close("Close click"),u(n.ResetPage())}),s(134),p(135,"translate"),c()()}if(r&2){let i=l();d("PageTitle",i.PageTitle),o(3),d("ngIf",i.Invoice.Id==0),o(3),I(m(7,62,"Table.DocNo")),o(2),d("value",i.Invoice.DocNo)("disabled",!0),o(3),I(m(12,64,"Table.Notes")),o(2),C("ngModel",i.Invoice.Notes),o(2),d("ngIf",i._DefaultSettingsService.DefaultSettings.DateTimeReadOnly==!1),o(),d("ngIf",i._DefaultSettingsService.DefaultSettings.DateTimeReadOnly==!0),o(),d("ngIf",i.ScreenName=="ReturnSaleInvoice"),o(),d("ngIf",i.ScreenName=="ReturnBuyInvoice"),o(3),I(m(22,66,"BuyInvoice.Storage")),o(2),d("items",i.StoreArr)("disabled",!0)("virtualScroll",!0),C("ngModel",i.Invoice.StoreId),o(5),I(m(29,68,"BuyInvoice.PamentType")),o(2),C("ngModel",i.Invoice.PaymentType),o(),d("value",1),o(),I(m(33,70,"SaleInvoice.Cash")),o(2),d("value",2),o(),I(m(36,72,"SaleInvoice.Debt")),o(2),d("ngIf",i.ScreenName=="ReturnSaleInvoice"),o(),d("ngIf",i.Invoice.PaymentType!=3),o(),d("ngIf",i.Invoice.PaymentType!=3),o(),d("ngIf",i.Invoice.PaymentType==3),o(2),d("ngIf",i.Invoice.PaymentType==2),o(),d("ngIf",i.Invoice.PaymentType==2),o(3),y(" ",m(47,74,"ReturnSaleInvoice.Status")," : "),o(2),d("ngIf",i.InvoiceType==1),o(),d("ngIf",i.InvoiceType==2),o(2),d("ngIf",i.InvoiceCash>=0),o(),d("ngIf",i.InvoiceVisa>=0),o(),d("ngIf",i.InvoiceDept>=0),o(8),I(m(62,76,"SaleInvoice.Name")),o(3),I(m(65,78,"SaleInvoice.Unit")),o(3),I(m(68,80,"ReturnBuyInvoice.LastReturnQuantity")),o(3),I(m(71,82,"ReturnBuyInvoice.ReturnQuantity")),o(3),I(m(74,84,"ReturnBuyInvoice.Quantity")),o(3),I(m(77,86,"SaleInvoice.Price")),o(3),y("",m(80,88,"SaleInvoice.DiscountRate")," %"),o(3),I(m(83,90,"SaleInvoice.Discount")),o(3),I(m(86,92,"SaleInvoice.NetTotal")),o(3),d("ngForOf",i.Invoice.InvoiceDetails)("ngForTrackBy",i.trackByMethod),o(4),I(m(93,94,"ProductCount")),o(3),I(i.Invoice.InvoiceDetails.length),o(3),I(m(99,96,"SaleInvoice.TotalInvoice")),o(3),I(i.Invoice.TotalInvoice.toFixed(2)),o(3),I(m(105,98,"SaleInvoice.TotalDiscount")),o(3),I(i.Invoice.TotalDisc.toFixed(2)),o(3),y("",m(111,100,"SaleInvoice.DiscountRate"),"%"),o(3),I(i.Invoice.TotalDiscRate.toFixed(2)),o(4),y("",m(118,102,"SaleInvoice.TotalVat")," "),o(3),y(" ",i.Invoice.TotalVatRate.toFixed(2),"% "),o(2),I(i.Invoice.TotalInvoiceVatAmount.toFixed(2)),o(3),I(m(126,104,"SaleInvoice.TotalAfterVat")),o(3),I(i.Invoice.TotalInvoiceAfterVat.toFixed(2)),o(2),d("ngIf",i.Invoice.Id==0),o(),d("ngIf",i._Apiservice.environment.SystemUpdate),o(),d("ngIf",i.Invoice.Id>0&&(i.ScreenName=="SaleInvoice"||"BuyInvoice")),o(2),I(m(135,106,"Model.Close"))}}var Mt=(()=>{let v=class v{constructor(t,e,n,h,S){this._ActivatedRoute=t,this._SharedObjectModelService=e,this._DefaultSettingsService=n,this._AppModeService=h,this._Apiservice=S,this.SignalR=!1,this.GlResponse=!1,this.TablePaging={},this.PageTitle="",this.ScreenName="",this.InvoiceName="",this.PrintUrl="",this.AddUrl="",this.UpdateUrl="",this.DeleteUrl="",this.GetById="",this.Invoice={InvoiceCollected:!1,ClientType:2,DocNo:0,DocDate:"",InvoiceDetails:[],TotalInvoice:0,TotalDiscRate:0,TotalDisc:0,TotalInvoiceAfterDisc:0,TotalInvoiceAfterVat:0,TotalInvoiceVatAmount:0,TotalVatRate:0,Cash:"",Visa:"",Debt:"",TreasuryId:null,TreasuryName:"",BankAccountId:null,BankAccountName:"",EmployeeId:null,EmployeeName:"",StoreId:null,StoreName:"",ClientId:null,ClientName:"",SupplierId:null,SupplierName:"",Id:0,PaymentType:1,Name:"",Notes:"",Code:""},this.SupplierArr=[],this.ClientArr=[],this.StoreArr=[],this.TreasuryArr=[],this.BankAccountArr=[],this.EmployeeArr=[],this.ItemBalanceList=[],this.InvoiceDocNo="",this.InvoiceType=0,this.InvoiceCash=0,this.InvoiceVisa=0,this.InvoiceDept=0}ngOnChanges(t){let e=Number(this._ActivatedRoute.snapshot.queryParams.Id);e>0&&this.GetByIdRoute(e)}ngOnInit(){this.SignalR&&(this.StartConnection(),this.Hub_Connection?.state=="Connecting"&&this.ServerListener())}GetByIdRoute(t){this._Apiservice.getById(this.GetById,t,!0).pipe(N(this._Apiservice.destroy$)).subscribe({next:e=>{e.IsSuccess==!0&&e.Obj!=null?(this._SharedObjectModelService.PageModel=e.Obj.model,this._SharedObjectModelService.Gl=e.Obj.Gl,this.Drow(this._SharedObjectModelService.PageModel),this._AppModeService._NgbModal.open(this.ContentModel,{fullscreen:!0,backdrop:"static"})):this._AppModeService._Toastr.error(e.Message)}})}GetPageInfo(){this._AppModeService.DisabledButton=!0,this._Apiservice.get(`${this.ScreenName}EP/GetPageInfo`,!1).pipe(N(this._Apiservice.destroy$)).subscribe({next:t=>{t.IsSuccess==!0&&t.Obj!=null?(this.Invoice.DocNo=t.Obj,this._AppModeService.DisabledButton=!1):this._AppModeService._Toastr.error(t.Message)},error:t=>{this._AppModeService.DisabledButton=!1}})}StartConnection(){this.Hub_Connection=new Te().withUrl(`${K.signalrUrl}/${this.ScreenName}`,{skipNegotiation:!0,transport:xe.WebSockets}).build(),this.Hub_Connection.start().then(()=>{}).catch(t=>{console.log("Error Hub Connection",t)})}ServerListener(){this.Hub_Connection?.on(`Add${this.ScreenName}`,t=>{let e=this._Apiservice.UserIdFromCookies();Number(e.BranchId)==t.BranchId&&e.Id!=t.UserId&&this.GetPageInfo()}),this.Hub_Connection?.on(`Update${this.ScreenName}`,t=>{let e=this._Apiservice.UserIdFromCookies();Number(e.BranchId)==t.BranchId&&t.UserId!=e.Id&&t.Id==this.Invoice.Id&&(alert(this._AppModeService._Translate.instant("Show.UpdateModelAnother")),this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Show.UpdateModelAnother"),t.User),this._AppModeService._NgbModal.dismissAll())}),this.Hub_Connection?.on(`Delete${this.ScreenName}`,t=>{let e=this._Apiservice.UserIdFromCookies();Number(e.BranchId)==t.BranchId&&t.UserId!=e.Id&&t.Id==this.Invoice.Id&&(alert(this._AppModeService._Translate.instant("Show.DeleteModelAnother")),this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Show.DeleteModelAnother"),t.User),this._SharedObjectModelService.Paging.DataReturn=this._SharedObjectModelService.Paging.DataReturn.filter(n=>n.Id!=t.Id),this._AppModeService._NgbModal.dismissAll())})}OpenModal(){this.InvoiceDocNo="",this.ResetPage()}OpenGl(){this.GLComponent.Open()}ChangeSearchApi(t,e){let n=`${e.searchTerm}`.trim();(n==""||n=="null")&&(e.searchTerm="",n=""),this._AppModeService.CurrentPage+=1;let h={TableName:t,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:n,SearchField:"Name"};t=="Storages"&&(h.BranchFilter=!0),t=="Treasury"&&(h.BranchFilter=!0),this._Apiservice.post("Global/GetAll",h,!1).pipe(N(this._Apiservice.destroy$)).subscribe({next:S=>{S.IsSuccess==!0&&S.Obj!=null?this.HandleResponse(S.Obj,t):this._AppModeService._Toastr.error(S.Message)}})}HandleResponse(t,e){this._SharedObjectModelService.TotalItems=0,this._SharedObjectModelService.TotalItems=t.TotalItems,e=="Suppliers"&&(this.SupplierArr=this._SharedObjectModelService.RemoveDuplicates(this.SupplierArr.concat(t.DataReturn),"Id")),e=="Clients"&&(this.ClientArr=this._SharedObjectModelService.RemoveDuplicates(this.ClientArr.concat(t.DataReturn),"Id")),e=="Storages"&&(this.StoreArr=this._SharedObjectModelService.RemoveDuplicates(this.StoreArr.concat(t.DataReturn),"Id")),e=="Treasury"&&(this.TreasuryArr=this._SharedObjectModelService.RemoveDuplicates(this.TreasuryArr.concat(t.DataReturn),"Id")),e=="BankAccounts"&&(this.BankAccountArr=this._SharedObjectModelService.RemoveDuplicates(this.BankAccountArr.concat(t.DataReturn),"Id")),e=="Employee"&&(this.EmployeeArr=this._SharedObjectModelService.RemoveDuplicates(this.EmployeeArr.concat(t.DataReturn),"Id"))}SelectValue(t,e){if(t!=null&&(t>0||t!="")){let n=[];e=="Supplier"&&(n=this.SupplierArr),e=="Client"&&(n=this.ClientArr),e=="Store"&&(n=this.StoreArr),e=="Treasury"&&(n=this.TreasuryArr),e=="BankAccount"&&(n=this.BankAccountArr),e=="Employee"&&(n=this.EmployeeArr);let h=n.find(S=>S.Id==t);if(h==null){this._AppModeService.DontPlay();return}else this.Invoice[`${e}Id`]=t,this.Invoice[`${e}Name`]=h.Name}else this.Invoice[`${e}Id`]=null,this.Invoice[`${e}Name`]=""}ChangePamentType(t){this.Invoice.BankAccountId=null,this.Invoice.BankAccountName="",this.Invoice.TreasuryId=null,this.Invoice.TreasuryName="",this.Invoice.EmployeeId=null,this.Invoice.EmployeeName="",t==1&&(this.Invoice.PaymentType=1,this.Invoice.Visa="",this.Invoice.Debt="",this.Invoice.Cash=this.Invoice.TotalInvoiceAfterVat),t==2&&(this.Invoice.PaymentType=2,this.Invoice.Cash="",this.Invoice.Visa="",this.Invoice.Debt=this.Invoice.TotalInvoiceAfterVat),t==3&&(this.Invoice.Visa="",this.Invoice.Cash="",this.Invoice.Debt="",this.Invoice.TreasuryId=null,this.Invoice.TreasuryName="",this.Invoice.BankAccountId=null,this.Invoice.BankAccountName=""),this.ChangeCash()}ChangeCash(){this.Invoice.PaymentType==1&&(this.Invoice.Cash=Number(this.Invoice.TotalInvoiceAfterVat-Number(this.Invoice.Visa)),this.Invoice.Visa=Number(this.Invoice.TotalInvoiceAfterVat-Number(this.Invoice.Cash))),this.Invoice.PaymentType==2&&(this.Invoice.Debt=Number(this.Invoice.TotalInvoiceAfterVat-(Number(this.Invoice.Cash)+Number(this.Invoice.Visa)))),this.Invoice.TreasuryId=Number(this.Invoice.Cash)==0?null:this.Invoice.TreasuryId,this.Invoice.BankAccountId=Number(this.Invoice.Visa)==0?null:this.Invoice.BankAccountId,this.Invoice.TreasuryName=Number(this.Invoice.Cash)==0?"":this.Invoice.TreasuryName,this.Invoice.BankAccountName=Number(this.Invoice.Visa)==0?"":this.Invoice.BankAccountName,this.Invoice.Cash=Number(this.Invoice.Cash)==0?"":this.Invoice.Cash,this.Invoice.Visa=Number(this.Invoice.Visa)==0?"":this.Invoice.Visa,this.Invoice.Debt=Number(this.Invoice.Debt)==0?"":this.Invoice.Debt,this.DefaultBankTreasury()}HandleMyDefaultSettings(){let t=this._DefaultSettingsService.DefaultSettings;this.ScreenName=="ReturnSaleInvoice"&&(this.Invoice.PaymentType=t.SaleInvoicePaymentType>0?t.SaleInvoicePaymentType:1),this.ScreenName=="ReturnBuyInvoice"&&(this.Invoice.PaymentType=t.BuyInvoicePaymentType>0?t.BuyInvoicePaymentType:1)}DefaultBankTreasury(){let t=this._DefaultSettingsService.DefaultSettings;this.ScreenName=="ReturnSaleInvoice"&&(this.Invoice.Cash>0&&t.ReturnSaleInvoiceTreasuryId>0&&this.Invoice.Id==0&&(this.TreasuryArr=[],this.Invoice.TreasuryId=t.ReturnSaleInvoiceTreasuryId,this.TreasuryArr.push({Id:t.ReturnSaleInvoiceTreasuryId,Name:t.ReturnSaleInvoiceTreasuryName})),this.Invoice.Visa>0&&t.ReturnSaleInvoiceBankAccountId>0&&this.Invoice.Id==0&&(this.BankAccountArr=[],this.Invoice.BankAccountId=t.ReturnSaleInvoiceBankAccountId,this.BankAccountArr.push({Id:t.ReturnSaleInvoiceBankAccountId,Name:t.ReturnSaleInvoiceBankAccountName}))),this.ScreenName=="ReturnBuyInvoice"&&(this.Invoice.Cash>0&&t.ReturnBuyInvoiceTreasuryId>0&&this.Invoice.Id==0&&(this.TreasuryArr=[],this.Invoice.TreasuryId=t.ReturnBuyInvoiceTreasuryId,this.TreasuryArr.push({Id:t.ReturnBuyInvoiceTreasuryId,Name:t.ReturnBuyInvoiceTreasuryName})),this.Invoice.Visa>0&&t.ReturnBuyInvoiceBankAccountId>0&&this.Invoice.Id==0&&(this.BankAccountArr=[],this.Invoice.BankAccountId=t.ReturnBuyInvoiceBankAccountId,this.BankAccountArr.push({Id:t.ReturnBuyInvoiceBankAccountId,Name:t.ReturnBuyInvoiceBankAccountName})))}ConvertToNumer(t){return Number(t)}LowQuantity(t){let e=Number(this.Invoice.InvoiceDetails[t].Quantity),n=Number(this.Invoice.InvoiceDetails[t].Price),h=Number(this.Invoice.InvoiceDetails[t].Vat),S=Number(this.Invoice.InvoiceDetails[t].SaveQuantity),V=Number(this.Invoice.InvoiceDetails[t].SaveDiscount),Ae=Number(this.Invoice.InvoiceDetails[t].SaveTotalPrice),E=Number(this.Invoice.InvoiceDetails[t].SaveDiscountRate),be=Number(this.Invoice.InvoiceDetails[t].RealQuantity);if(e==0||e<0||e>S){this.Invoice.InvoiceDetails[t].SaveQuantity=S,this.Invoice.InvoiceDetails[t].Discount=this.Invoice.InvoiceDetails[t].SaveDiscount,this.Invoice.InvoiceDetails[t].DiscountRate=this.Invoice.InvoiceDetails[t].SaveDiscountRate,this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=0,this.Invoice.InvoiceDetails[t].TotalPriceAfterVat=0,e<0&&(this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorQuantity")),this.Invoice.InvoiceDetails[t].Quantity=""),e>S&&(this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ReturnedQtyUpQuantity")),this.Invoice.InvoiceDetails[t].Quantity=""),this.Confirm();return}if(e>0){let M=Number(e)/be;if(V>0){let P=V*M;this.Invoice.InvoiceDetails[t].Discount=P,this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=e*n-V*M}if(E>0){let P=Ae*E/100;this.Invoice.InvoiceDetails[t].DiscountRate=E*M,this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=e*n-P*M}E==0&&V==0&&(this.Invoice.InvoiceDetails[t].TotalPriceAfterDiscount=e*n,this.Invoice.InvoiceDetails[t].TotalPriceAfterVat=e*n*h/100),this.Confirm()}}TotalInvoiceVatAmount(){let t=0;for(let e=0;e<this.Invoice.InvoiceDetails.length;e++){let n=Number(this.Invoice.InvoiceDetails[e].Quantity),h=Number(this.Invoice.InvoiceDetails[e].TotalPriceAfterDiscount);if(n>0){let S=Number(this.Invoice.InvoiceDetails[e].Vat);t+=h*(S/100)}}return Number(t)}Confirm(){this.Invoice.TotalDiscRate=0,this.Invoice.TotalInvoiceAfterDisc=0,this.Invoice.TotalInvoiceAfterVat=0,this.Invoice.TotalVatRate=0,this.Invoice.TotalDisc=0,this.Invoice.TotalInvoice=0,this.Invoice.TotalInvoiceVatAmount=0;let t=this.Invoice.InvoiceDetails.filter(e=>Number(e.Quantity)>0);for(let e=0;e<t.length;e++){let n=Number(t[e].SaveQuantity),h=Number(t[e].Quantity),S=Number(t[e].Price),V=Number(t[e].TotalPriceAfterDiscount);if(h>n)return this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ReturnedQtyUpQuantity")),!1;this.Invoice.TotalInvoice+=S*h,this.Invoice.TotalDisc+=S*h-V}return this.Invoice.TotalDiscRate=this.Invoice.TotalInvoice==0?0:Number(this.Invoice.TotalDisc/this.Invoice.TotalInvoice*100),this.Invoice.TotalInvoiceAfterDisc=Number(this.Invoice.TotalInvoice-this.Invoice.TotalDisc),this.Invoice.TotalInvoiceVatAmount=this.TotalInvoiceVatAmount(),this.Invoice.TotalInvoiceAfterVat=Number(this.Invoice.TotalInvoiceAfterDisc+this.Invoice.TotalInvoiceVatAmount),this.Invoice.TotalVatRate=this.Invoice.TotalInvoiceAfterDisc==0?0:Number(this.Invoice.TotalInvoiceVatAmount/this.Invoice.TotalInvoiceAfterDisc*100),this.ChangeCash(),!0}ShowToEdite(){this.InvoiceDocNo="",this.Drow(this._SharedObjectModelService.PageModel)}Drow(t){this.Invoice={ClientType:t.ClientType,DocNo:t.DocNo,DocDate:new Date(t.DocDate),Id:t.Id,PaymentType:t.PaymentType,Name:t.Name,Notes:t.Notes,Code:t.Code,TotalInvoice:t.TotalInvoice,TotalDiscRate:t.TotalDiscRate,TotalDisc:t.TotalDisc,TotalInvoiceAfterDisc:t.TotalInvoiceAfterDisc,TotalInvoiceAfterVat:t.TotalInvoiceAfterVat,TotalInvoiceVatAmount:t.TotalInvoiceVatAmount,TotalVatRate:t.TotalVatRate,Cash:t.Cash,Visa:t.Visa,Debt:t.Debt,TreasuryId:t.TreasuryId,TreasuryName:t.TreasuryName,BankAccountId:t.BankAccountId,BankAccountName:t.BankAccountName,EmployeeId:t.EmployeeId,EmployeeName:t.EmployeeName,StoreId:t.StoreId,StoreName:t.StoreName,ClientId:t.ClientId,ClientName:t.ClientName,SupplierId:t.SupplierId,SupplierName:t.SupplierName,InvoiceDetails:t[`${this.ScreenName}Details`]},t.SupplierId>0&&(this.SupplierArr=[{Id:t.SupplierId,Name:t.SupplierName}]),t.ClientId>0&&(this.ClientArr=[{Id:t.ClientId,Name:t.ClientName}]),t.TreasuryId>0&&(this.TreasuryArr=[{Id:t.TreasuryId,Name:t.TreasuryName}]),t.BankAccountId>0&&(this.BankAccountArr=[{Id:t.BankAccountId,Name:t.BankAccountName}]),t.EmployeeId>0&&(this.EmployeeArr=[{Id:t.EmployeeId,Name:t.EmployeeName}]),t.StoreId>0&&(this.StoreArr=[{Id:t.StoreId,Name:t.StoreName}]);for(let e=0;e<this.Invoice.InvoiceDetails.length;e++){let n=this.Invoice.InvoiceDetails[e];this.Invoice.InvoiceDetails[e].Items=[{Id:n.ProductId,Name:n.ProductName,NameAndCode:n.ProductName}],this.Invoice.InvoiceDetails[e].ProductUnits=[{Id:n.ProductUnitId,Name:n.ProductUnitName,NameAndUnitFactor:n.ProductUnitName}]}this._AppModeService.DisabledButton=!1}Search(){if(Number(this.InvoiceDocNo)==0||this.InvoiceDocNo==null||isNaN(Number(this.InvoiceDocNo))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.EnterInvoiceNumber"));return}this._AppModeService.DisabledButton=!0,this._Apiservice.getById(`${this.InvoiceName}EP/GetByDocNo`,Number(this.InvoiceDocNo),!0).pipe(N(this._Apiservice.destroy$)).subscribe({next:t=>{if(t.IsSuccess==!0&&t.Obj!=null){this._AppModeService.DisabledButton=!1;let e=t.Obj;this.ResetPage(),this.GetPageInfo(),this.InvoiceCash=e.Cash,this.InvoiceVisa=e.Visa,this.InvoiceDept=e.Debt,this.InvoiceType=e.PaymentType,this.Invoice[`${this.InvoiceName}DocNo`]=e.DocNo,this.Invoice[`${this.InvoiceName}Id`]=e.Id,this.InvoiceName=="BuyInvoice"&&(this.Invoice.SupplierId=e.SupplierId,this.Invoice.SupplierName=e.SupplierName,this.SupplierArr=[{Id:e.SupplierId,Name:e.SupplierName}]),this.InvoiceName=="SaleInvoice"&&(this.Invoice.ClientId=e.ClientId,this.Invoice.ClientName=e.ClientName,this.ClientArr=[{Id:e.ClientId,Name:e.ClientName}]),this.Invoice.StoreId=e.StoreId,this.Invoice.StoreName=e.StoreName,this.StoreArr=[{Id:e.StoreId,Name:e.StoreName}],this.Invoice.PaymentType=1,this.Invoice.InvoiceDetails=e[`${this.InvoiceName}Details`];for(let n=0;n<this.Invoice.InvoiceDetails.length;n++)this.Invoice.InvoiceDetails[n].Id=0,this.Invoice.InvoiceDetails[n].SaveDiscount=Number(this.Invoice.InvoiceDetails[n].Discount),this.Invoice.InvoiceDetails[n].SaveDiscountRate=Number(this.Invoice.InvoiceDetails[n].DiscountRate),this.Invoice.InvoiceDetails[n].SavePrice=Number(this.Invoice.InvoiceDetails[n].Price),this.Invoice.InvoiceDetails[n].SaveTotalPrice=Number(this.Invoice.InvoiceDetails[n].TotalPrice),this.Invoice.InvoiceDetails[n].SaveTotalPriceAfterDiscount=Number(this.Invoice.InvoiceDetails[n].TotalPriceAfterDiscount),this.Invoice.InvoiceDetails[n].RealQuantity=Number(this.Invoice.InvoiceDetails[n].Quantity),this.Invoice.InvoiceDetails[n].SaveQuantity=Number(this.Invoice.InvoiceDetails[n].Quantity)-Number(this.Invoice.InvoiceDetails[n].ReturnedQty),this.Invoice.InvoiceDetails[n].Quantity="",this.Invoice.InvoiceDetails[n].TotalPrice=this.Invoice.InvoiceDetails[n].SaveQuantity*Number(this.Invoice.InvoiceDetails[n].SavePrice),this.Invoice.InvoiceDetails[n].TotalPriceAfterDiscount=0,this.Invoice.InvoiceDetails[n].Items=[{Id:this.Invoice.InvoiceDetails[n].ProductId,Name:this.Invoice.InvoiceDetails[n].ProductName}],this.Invoice.InvoiceDetails[n].ProductUnits=[{Id:this.Invoice.InvoiceDetails[n].ProductUnitId,Name:this.Invoice.InvoiceDetails[n].ProductUnitName,NameAndUnitFactor:this.Invoice.InvoiceDetails[n].ProductUnitName}]}else this._AppModeService.DisabledButton=!1,this.ResetPage(),this._AppModeService._Toastr.error(t.Message)},error:t=>{this._AppModeService.DisabledButton=!1}})}Save(){if(this.Invoice.DocDate==""||this.Invoice.DocDate==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BuyInvoice.Error.EnterDate"));return}if(this.Confirm()==!1)return;if(this.Invoice.TotalInvoice<0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(this.Invoice.TotalInvoiceAfterVat<0||this.Invoice.TotalInvoiceAfterVat<0&&this.Invoice.TotalInvoiceAfterDisc<0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BuyInvoice.Error.ErrorTotal"));return}if(Number(this.Invoice.Visa)<0||isNaN(Number(this.Invoice.Visa))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(Number(this.Invoice.Cash)<0||isNaN(Number(this.Invoice.Cash))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(Number(this.Invoice.Debt)<0||isNaN(Number(this.Invoice.Debt))){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorDebt"));return}if(Number(this.Invoice.Visa)>0&&(this.Invoice.BankAccountId<=0||this.Invoice.BankAccountId==null)){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.EnterBank"));return}if(Number(this.Invoice.Cash)>0&&(this.Invoice.TreasuryId<=0||this.Invoice.TreasuryId==null)){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.EnterTreasury"));return}if(this.Invoice.PaymentType==1&&Number(this.Invoice.Cash)+Number(this.Invoice.Visa)!=this.Invoice.TotalInvoiceAfterVat){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorCash"));return}if(this.Invoice.PaymentType==2&&Number(this.Invoice.Cash)+Number(this.Invoice.Visa)+Number(this.Invoice.Debt)!=this.Invoice.TotalInvoiceAfterVat){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorDebt"));return}if(this.Invoice.PaymentType==2&&Number(this.Invoice.Debt)<=0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ReturnBuyInvoice.Error.ErrorDebt"));return}if(this.Invoice.PaymentType==3&&this.Invoice.EmployeeId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("SalesReport.ChooseEmployee"));return}let t={InvoiceDetails:this.Invoice.InvoiceDetails.filter(e=>Number(e.Quantity)>0),Id:this.Invoice.Id,Name:this.Invoice.Name,Notes:this.Invoice.Notes,Code:this.Invoice.Code,TotalInvoice:this.Invoice.TotalInvoice,TotalDisc:this.Invoice.TotalDisc,TotalDiscRate:this.Invoice.TotalDiscRate,TotalInvoiceAfterDisc:this.Invoice.TotalInvoiceAfterDisc,TotalInvoiceAfterVat:this.Invoice.TotalInvoiceAfterVat,TotalInvoiceVatAmount:this.Invoice.TotalInvoiceVatAmount,TotalVatRate:this.Invoice.TotalVatRate,Cash:Number(this.Invoice.Cash),Visa:Number(this.Invoice.Visa),Debt:Number(this.Invoice.Debt),PaymentType:Number(this.Invoice.PaymentType),DocDate:this._Apiservice.ConvertISODate(this.Invoice.DocDate),DocNo:this.Invoice.DocNo,SupplierId:this.Invoice.SupplierId,SupplierName:this.Invoice.SupplierName,StoreId:this.Invoice.StoreId,StoreName:this.Invoice.StoreName,TreasuryId:this.Invoice.TreasuryId,TreasuryName:this.Invoice.TreasuryName,BankAccountId:this.Invoice.BankAccountId,BankAccountName:this.Invoice.BankAccountName,EmployeeId:this.Invoice.EmployeeId,EmployeeName:this.Invoice.EmployeeName,ClientId:this.Invoice.ClientId,ClientName:this.Invoice.ClientName};t[`Return${this.InvoiceName}Details`]=this.Invoice.InvoiceDetails.filter(e=>Number(e.Quantity)>0),t[`${this.InvoiceName}DocNo`]=this.Invoice[`${this.InvoiceName}DocNo`],t[`${this.InvoiceName}Id`]=this.Invoice[`${this.InvoiceName}Id`],console.log(t),t.Id==0&&this._Apiservice.post(`${this.AddUrl}`,t,!0).pipe(N(this._Apiservice.destroy$)).subscribe({next:e=>{e.IsSuccess==!0&&e.Obj!=null?(this._AppModeService._Toastr.success(this._AppModeService._Translate.instant("Success.AddSuccess")),this.InvoiceDocNo="",this.ResetPage(),this._SharedObjectModelService.Paging.DataReturn.push(e.Obj)):this._AppModeService._Toastr.error(e.Message)}}),t.Id>0&&this._Apiservice.put(this.UpdateUrl,t,!0).pipe(N(this._Apiservice.destroy$)).subscribe({next:e=>{if(e.IsSuccess==!0&&e.Obj!=null){this._AppModeService._Toastr.success(e.Message);let n=e.Obj,h=this._SharedObjectModelService.Paging.DataReturn.find(S=>S.Id==n.Id);h!=null&&Object.assign(h,n),this.ResetPage(),this.GetPageInfo()}else this._AppModeService._Toastr.error(e.Message)}})}ConfirmDelete(t,e=void 0){e!=null&&e!=null&&(e.Id>0||e.Id!="")&&(this.Invoice.Id=e.Id),this._AppModeService._NgbModal.open(t,{size:"xxl",centered:!0})}ResetPage(){this._AppModeService.DisabledButton=!1,this.Invoice={InvoiceCollected:!1,ClientType:2,DocNo:0,DocDate:"",InvoiceDetails:[],TotalInvoice:0,TotalDiscRate:0,TotalDisc:0,TotalInvoiceAfterDisc:0,TotalInvoiceAfterVat:0,TotalInvoiceVatAmount:0,TotalVatRate:0,Cash:"",Visa:"",Debt:"",TreasuryId:null,TreasuryName:"",BankAccountId:null,BankAccountName:"",EmployeeId:null,EmployeeName:"",StoreId:null,StoreName:"",ClientId:null,ClientName:"",SupplierId:null,SupplierName:"",Id:0,PaymentType:1,Name:"",Notes:"",Code:"",InvoiceCollection:0},this.InvoiceCash=0,this.InvoiceVisa=0,this.InvoiceDept=0,this._DefaultSettingsService.ResetDate(this.Invoice),this.HandleMyDefaultSettings()}trackByMethod(t,e){return e.Id}ngOnDestroy(){this._Apiservice.destroy$.next(),this._Apiservice.destroy$.complete()}};v.\u0275fac=function(e){return new(e||v)(B(J),B(ye),B(Ce),B(ve),B(X))},v.\u0275cmp=j({type:v,selectors:[["app-dynamic-return-invoice"]],viewQuery:function(e,n){if(e&1&&(Q(Ne,5),Q(Re,5)),e&2){let h;F(h=W())&&(n.GLComponent=h.first),F(h=W())&&(n.ContentModel=h.first)}},inputs:{SignalR:"SignalR",GlResponse:"GlResponse",TablePaging:"TablePaging",PageTitle:"PageTitle",ScreenName:"ScreenName",InvoiceName:"InvoiceName",PrintUrl:"PrintUrl",AddUrl:"AddUrl",UpdateUrl:"UpdateUrl",DeleteUrl:"DeleteUrl",GetById:"GetById"},standalone:!0,features:[L,G],decls:5,vars:8,consts:[["content",""],["GLComponent",""],["SelectTreasury",""],["SelectBank",""],["SelectEmployee",""],[3,"OpenModalEvent","ShowToEditeEvent","PageTitle","TablePaging","FullScreen","GlResponse","GetById","PrintUrl","DeleteUrl","OutModal"],[3,"PageTitle"],[1,"modal-body","bg-white","p-0","m-0"],[1,"d-flex","flex-wrap","align-items-center","col-12"],["class","col-12 col-sm-6 col-md-4 col-lg-2 p-1 d-flex flex-wrap ",4,"ngIf"],[1,"col-12","col-sm-6","col-md-4","col-lg-2","p-1"],["for","DocNo"],["type","number","appNumericInput","",1,"form-control","text-center",3,"value","disabled"],["for","Notes"],["type","text",1,"form-control","text-center",3,"ngModelChange","ngModel"],[1,"col-12","col-sm-6","col-md-4","col-lg-2","p-1","align-self-end"],["class","d-block text-center ",4,"ngIf"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12","class"," shadow-none text-center w-100",3,"showOtherMonths","showTime","showIcon","showOnFocus","ngModel","ngModelChange",4,"ngIf"],["class","col-12 col-sm-6 col-md-4 col-lg-2 p-1",4,"ngIf"],[1,"m-0"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"ngModelChange","items","disabled","virtualScroll","ngModel"],["ng-option-tmp",""],[1,"col-12","my-2","p-2","d-flex","flex-wrap"],[1,"col-12","col-md-4","col-lg-2","p-1","my-1","my-lg-0"],[1,"my-1"],["name","","id","",1,"form-select",3,"change","ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngIf"],["class","col-12 col-md-8 col-lg-4 px-0 d-flex flex-wrap align-items-center",4,"ngIf"],["class","col-12 col-md-6 my-2 p-2",4,"ngIf"],[1,"col-12","col-md-4","col-lg-2","p-3","my-1","my-lg-0"],["class","my-1",4,"ngIf"],["id","Debt","min","0","type","number","appNumericInput","","class","form-control shadow-none text-center",3,"disabled","value",4,"ngIf"],[1,"col-12","col-sm-3","col-md-2","text-center","p-1","d-flex","flex-wrap","border","border-1","border-info","py-2"],[1,"col-6","m-0"],["class","col-6",4,"ngIf"],[1,"col-12","col-sm-9","text-center","Info","d-flex","flex-wrap"],["class","d-block col-12 col-sm-4 border border-1 border-info text-center py-2",4,"ngIf"],["id","Table",1,"table-responsive-vertical","shadow-z-1","mt-2","mb-0","pb-0"],[1,"table","table-hover","table-striped","table-light","m-0","p-0"],[1,"col-3"],[1,"col-2"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"TotalContainer","d-flex","flex-wrap","justify-content-around"],[1,"mx-auto","px-0","text-center"],["for","TotalInvoice",1,"text-white","m-0","p-0","text-center"],[1,"d-block","m-0","p-0","text-center"],[1,"mx-auto","p-0","text-center"],["for","TotalDiscount",1,"text-white","m-0","p-0","text-center"],["for","TotalDiscRate",1,"text-white","m-0","p-0","text-center"],["for","TotalVat",1,"text-white","m-0","p-0","text-center"],["for","TotalAfterVat",1,"text-white","m-0","p-0","text-center"],[1,"modal-footer","bg-white","py-2","px-4","m-0"],["class","btn btn-success py-3 px-5",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["class","btn btn-info mx-3 py-3 px-5",3,"click",4,"ngIf"],["type","button",1,"btn","btn-secondary","py-3","px-5",3,"click"],[1,"col-12","col-sm-6","col-md-4","col-lg-2","p-1","d-flex","flex-wrap"],["for","InvoiceNo",1,"col-12"],[1,"col-9","px-1"],["min","0","id","InvoiceNo","type","number","appNumericInput","","autofocus","",1,"form-control","shadow-none","text-center",3,"keyup","change","ngModelChange","ngModel"],[1,"btn","btn-primary","text-center","d-block","col-3","px-3",3,"click","disabled"],[1,"d-block","text-center"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","showOtherMonths","showTime","showIcon","showOnFocus","ngModel"],[1,"col-12","col-md-8","col-lg-4","px-0","d-flex","flex-wrap","align-items-center"],[1,"col-12","col-md-6","p-md-1","my-1","my-lg-0"],["min","0","type","number","appNumericInput","","id","Cash",1,"form-control","py-2","shadow-none","text-center",3,"keyup","change","ngModelChange","placeholder","disabled","ngModel"],[1,"col-12","col-md-6","p-1","my-1","my-lg-0"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","autofocus","virtualScroll","searchable","disabled","ngModel"],["ng-header-tmp",""],[1,"form-text","text-muted"],["min","0","type","number","appNumericInput","","id","Visa",1,"form-control","py-2","shadow-none","text-center",3,"keyup","change","ngModelChange","placeholder","disabled","ngModel"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","virtualScroll","searchable","disabled","ngModel"],[1,"col-12","col-md-6","my-2","p-2"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["id","Debt","min","0","type","number","appNumericInput","",1,"form-control","shadow-none","text-center",3,"disabled","value"],[1,"col-6"],[1,"d-block","col-12","col-sm-4","border","border-1","border-info","text-center","py-2"],[1,"",3,"title"],[1,"text-center",3,"title"],[4,"ngFor","ngForOf"],[3,"title"],[1,"text-dark"],["min","0","type","number","appNumericInput","",1,"form-control","text-center",3,"change","keyup","ngModelChange","id","name","ngModel"],["class","text-dark text-center d-block",4,"ngIf"],[1,"text-dark","text-center","d-block"],[1,"btn","btn-success","py-3","px-5",3,"click","disabled"],[1,"fs-5","mx-1"],[1,"mx-1","pi","pi-save"],["class","btn btn-primary py-3 px-5",3,"disabled","click",4,"ngIf"],[1,"btn","btn-primary","py-3","px-5",3,"click","disabled"],[1,"btn","btn-info","mx-3","py-3","px-5",3,"click"]],template:function(e,n){if(e&1){let h=x();a(0,"app-dynamic-component",5),f("OpenModalEvent",function(){return _(h),u(n.OpenModal())})("ShowToEditeEvent",function(){return _(h),u(n.ShowToEdite())}),c(),g(1,pt,136,108,"ng-template",null,0,$),R(3,"app-glsheard",null,1)}if(e&2){let h=D(2);d("PageTitle",n.PageTitle)("TablePaging",n.TablePaging)("FullScreen",!0)("GlResponse",!0)("GetById",n.GetById)("PrintUrl",n.PrintUrl)("DeleteUrl",n.DeleteUrl)("OutModal",h)}},dependencies:[Y,Ie,de,_e,pe,le,se,ce,oe,re,Z,ie,ne,ee,ae,te,q,z,he,me,ue,fe,De,ge,Se]});let r=v;return r})();export{Mt as a};
