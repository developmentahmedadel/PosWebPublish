import{a as X}from"./chunk-4BXLEV7L.js";import{a as U,b as H,c as G,d as q}from"./chunk-PXT6JROT.js";import{c as z,d as J,g as K}from"./chunk-IFVWP3QJ.js";import{F as N,I as L,N as W,Q as $,_ as Q,c as D}from"./chunk-OQMSVWK6.js";import{$b as V,Cb as d,Db as _,Ib as F,Mb as C,Nb as w,Tb as R,Ub as O,Vb as k,Wb as u,X as A,Xb as h,Yb as S,Zb as M,_b as T,ac as b,bc as y,db as m,dc as j,eb as v,na as x,nc as g,oc as I,vb as f,xa as i,xb as B,ya as a}from"./chunk-J5UB44FZ.js";import{a as P,b as E}from"./chunk-3EYC4JTX.js";var Y=["SelectItems"];function Z(c,p){if(c&1&&(d(0,"small",23),h(1),_()),c&2){let s=w();m(),T("Loaded ",s.Branches.length," of ",s._SharedObjectModelService.TotalItems,"")}}function ee(c,p){if(c&1&&h(0),c&2){let s=p.item;M(" ",s.Name," ")}}function te(c,p){if(c&1&&(d(0,"small",23),h(1),_()),c&2){let s=w();m(),T("Loaded ",s.Storages.length," of ",s._SharedObjectModelService.TotalItems,"")}}function ne(c,p){if(c&1&&h(0),c&2){let s=p.item;M(" ",s.Name,`
`)}}function re(c,p){if(c&1&&(d(0,"small",23),h(1),_()),c&2){let s=w();m(),T("Loaded ",s.Items.length," of ",s._SharedObjectModelService.TotalItems,"")}}function ie(c,p){if(c&1&&h(0),c&2){let s=p.item;M(" ",s.NameAndCode,`
`)}}function ae(c,p){if(c&1&&(d(0,"tr")(1,"td")(2,"span",24),h(3),_()(),d(4,"td")(5,"span",24),h(6),_()()()),c&2){let s=p.$implicit;m(3),M(" ",s.UnitName+" - "+s.UnitFactor," "),m(3),S(s.Qty)}}var fe=(()=>{let p=class p{constructor(o,l,e){this._SharedObjectModelService=o,this._AppModeService=l,this._Apiservice=e,this.SearchModel={BranchId:null,StoreId:null,ProductId:null},this.ItemBalanceFrom=[],this.Branches=[],this.Storages=[],this.Items=[]}ngOnInit(){}ChangeSearchApi(o,l){let e=`${l.searchTerm}`.trim();(e==""||e=="null")&&(l.searchTerm="",e=""),this._AppModeService.CurrentPage+=1;let t={TableName:o,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:e,SearchField:"Name"};o=="Storages"&&(t.Conditions=`BranchId = ${this.SearchModel.BranchId}`),o=="Items"&&(t.Columns=["Id","Name","Code"],t.Conditions="ProductType != 2"),this._Apiservice.post("Global/GetAll",t,!1).pipe(A(this._Apiservice.destroy$)).subscribe({next:n=>{n.IsSuccess==!0&&n.Obj!=null?this.HandleResponse(n.Obj,o):this._AppModeService._Toastr.error(n.Message)}})}HandleResponse(o,l){this._SharedObjectModelService.TotalItems=o.TotalItems,l=="Branch"&&(this.Branches=this._SharedObjectModelService.RemoveDuplicates(this.Branches.concat(o.DataReturn),"Id")),l=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(o.DataReturn),"Id")),l=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(o.DataReturn),"Id"),this.Items=this.Items.map(e=>E(P({},e),{NameAndCode:`${e.Name} - ${e.Code}`})))}SelectValue(o,l){if(o!=null&&(o>0||o!="")){let e=[];l=="Branch"&&(e=this.Branches),l=="Store"&&(e=this.Storages),l=="Product"&&(e=this.Items);let t=e.find(n=>n.Id==o);if(t==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${l}Id`]=o,this.SearchModel[`${l}Name`]=t.Name}else this.SearchModel[`${l}Id`]=null,this.SearchModel[`${l}Name`]="";l=="Branch"&&(this.SearchModel.StoreId=null,this.Storages=[])}Search(){if(this.SearchModel.BranchId==0||this.SearchModel.BranchId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.BranchId"));return}if(this.SearchModel.StoreId==0||this.SearchModel.StoreId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.StoreId"));return}if(this.SearchModel.ProductId==0||this.SearchModel.ProductId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.SelectItem"));return}this._Apiservice.post("ItemEP/ProductBalance",this.SearchModel,!0).pipe(A(this._Apiservice.destroy$)).subscribe({next:o=>{o.IsSuccess==!0&&o.Obj!=null?this.ItemBalanceFrom=o.Obj.StorageBalance:this._AppModeService._Toastr.error(o.Message)}})}ngOnDestroy(){this._Apiservice.destroy$.next(),this._Apiservice.destroy$.complete()}};p.\u0275fac=function(l){return new(l||p)(v(X),v(K),v(L))},p.\u0275cmp=x({type:p,selectors:[["app-balance-item-branch"]],viewQuery:function(l,e){if(l&1&&R(Y,5),l&2){let t;O(t=k())&&(e.ngSelectComponent=t.first)}},standalone:!0,features:[j],decls:49,vars:38,consts:[["Select1",""],["SelectFromStore",""],["clas","bg-light"],["id","container-page",1,"container-page","p-0"],[1,"page-wrapper"],[1,"main-content"],[1,"inner-box","p"],[1,"title-box","font-weight-normal"],[1,"PageTitle","fs-1","fw-bold","px-2"],[1,"d-flex","flex-wrap","align-items-end","mb-3"],[1,"col-12","col-sm-6","col-md-3","px-2"],[1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","disabled","virtualScroll","searchable","ngModel"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-sm-6","col-md-3","px-2","text-center"],[1,"btn","btn-primary","py-3","my-3","my-md-0","mx-3","px-5","shadow-none",3,"click"],[1,"table","table-striped","table-hover"],[1,"col-2"],[4,"ngFor","ngForOf"],[1,"form-text","text-muted"],[1,"text-dark"]],template:function(l,e){if(l&1){let t=F();d(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"i",8),h(7),g(8,"translate"),_()(),d(9,"div",9)(10,"div",10)(11,"p",11),h(12),g(13,"translate"),_(),d(14,"ng-select",12,0),C("clear",function(){return i(t),a(e.Branches=[])})("focus",function(){i(t);let r=u(15);return a(e.ChangeSearchApi("Branch",r))})("keyup",function(){i(t);let r=u(15);return a(e.ChangeSearchApi("Branch",r))})("change",function(){i(t);let r=u(15);return a(e.ChangeSearchApi("Branch",r))})("scrollToEnd",function(){i(t);let r=u(15);return a(e.ChangeSearchApi("Branch",r))})("close",function(){return i(t),a(e._AppModeService.CurrentPage=0)})("open",function(){return i(t),a(e._AppModeService.CurrentPage=0)})("change",function(){return i(t),a(e.SelectValue(e.SearchModel.BranchId,"Branch"))}),y("ngModelChange",function(r){return i(t),b(e.SearchModel.BranchId,r)||(e.SearchModel.BranchId=r),a(r)}),f(16,Z,2,2,"ng-template",13)(17,ee,1,1,"ng-template",14),_()(),d(18,"div",10)(19,"p",15),h(20),g(21,"translate"),_(),d(22,"ng-select",16,1),C("clear",function(){return i(t),a(e.Storages=[])})("focus",function(){i(t);let r=u(23);return e.ChangeSearchApi("Storages",r),a(e._AppModeService.ResetCurrentPage())})("keyup",function(){i(t);let r=u(23);return e.ChangeSearchApi("Storages",r),a(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){i(t);let r=u(23);return a(e.ChangeSearchApi("Storages",r))})("close",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("open",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("change",function(){return i(t),a(e.SelectValue(e.SearchModel.StoreId,"Store"))}),y("ngModelChange",function(r){return i(t),b(e.SearchModel.StoreId,r)||(e.SearchModel.StoreId=r),a(r)}),f(24,te,2,2,"ng-template",13)(25,ne,1,1,"ng-template",14),_()(),d(26,"div",10)(27,"p",15),h(28),g(29,"translate"),_(),d(30,"ng-select",17,1),C("clear",function(){return i(t),a(e.Items=[])})("focus",function(){i(t);let r=u(23);return e.ChangeSearchApi("Items",r),a(e._AppModeService.ResetCurrentPage())})("keyup",function(){i(t);let r=u(23);return e.ChangeSearchApi("Items",r),a(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){i(t);let r=u(23);return a(e.ChangeSearchApi("Items",r))})("close",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("open",function(){return i(t),a(e._AppModeService.ResetCurrentPage())})("change",function(){return i(t),a(e.SelectValue(e.SearchModel.ProductId,"Product"))}),y("ngModelChange",function(r){return i(t),b(e.SearchModel.ProductId,r)||(e.SearchModel.ProductId=r),a(r)}),f(32,re,2,2,"ng-template",13)(33,ie,1,1,"ng-template",14),_()(),d(34,"div",18)(35,"button",19),C("click",function(){return i(t),a(e.Search())}),h(36),g(37,"translate"),_()()(),d(38,"table",20)(39,"thead")(40,"tr")(41,"th",21),h(42),g(43,"translate"),_(),d(44,"th",21),h(45),g(46,"translate"),_()()(),d(47,"tbody"),f(48,ae,7,2,"tr",22),_()()()()()()()}l&2&&(m(7),S(I(8,24,"BalanceItemBranch.BalanceItemBranch")),m(5),S(I(13,26,"BalanceItemBranch.Branch")),m(2),B("items",e.Branches)("autofocus",!1)("virtualScroll",!0)("searchable",!0),V("ngModel",e.SearchModel.BranchId),m(6),S(I(21,28,"BalanceItemBranch.Store")),m(2),B("items",e.Storages)("autofocus",!1)("disabled",e.SearchModel.BranchId==null)("virtualScroll",!0)("searchable",!0),V("ngModel",e.SearchModel.StoreId),m(6),S(I(29,30,"Table.Item")),m(2),B("items",e.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),V("ngModel",e.SearchModel.ProductId),m(6),S(I(37,32,"Model.Search")),m(6),S(I(43,34,"Table.Name")),m(3),S(I(46,36,"Table.No")),m(3),B("ngForOf",e.ItemBalanceFrom))},dependencies:[N,D,Q,W,$,J,z,q,G,U,H],styles:[".inner-box[_ngcontent-%COMP%]{min-height:90vh}"]});let c=p;return c})();export{fe as BalanceItemBranchComponent};
