import{a as xe}from"./chunk-6FCX7RNP.js";import{b as se,c as me,h as ge}from"./chunk-RMPXGUPG.js";import"./chunk-6G7QKXJW.js";import"./chunk-PE2JD36L.js";import{a as de}from"./chunk-NNHHLG53.js";import"./chunk-RAAURFHQ.js";import"./chunk-UVSBIWKY.js";import"./chunk-5EQTOVFJ.js";import{a as ue}from"./chunk-OZ63RRZR.js";import"./chunk-3T7HRBK4.js";import"./chunk-G323P4PR.js";import"./chunk-NZD6IPKE.js";import"./chunk-EKOK3I7J.js";import{a as _e,b as ae,c as le,d as pe}from"./chunk-SU7IEUNK.js";import"./chunk-MYPGER6Q.js";import"./chunk-CETGYK4I.js";import{c as ce}from"./chunk-F7IHWOEY.js";import{c as X,d as Y}from"./chunk-GJAIQ3XH.js";import{c as O,d as K,g as ee,i as te,l as ne,n as ie,t as re,v as oe}from"./chunk-UA6GT64L.js";import{d as Z,e as q}from"./chunk-GOUT62LL.js";import{$b as A,Cb as l,Db as p,Eb as N,Fb as W,Gb as k,Ib as U,Mb as R,Nb as r,Rb as y,Tb as j,Ub as Q,Vb as G,Wb as g,X as b,Xb as d,Yb as w,Zb as T,_b as v,ac as D,bc as V,cc as J,db as s,dc as H,eb as B,ia as F,na as L,nc as x,oc as C,qc as z,vb as f,xa as c,xb as S,ya as _}from"./chunk-RH76WUG2.js";import{a as E,b as M}from"./chunk-3EYC4JTX.js";var Ce=["dynamiccomponent"];function Pe(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2);s(),v("Loaded ",i.Recipe.Items.length," of ",i._SharedObjectModelService.TotalItems,"")}}function he(a,m){if(a&1&&d(0),a&2){let i=m.item;v(" ",i.Name," - ",i.Code," ")}}function Re(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2);s(),v("Loaded ",i.Recipe.ProductUnits.length," of ",i._SharedObjectModelService.TotalItems,"")}}function Se(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.NameAndUnitFactor," ")}}function Te(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2);s(),v("Loaded ",i.Recipe.CostCenters.length," of ",i._SharedObjectModelService.TotalItems,"")}}function Ie(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.Name," ")}}function fe(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.Storages.length," of ",t._SharedObjectModelService.TotalItems,"")}}function ye(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.Name," ")}}function we(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.Items.length," of ",t._SharedObjectModelService.TotalItems,"")}}function Ae(a,m){if(a&1&&d(0),a&2){let i=m.item;v(" ",i.Name," - ",i.Code," ")}}function De(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.ProductUnits.length," of ",t._SharedObjectModelService.TotalItems,"")}}function Ve(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.NameAndUnitFactor," ")}}function ve(a,m){if(a&1){let i=U();l(0,"tr")(1,"td",18)(2,"div",39)(3,"button",40),R("click",function(){c(i);let e=r(3);return _(e.AppendRow(e.RecipeType.DirectProduct))}),N(4,"i",41),p(),l(5,"button",42),R("click",function(){c(i);let e=r().index,n=r(2);return _(n.RemoveRow(n.RecipeType.DirectProduct,e))}),N(6,"i",43),p()()(),l(7,"td")(8,"ng-select",44,4),x(10,"translate"),R("clear",function(){c(i);let e=r().$implicit;return _(e.Storages=[])})("focus",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("Storages",e,n,o.RecipeType.DirectProduct),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("Storages",e,n,o.RecipeType.DirectProduct),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(9),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("Storages",e,n,o.RecipeType.DirectProduct))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=r(),n=e.$implicit,o=e.index,u=r(2);return _(u.SelectValueDetails(n.StoreId,"Store",o))}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.StoreId,e)||(n.StoreId=e),_(e)}),f(11,fe,2,2,"ng-template",20)(12,ye,1,1,"ng-template",21),p()(),l(13,"td")(14,"ng-select",45,5),x(16,"translate"),R("clear",function(){c(i);let e=r().$implicit;return _(e.Items=[])})("focus",function(){c(i);let e=g(15),n=r().index,o=r(2);return o.ChangeSearchApiDetails("DirectProduct",e,n,1),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(15),n=r().index,o=r(2);return o.ChangeSearchApiDetails("DirectProduct",e,n,1),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(15),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("DirectProduct",e,n,1))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r().$implicit;return r(2)._AppModeService.ResetCurrentPage(),_(e.Items=[])})("change",function(){c(i);let e=g(15),n=r(),o=n.$implicit,u=n.index;return r(2).SelectItem(o.ProductId,u),_(e.blur())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.ProductId,e)||(n.ProductId=e),_(e)}),f(17,we,2,2,"ng-template",20)(18,Ae,1,2,"ng-template",21),p()(),l(19,"td")(20,"ng-select",46,6),x(22,"translate"),R("clear",function(){c(i);let e=r().$implicit;return _(e.ProductUnits=[])})("focus",function(){c(i);let e=g(21),n=r().index,o=r(2);return o.ChangeSearchApiDetails("ItemUnits",e,n,1),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(21),n=r().index,o=r(2);return o.ChangeSearchApiDetails("ItemUnits",e,n,1),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(21),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("ItemUnits",e,n,1))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=g(21),n=r(),o=n.$implicit,u=n.index;return r(2).SelectUnit(o.ProductUnitId,u),_(e.blur())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.ProductUnitId,e)||(n.ProductUnitId=e),_(e)}),f(23,De,2,2,"ng-template",20)(24,Ve,1,1,"ng-template",21),p()(),l(25,"td")(26,"input",47),R("change",function(){c(i);let e=r(3);return _(e.CalcRecipe())})("keyup",function(){c(i);let e=r(3);return _(e.CalcRecipe())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Quantity,e)||(n.Quantity=e),_(e)}),p()(),l(27,"td"),d(28),p(),l(29,"td"),d(30),p()()}if(a&2){let i=r(),t=i.$implicit,e=i.index,n=r(2);s(8),y("placeholder","  ",C(10,30,"SaleInvoice.ChooseStore"),""),S("items",t.Storages)("dropdownPosition","bottom")("searchable",!0)("virtualScroll",!0),A("ngModel",t.StoreId),s(6),y("placeholder","  ",C(16,32,"SaleInvoice.ChooseProduct"),""),S("dropdownPosition","bottom")("items",t.Items)("virtualScroll",!0)("searchable",!0),A("ngModel",t.ProductId),s(6),y("placeholder","  ",C(22,34,"Item.ItemUnit"),""),S("dropdownPosition","bottom")("items",t.ProductUnits)("disabled",t.ProductId==0||t.ProductId==null)("virtualScroll",!0)("searchable",!0),A("ngModel",t.ProductUnitId),s(6),y("id","Quantity",e,""),y("name","Quantity",e,""),S("disabled",t.ProductId==null||t.ProductUnitId==null),A("ngModel",t.Quantity),s(2),T(" ",t.WA," "),s(2),T(" ",n._AppModeService.GetTwoNumberAfterZero(t.TotalPrice)," ")}}function Ne(a,m){if(a&1&&(W(0),f(1,ve,31,36,"tr",38),k()),a&2){let i=m.$implicit,t=r(2);s(),S("ngIf",i.RecipeType==t.RecipeType.DirectProduct)}}function be(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.AccTrees.length," of ",t._SharedObjectModelService.TotalItems,"")}}function Ue(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.Name," ")}}function Ee(a,m){if(a&1){let i=U();l(0,"tr")(1,"td",18)(2,"div",39)(3,"button",40),R("click",function(){c(i);let e=r(3);return _(e.AppendRow(e.RecipeType.DirectSalary))}),N(4,"i",41),p(),l(5,"button",42),R("click",function(){c(i);let e=r().index,n=r(2);return _(n.RemoveRow(n.RecipeType.DirectSalary,e))}),N(6,"i",43),p()()(),l(7,"td")(8,"ng-select",48,7),R("clear",function(){c(i);let e=r().$implicit;return _(e.AccTrees=[])})("focus",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.DirectSalary),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.DirectSalary),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(9),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.DirectSalary))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=r(),n=e.$implicit,o=e.index,u=r(2);return _(u.SelectValueDetails(n.AccTreeId,"AccTree",o))}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.AccTreeId,e)||(n.AccTreeId=e),_(e)}),f(10,be,2,2,"ng-template",20)(11,Ue,1,1,"ng-template",21),p()(),l(12,"td")(13,"input",49),R("change",function(){c(i);let e=r(3);return _(e.CalcRecipe())})("keyup",function(){c(i);let e=r(3);return _(e.CalcRecipe())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Amount,e)||(n.Amount=e),_(e)}),p()(),l(14,"td")(15,"input",50),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Notes,e)||(n.Notes=e),_(e)}),p()()()}if(a&2){let i=r(),t=i.$implicit,e=i.index;s(8),S("items",t.AccTrees)("autofocus",!1)("dropdownPosition","bottom")("virtualScroll",!0)("searchable",!0),A("ngModel",t.AccTreeId),s(5),y("id","Amount",e,""),y("name","Amount",e,""),A("ngModel",t.Amount),s(2),y("id","Notes",e,""),y("name","Notes",e,""),A("ngModel",t.Notes)}}function Me(a,m){if(a&1&&(W(0),f(1,Ee,16,16,"tr",38),k()),a&2){let i=m.$implicit,t=r(2);s(),S("ngIf",i.RecipeType==t.RecipeType.DirectSalary)}}function We(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.Storages.length," of ",t._SharedObjectModelService.TotalItems,"")}}function ke(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.Name," ")}}function Be(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.Items.length," of ",t._SharedObjectModelService.TotalItems,"")}}function Oe(a,m){if(a&1&&d(0),a&2){let i=m.item;v(" ",i.Name," - ",i.Code," ")}}function $e(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.ProductUnits.length," of ",t._SharedObjectModelService.TotalItems,"")}}function Fe(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.NameAndUnitFactor," ")}}function Le(a,m){if(a&1){let i=U();l(0,"tr")(1,"td",18)(2,"div",39)(3,"button",40),R("click",function(){c(i);let e=r(3);return _(e.AppendRow(e.RecipeType.InDirectProduct))}),N(4,"i",41),p(),l(5,"button",42),R("click",function(){c(i);let e=r().index,n=r(2);return _(n.RemoveRow(n.RecipeType.InDirectProduct,e))}),N(6,"i",43),p()()(),l(7,"td")(8,"ng-select",44,4),x(10,"translate"),R("clear",function(){c(i);let e=r().$implicit;return _(e.Storages=[])})("focus",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("Storages",e,n,o.RecipeType.InDirectProduct),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("Storages",e,n,o.RecipeType.InDirectProduct),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(9),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("Storages",e,n,o.RecipeType.InDirectProduct))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=r(),n=e.$implicit,o=e.index,u=r(2);return _(u.SelectValueDetails(n.StoreId,"Store",o))}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.StoreId,e)||(n.StoreId=e),_(e)}),f(11,We,2,2,"ng-template",20)(12,ke,1,1,"ng-template",21),p()(),l(13,"td")(14,"ng-select",45,5),x(16,"translate"),R("clear",function(){c(i);let e=r().$implicit;return _(e.Items=[])})("focus",function(){c(i);let e=g(15),n=r().index,o=r(2);return o.ChangeSearchApiDetails("InDirectProduct",e,n,o.RecipeType.InDirectProduct),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(15),n=r().index,o=r(2);return o.ChangeSearchApiDetails("InDirectProduct",e,n,o.RecipeType.InDirectProduct),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(15),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("InDirectProduct",e,n,o.RecipeType.InDirectProduct))})("close",function(){c(i);let e=r().$implicit;return r(2)._AppModeService.ResetCurrentPage(),_(e.Items=[])})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=g(15),n=r(),o=n.$implicit,u=n.index;return r(2).SelectItem(o.ProductId,u),_(e.blur())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.ProductId,e)||(n.ProductId=e),_(e)}),f(17,Be,2,2,"ng-template",20)(18,Oe,1,2,"ng-template",21),p()(),l(19,"td")(20,"ng-select",46,6),x(22,"translate"),R("clear",function(){c(i);let e=r().$implicit;return _(e.ProductUnits=[])})("focus",function(){c(i);let e=g(21),n=r().index,o=r(2);return o.ChangeSearchApiDetails("ItemUnits",e,n,1),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(21),n=r().index,o=r(2);return o.ChangeSearchApiDetails("ItemUnits",e,n,1),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(21),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("ItemUnits",e,n,1))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=g(21),n=r(),o=n.$implicit,u=n.index;return r(2).SelectUnit(o.ProductUnitId,u),_(e.blur())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.ProductUnitId,e)||(n.ProductUnitId=e),_(e)}),f(23,$e,2,2,"ng-template",20)(24,Fe,1,1,"ng-template",21),p()(),l(25,"td")(26,"input",47),R("change",function(){c(i);let e=r(3);return _(e.CalcRecipe())})("keyup",function(){c(i);let e=r(3);return _(e.CalcRecipe())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Quantity,e)||(n.Quantity=e),_(e)}),p()(),l(27,"td"),d(28),p(),l(29,"td"),d(30),p()()}if(a&2){let i=r(),t=i.$implicit,e=i.index,n=r(2);s(8),y("placeholder","  ",C(10,30,"SaleInvoice.ChooseStore"),""),S("items",t.Storages)("dropdownPosition","bottom")("searchable",!0)("virtualScroll",!0),A("ngModel",t.StoreId),s(6),y("placeholder","  ",C(16,32,"SaleInvoice.ChooseProduct"),""),S("dropdownPosition","bottom")("items",t.Items)("virtualScroll",!0)("searchable",!0),A("ngModel",t.ProductId),s(6),y("placeholder","  ",C(22,34,"Item.ItemUnit"),""),S("dropdownPosition","bottom")("items",t.ProductUnits)("disabled",t.ProductId==0||t.ProductId==null)("virtualScroll",!0)("searchable",!0),A("ngModel",t.ProductUnitId),s(6),y("id","Quantity",e,""),y("name","Quantity",e,""),S("disabled",t.ProductId==null||t.ProductUnitId==null),A("ngModel",t.Quantity),s(2),T(" ",t.WA," "),s(2),T(" ",n._AppModeService.GetTwoNumberAfterZero(t.TotalPrice)," ")}}function je(a,m){if(a&1&&(W(0),f(1,Le,31,36,"tr",38),k()),a&2){let i=m.$implicit,t=r(2);s(),S("ngIf",i.RecipeType==t.RecipeType.InDirectProduct)}}function Qe(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.AccTrees.length," of ",t._SharedObjectModelService.TotalItems,"")}}function Ge(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.Name," ")}}function Je(a,m){if(a&1){let i=U();l(0,"tr")(1,"td",18)(2,"div",39)(3,"button",40),R("click",function(){c(i);let e=r(3);return _(e.AppendRow(e.RecipeType.InDirectSalary))}),N(4,"i",41),p(),l(5,"button",42),R("click",function(){c(i);let e=r().index,n=r(2);return _(n.RemoveRow(n.RecipeType.InDirectSalary,e))}),N(6,"i",43),p()()(),l(7,"td")(8,"ng-select",48,7),R("clear",function(){c(i);let e=r().$implicit;return _(e.AccTrees=[])})("focus",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.InDirectSalary),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.InDirectSalary),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(9),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.InDirectSalary))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=r(),n=e.$implicit,o=e.index,u=r(2);return _(u.SelectValueDetails(n.AccTreeId,"AccTree",o))}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.AccTreeId,e)||(n.AccTreeId=e),_(e)}),f(10,Qe,2,2,"ng-template",20)(11,Ge,1,1,"ng-template",21),p()(),l(12,"td")(13,"input",49),R("change",function(){c(i);let e=r(3);return _(e.CalcRecipe())})("keyup",function(){c(i);let e=r(3);return _(e.CalcRecipe())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Amount,e)||(n.Amount=e),_(e)}),p()(),l(14,"td")(15,"input",50),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Notes,e)||(n.Notes=e),_(e)}),p()()()}if(a&2){let i=r(),t=i.$implicit,e=i.index;s(8),S("items",t.AccTrees)("autofocus",!1)("dropdownPosition","top")("virtualScroll",!0)("searchable",!0),A("ngModel",t.AccTreeId),s(5),y("id","Amount",e,""),y("name","Amount",e,""),A("ngModel",t.Amount),s(2),y("id","Notes",e,""),y("name","Notes",e,""),A("ngModel",t.Notes)}}function He(a,m){if(a&1&&(W(0),f(1,Je,16,16,"tr",38),k()),a&2){let i=m.$implicit,t=r(2);s(),S("ngIf",i.RecipeType==t.RecipeType.InDirectSalary)}}function ze(a,m){if(a&1&&(l(0,"small",37),d(1),p()),a&2){let i=r(2).$implicit,t=r(2);s(),v("Loaded ",i.AccTrees.length," of ",t._SharedObjectModelService.TotalItems,"")}}function Ze(a,m){if(a&1&&d(0),a&2){let i=m.item;T(" ",i.Name," ")}}function qe(a,m){if(a&1){let i=U();l(0,"tr")(1,"td",18)(2,"div",39)(3,"button",40),R("click",function(){c(i);let e=r(3);return _(e.AppendRow(e.RecipeType.InDirectOther))}),N(4,"i",41),p(),l(5,"button",42),R("click",function(){c(i);let e=r().index,n=r(2);return _(n.RemoveRow(n.RecipeType.InDirectOther,e))}),N(6,"i",43),p()()(),l(7,"td")(8,"ng-select",48,7),R("clear",function(){c(i);let e=r().$implicit;return _(e.AccTrees=[])})("focus",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.InDirectOther),_(o._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(9),n=r().index,o=r(2);return o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.InDirectOther),_(o._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(9),n=r().index,o=r(2);return _(o.ChangeSearchApiDetails("AccTreeExpenses",e,n,o.RecipeType.InDirectOther))})("close",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("open",function(){c(i);let e=r(3);return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=r(),n=e.$implicit,o=e.index,u=r(2);return _(u.SelectValueDetails(n.AccTreeId,"AccTree",o))}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.AccTreeId,e)||(n.AccTreeId=e),_(e)}),f(10,ze,2,2,"ng-template",20)(11,Ze,1,1,"ng-template",21),p()(),l(12,"td")(13,"input",49),R("change",function(){c(i);let e=r(3);return _(e.CalcRecipe())})("keyup",function(){c(i);let e=r(3);return _(e.CalcRecipe())}),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Amount,e)||(n.Amount=e),_(e)}),p()(),l(14,"td")(15,"input",50),V("ngModelChange",function(e){c(i);let n=r().$implicit;return D(n.Notes,e)||(n.Notes=e),_(e)}),p()()()}if(a&2){let i=r(),t=i.$implicit,e=i.index;s(8),S("items",t.AccTrees)("autofocus",!1)("dropdownPosition","top")("virtualScroll",!0)("searchable",!0),A("ngModel",t.AccTreeId),s(5),y("id","Amount",e,""),y("name","Amount",e,""),A("ngModel",t.Amount),s(2),y("id","Notes",e,""),y("name","Notes",e,""),A("ngModel",t.Notes)}}function Ke(a,m){if(a&1&&(W(0),f(1,qe,16,16,"tr",38),k()),a&2){let i=m.$implicit,t=r(2);s(),S("ngIf",i.RecipeType==t.RecipeType.InDirectOther)}}function Xe(a,m){if(a&1){let i=U();N(0,"app-modal-header",10),l(1,"div",11)(2,"div",12)(3,"label",13),d(4),x(5,"translate"),p(),N(6,"input",14),p(),l(7,"div",15)(8,"label",16),d(9),x(10,"translate"),p(),l(11,"input",17),V("ngModelChange",function(e){c(i);let n=r();return D(n.Recipe.Notes,e)||(n.Recipe.Notes=e),_(e)}),p()(),l(12,"div",15)(13,"label",18),d(14),x(15,"translate"),p(),l(16,"ng-select",19,2),R("clear",function(){c(i);let e=r();return _(e.Recipe.Items=[])})("focus",function(){c(i);let e=g(17),n=r();return n.ChangeSearchApi("Product",e),_(n._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(17),n=r();return n.ChangeSearchApi("Product",e),_(n._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(17),n=r();return _(n.ChangeSearchApi("Product",e))})("close",function(){c(i);let e=r();return e._AppModeService.ResetCurrentPage(),_(e.Recipe.Items=[])})("open",function(){c(i);let e=r();return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=g(17),n=r();return n.SelectValue(n.Recipe.ProductId,"Product"),e.blur(),_(n.Recipe.Items=[])}),V("ngModelChange",function(e){c(i);let n=r();return D(n.Recipe.ProductId,e)||(n.Recipe.ProductId=e),_(e)}),f(18,Pe,2,2,"ng-template",20)(19,he,1,2,"ng-template",21),p()(),l(20,"div",15)(21,"label",18),d(22),x(23,"translate"),p(),l(24,"ng-select",22,3),R("clear",function(){c(i);let e=r();return _(e.Recipe.ProductUnits=[])})("focus",function(){c(i);let e=g(25),n=r();return n.ChangeSearchApi("ItemUnits",e),_(n._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(25),n=r();return n.ChangeSearchApi("ItemUnits",e),_(n._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(25),n=r();return _(n.ChangeSearchApi("ItemUnits",e))})("close",function(){c(i);let e=r();return e._AppModeService.ResetCurrentPage(),_(e.Recipe.ProductUnits=[])})("open",function(){c(i);let e=r();return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=g(25),n=r();return n.SelectValue(n.Recipe.ProductUnitId,"ProductUnit"),e.blur(),_(n.Recipe.ProductUnits=[])}),V("ngModelChange",function(e){c(i);let n=r();return D(n.Recipe.ProductUnitId,e)||(n.Recipe.ProductUnitId=e),_(e)}),f(26,Re,2,2,"ng-template",20)(27,Se,1,1,"ng-template",21),p()(),l(28,"div",15)(29,"label",18),d(30),x(31,"translate"),p(),l(32,"ng-select",23,2),R("clear",function(){c(i);let e=r();return _(e.Recipe.CostCenters=[])})("focus",function(){c(i);let e=g(17),n=r();return n.ChangeSearchApi("CostCenter",e),_(n._AppModeService.ResetCurrentPage())})("keyup",function(){c(i);let e=g(17),n=r();return n.ChangeSearchApi("CostCenter",e),_(n._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){c(i);let e=g(17),n=r();return _(n.ChangeSearchApi("CostCenter",e))})("close",function(){c(i);let e=r();return e._AppModeService.ResetCurrentPage(),_(e.Recipe.CostCenters=[])})("open",function(){c(i);let e=r();return _(e._AppModeService.ResetCurrentPage())})("change",function(){c(i);let e=g(17),n=r();return n.SelectValue(n.Recipe.CostCenterId,"CostCenter"),e.blur(),_(n.Recipe.CostCenters=[])}),V("ngModelChange",function(e){c(i);let n=r();return D(n.Recipe.CostCenterId,e)||(n.Recipe.CostCenterId=e),_(e)}),f(34,Te,2,2,"ng-template",20)(35,Ie,1,1,"ng-template",21),p()(),l(36,"div",15)(37,"label",24),d(38),x(39,"translate"),p(),N(40,"input",25),p(),l(41,"div",12)(42,"button",26),R("click",function(){c(i);let e=r();return _(e.ResetWa())}),d(43),x(44,"translate"),p()()(),l(45,"div",27)(46,"div",28)(47,"h4",29),d(48," \u062A\u0643\u0627\u0644\u064A\u0641 \u0635\u0646\u0627\u0639\u064A\u0629 \u0645\u0628\u0627\u0634\u0631\u0629 "),p()(),l(49,"div",30)(50,"p",31),d(51),x(52,"translate"),l(53,"span"),d(54,"["),p(),d(55),l(56,"span"),d(57,"]"),p()(),l(58,"table",32)(59,"thead")(60,"tr")(61,"th",18),d(62,"#"),p(),l(63,"th",33),d(64),x(65,"translate"),p(),l(66,"th",33),d(67),x(68,"translate"),p(),l(69,"th",33),d(70),x(71,"translate"),p(),l(72,"th",33),d(73),x(74,"translate"),p(),l(75,"th",33),d(76),x(77,"translate"),p(),l(78,"th",33),d(79),x(80,"translate"),p()()(),l(81,"tbody"),f(82,Ne,2,1,"ng-container",34),p()()(),l(83,"div",30)(84,"p",31),d(85),x(86,"translate"),l(87,"span"),d(88,"["),p(),d(89),l(90,"span"),d(91,"]"),p()(),l(92,"table",32)(93,"thead")(94,"tr")(95,"th",18),d(96,"#"),p(),l(97,"th",35),d(98),x(99,"translate"),p(),l(100,"th",35),d(101),x(102,"translate"),p(),l(103,"th",35),d(104),x(105,"translate"),p()()(),l(106,"tbody"),f(107,Me,2,1,"ng-container",34),p()()(),l(108,"div",28)(109,"h4",29),d(110," \u062A\u0643\u0627\u0644\u064A\u0641 \u0635\u0646\u0627\u0639\u064A\u0629 \u063A\u064A\u0631 \u0645\u0628\u0627\u0634\u0631\u0629 "),p()(),l(111,"div",30)(112,"p",31),d(113),x(114,"translate"),l(115,"span"),d(116,"["),p(),d(117),l(118,"span"),d(119,"]"),p()(),l(120,"table",32)(121,"thead")(122,"tr")(123,"th"),d(124,"#"),p(),l(125,"th",33),d(126),x(127,"translate"),p(),l(128,"th",33),d(129),x(130,"translate"),p(),l(131,"th",33),d(132),x(133,"translate"),p(),l(134,"th",33),d(135),x(136,"translate"),p(),l(137,"th",33),d(138),x(139,"translate"),p(),l(140,"th",33),d(141),x(142,"translate"),p()()(),l(143,"tbody"),f(144,je,2,1,"ng-container",34),p()()(),l(145,"div",30)(146,"p",31),d(147),x(148,"translate"),l(149,"span"),d(150,"["),p(),d(151),l(152,"span"),d(153,"]"),p()(),l(154,"table",32)(155,"thead")(156,"tr")(157,"th"),d(158,"#"),p(),l(159,"th",35),d(160),x(161,"translate"),p(),l(162,"th",35),d(163),x(164,"translate"),p(),l(165,"th",35),d(166),x(167,"translate"),p()()(),l(168,"tbody"),f(169,He,2,1,"ng-container",34),p()()(),l(170,"div",30)(171,"p",31),d(172),x(173,"translate"),l(174,"span"),d(175,"["),p(),d(176),l(177,"span"),d(178,"]"),p()(),l(179,"table",32)(180,"thead")(181,"tr")(182,"th"),d(183,"#"),p(),l(184,"th",35),d(185),x(186,"translate"),p(),l(187,"th",35),d(188),x(189,"translate"),p(),l(190,"th",35),d(191),x(192,"translate"),p()()(),l(193,"tbody"),f(194,Ke,2,1,"ng-container",34),p()()()(),l(195,"app-modal-footer",36),R("SaveEvent",function(){c(i);let e=r();return _(e.Save())})("UpdateEvent",function(){c(i);let e=r();return _(e.Save())})("CloseEvent",function(){let e=c(i).$implicit,n=r();return e.close("Close click"),_(n.ResetPage())}),p()}if(a&2){let i=r();S("PageTitle",i.TablePaging.PageTitle),s(4),T(" ",C(5,66,"Table.DocNo")," "),s(2),S("disabled",!0)("value",i.Recipe.DocNo),s(3),T(" ",C(10,68,"Table.Notes")," "),s(2),A("ngModel",i.Recipe.Notes),s(3),T(" ",C(15,70,"TransferStorage.Name")," "),s(2),S("dropdownPosition","bottom")("items",i.Recipe.Items)("virtualScroll",!0)("searchable",!0),A("ngModel",i.Recipe.ProductId),s(6),T(" ",C(23,72,"Item.ItemUnit")," "),s(2),S("disabled",i.Recipe.ProductId==null)("dropdownPosition","bottom")("items",i.Recipe.ProductUnits)("virtualScroll",!0)("searchable",!0),A("ngModel",i.Recipe.ProductUnitId),s(6),T(" ",C(31,74,"MoneyIn.CostCenter")," "),s(2),S("dropdownPosition","bottom")("items",i.Recipe.CostCenters)("virtualScroll",!0)("searchable",!0),A("ngModel",i.Recipe.CostCenterId),s(6),T(" ",C(39,76,"ProductRecipe.TotalPrice")," "),s(2),S("value",i._AppModeService.GetTwoNumberAfterZero(i.Recipe.TotalPrice))("disabled",!0),s(3),w(C(44,78,"ProductRecipe.ResetWa")),s(8),T(" ",C(52,80,"ProductRecipe.TotalDirectProduct")," "),s(4),T(" ",i.Recipe.TotalDirectProduct," "),s(9),w(C(65,82,"SaleInvoice.Storage")),s(3),w(C(68,84,"SaleInvoice.Name")),s(3),w(C(71,86,"SaleInvoice.Unit")),s(3),w(C(74,88,"Table.Quantity")),s(3),w(C(77,90,"ProductRecipe.WA")),s(3),w(C(80,92,"Table.Total")),s(3),S("ngForOf",i.RecipeDetails),s(3),T(" ",C(86,94,"ProductRecipe.TotalDirectSalary")," "),s(4),T(" ",i.Recipe.TotalDirectSalary," "),s(9),w(C(99,96,"SaleInvoice.Name")),s(3),w(C(102,98,"MoneyIn.Price")),s(3),w(C(105,100,"MoneyIn.Notes")),s(3),S("ngForOf",i.RecipeDetails),s(6),T(" ",C(114,102,"ProductRecipe.TotalInDirectProduct")," "),s(4),T(" ",i.Recipe.TotalInDirectProduct," "),s(9),w(C(127,104,"SaleInvoice.Storage")),s(3),w(C(130,106,"SaleInvoice.Name")),s(3),w(C(133,108,"SaleInvoice.Unit")),s(3),w(C(136,110,"Table.Quantity")),s(3),w(C(139,112,"ProductRecipe.WA")),s(3),w(C(142,114,"Table.Total")),s(3),S("ngForOf",i.RecipeDetails),s(3),T(" ",C(148,116,"ProductRecipe.TotalInDirectSalary")," "),s(4),T(" ",i.Recipe.TotalInDirectSalary," "),s(9),w(C(161,118,"SaleInvoice.Name")),s(3),w(C(164,120,"MoneyIn.Price")),s(3),w(C(167,122,"MoneyIn.Notes")),s(3),S("ngForOf",i.RecipeDetails),s(3),T(" ",C(173,124,"ProductRecipe.TotalInDirectOther")," "),s(4),T(" ",i.Recipe.TotalInDirectOther," "),s(9),w(C(186,126,"SaleInvoice.Name")),s(3),w(C(189,128,"MoneyIn.Price")),s(3),w(C(192,130,"MoneyIn.Notes")),s(3),S("ngForOf",i.RecipeDetails),s(),S("Id",i.Recipe.Id)}}var Rt=(()=>{let m=class m{constructor(t,e,n,o){this._SharedScreenService=t,this._SharedObjectModelService=e,this._AppModeService=n,this._Apiservice=o,this._ServiceLifeTime=F(O),this.TablePaging={PageTitle:"ProductRecipe.ProductRecipe",GetById:"ProductRecipeEP/GetById",DeleteUrl:"ProductRecipeEP/Delete",BranchFilter:!0,Url:"Global/GetAll",TableName:"ProductRecipe",JoinTables:["Items Product","ItemUnits ProductUnit"],JoinConditions:["T.ProductId = Product.Id","T.ProductUnitId = ProductUnit.Id"],Join:!0,Columns:["T.Id","T.DocNo","Product.Name AS ProductName","ProductUnit.Name AS ProductUnitName"],TableCell:[{SortName:"DocNo",CellName:"Table.DocNo",ExistSearchField:"T.DocNo"},{SortName:"ProductName",CellName:"Table.Name",ExistSearchField:"Product.Name"},{SortName:"ProductUnitName",CellName:"Item.ItemUnit",ExistSearchField:"ProductUnit.Name"}]},this.Recipe={Id:0,DocNo:0,DocDate:null,ProductId:null,ProductName:"",ProductUnitId:null,ProductUnitName:"",CostCenterId:null,CostCenterName:"",TotalPrice:0,Items:[],ProductUnits:[],CostCenters:[],RecipeDetails:[]},this.RecipeType={DirectProduct:1,DirectSalary:2,InDirectProduct:3,InDirectSalary:4,InDirectOther:5},this.RecipeDetails=[{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.DirectProduct,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.DirectSalary,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.InDirectProduct,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",Items:[],StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],RecipeType:this.RecipeType.InDirectSalary,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.InDirectOther,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""}]}ngOnInit(){}OpenModal(){this.ResetPage(),this.GetPageInfo()}ShowToEdite(t){this.ResetPage(),this.Drow(t.PageModel)}Drow(t){this.Recipe={Id:t.Id,Notes:t.Notes,DocNo:t.DocNo,ProductId:t.ProductId,ProductName:t.ProductName,ProductUnitId:t.ProductUnitId,ProductUnitName:t.ProductUnitName,CostCenterId:t.CostCenterId,CostCenterName:t.CostCenterName,TotalPrice:t.TotalPrice,TotalDirectProduct:t.TotalDirectProduct,TotalDirectSalary:t.TotalDirectSalary,TotalInDirectProduct:t.TotalInDirectProduct,TotalInDirectSalary:t.TotalInDirectSalary,TotalInDirectOther:t.TotalInDirectOther,ProductRecipeDetails:t.ProductRecipeDetails},this.Recipe.Items=[{Id:t.ProductId,Name:t.ProductName,NameAndCode:t.ProductName}],this.Recipe.ProductUnits=[{Id:t.ProductUnitId,Name:t.ProductUnitName,NameAndUnitFactor:t.ProductUnitName}],this.Recipe.CostCenters=[{Id:t.CostCenterId,Name:t.CostCenterName}],this.RecipeDetails=[];for(let P=0;P<this.Recipe.ProductRecipeDetails.length;P++){let I=this.Recipe.ProductRecipeDetails[P];I.StoreId>0&&(I.Storages=[{Id:I.StoreId,Name:I.StoreName}]),I.ProductId>0&&(I.Items=[{Id:I.ProductId,Name:I.ProductName,NameAndCode:I.ProductName}]),I.ProductUnitId>0&&(I.ProductUnits=[{Id:I.ProductUnitId,Name:I.ProductUnitName,NameAndUnitFactor:I.ProductUnitName}]),I.AccTreeId>0&&(I.AccTrees=[{Id:I.AccTreeId,Name:I.AccTreeName}]),this.RecipeDetails.push(I)}this.Recipe.ProductRecipeDetails.filter(P=>P.RecipeType==this.RecipeType.DirectProduct).length==0&&this.AppendRow(this.RecipeType.DirectProduct),this.Recipe.ProductRecipeDetails.filter(P=>P.RecipeType==this.RecipeType.DirectSalary).length==0&&this.AppendRow(this.RecipeType.DirectSalary),this.Recipe.ProductRecipeDetails.filter(P=>P.RecipeType==this.RecipeType.InDirectProduct).length==0&&this.AppendRow(this.RecipeType.InDirectProduct),this.Recipe.ProductRecipeDetails.filter(P=>P.RecipeType==this.RecipeType.InDirectSalary).length==0&&this.AppendRow(this.RecipeType.InDirectSalary),this.Recipe.ProductRecipeDetails.filter(P=>P.RecipeType==this.RecipeType.InDirectOther).length==0&&this.AppendRow(this.RecipeType.InDirectOther),this.CalcRecipe()}GetPageInfo(){this._Apiservice.get("ProductRecipeEP/GetPageInfo",!1).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:t=>{this.Recipe.DocNo=t.Obj}})}AppendRow(t){let e={Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],RecipeType:t,Items:[],ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""};this.RecipeDetails.push(e)}RemoveRow(t,e){return this.RecipeDetails.filter(n=>n.RecipeType==t).length==1?(this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("SaleInvoice.Error.ErrorFirstRow")),!1):(this.RecipeDetails.splice(e,1),this.CalcRecipe(),!0)}CalcRecipe(){this.Recipe.TotalPrice=0,this.Recipe.TotalDirectProduct=0,this.Recipe.TotalDirectSalary=0,this.Recipe.TotalInDirectProduct=0,this.Recipe.TotalInDirectSalary=0,this.Recipe.TotalInDirectOther=0;for(let t=0;t<this.RecipeDetails.length;t++){let e=this.RecipeDetails[t];e.TotalPrice=Number(e.WA)*Number(e.Quantity),this.Recipe.TotalPrice+=Number(e.TotalPrice),this.Recipe.TotalPrice+=Number(e.Amount),e.RecipeType==this.RecipeType.DirectProduct&&(this.Recipe.TotalDirectProduct+=Number(e.TotalPrice)),e.RecipeType==this.RecipeType.DirectSalary&&(this.Recipe.TotalDirectSalary+=Number(e.Amount)),e.RecipeType==this.RecipeType.InDirectProduct&&(this.Recipe.TotalInDirectProduct+=Number(e.TotalPrice)),e.RecipeType==this.RecipeType.InDirectSalary&&(this.Recipe.TotalInDirectSalary+=Number(e.Amount)),e.RecipeType==this.RecipeType.InDirectOther&&(this.Recipe.TotalInDirectOther+=Number(e.Amount))}}ChangeSearchApi(t,e){let n="";n=`${e.searchTerm}`.trim(),(n==""||n=="null")&&(e.searchTerm="",n=""),this._AppModeService.CurrentPage+=1;let o={TableName:t,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:n,SearchField:"Name"};if(t=="CostCenter"&&(o.BranchFilter=!0),t=="Product"&&(o.TableName="Items",o.Columns=["Id","Name","Code"],o.SearchField="Code",o.Conditions="ProductType = 1"),t=="ItemUnits"){let u=this.Recipe.ProductId==null?0:this.Recipe.ProductId;o.Conditions=`ItemId = ${u}`,o.Join=!0,o.JoinTables=["Units U"],o.NoPaging=!0,o.JoinConditions=["T.UnitId = U.Id"],o.Columns=["T.Id","U.Name","T.UnitFactor"],o.SearchField="U.Name"}this._Apiservice.post("Global/GetAll",o,!1).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:u=>{this.HandleResponse(u.Obj,t)}})}HandleResponse(t,e){this._SharedObjectModelService.TotalItems=0,this._SharedObjectModelService.TotalItems=t.TotalItems,e=="CostCenter"&&(this.Recipe.CostCenters=this._SharedObjectModelService.RemoveDuplicates(this.Recipe.CostCenters.concat(t.DataReturn),"Id")),e=="Product"&&(this.Recipe.Items=this._SharedObjectModelService.RemoveDuplicates(this.Recipe.Items.concat(t.DataReturn),"Id").map(n=>M(E({},n),{NameAndCode:n.Code!=null?`${n.Name} - ${n.Code}`:`${n.Name}`}))),e=="ItemUnits"&&(this.Recipe.ProductUnits=t.DataReturn.map(n=>M(E({},n),{UnitFactor:n.UnitFactor,NameAndUnitFactor:`${n.Name} - ${n.UnitFactor}`})))}SelectValue(t,e){if(t!=null&&(t>0||t!="")){let n=[];e=="Product"&&(n=this.Recipe.Items),e=="CostCenter"&&(n=this.Recipe.CostCenters),e=="ProductUnit"&&(n=this.Recipe.ProductUnits);let o=n.find(u=>u.Id==t);if(o==null){this._AppModeService.DontPlay();return}else this.Recipe[`${e}Id`]=t,this.Recipe[`${e}Name`]=o.Name}else this.Recipe[`${e}Id`]=null,this.Recipe[`${e}Name`]="",e=="ProductUnit"&&(this.Recipe.ProductUnits=[],this.Recipe.ProductUnitId=null);e=="Product"&&(this.Recipe.ProductUnits=[],this.Recipe.ProductUnitId=null)}SelectItem(t,e){if(t!=null&&t>0){let n=this.RecipeDetails[e].Items.find(o=>o.Id==t);if(n!=null)this.RecipeDetails[e].ProductId=n.Id,this.RecipeDetails[e].ProductName=n.Name,this.RecipeDetails[e].ProductUnitId=null,this.RecipeDetails[e].ProductUnits=[],this.AfterSelectem(n.Id,e);else{this._Apiservice.DontPlay();return}}else this.RecipeDetails[e].ProductUnitId=null,this.RecipeDetails[e].ProductUnits=[]}AfterSelectem(t,e){if(t>0){let n={TableName:"ItemUnits",Columns:["Id","Name"],NoPaging:!0,SearchText:"",SearchField:"Name"};n.Conditions=`ItemId = ${t}`,n.Join=!0,n.JoinTables=["Units U"],n.JoinConditions=["T.UnitId = U.Id"],n.Columns=["T.Id","U.Name","T.UnitFactor","T.DefaultUnit"],n.SearchField="U.Name",this._Apiservice.post("Global/GetAll",n,!1).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:o=>{o.Obj.DataReturn=o.Obj.DataReturn.map(P=>M(E({},P),{NameAndUnitFactor:P.UnitFactor!=null?`${P.Name} - ${P.UnitFactor}`:`${P.Name}`}));let u=o.Obj.DataReturn,h=u.find(P=>P.DefaultUnit==!0);if(h&&this.RecipeDetails.find(I=>I.ProductId==t&&I.ProductUnitId==h.Id)==null){this.RecipeDetails[e].ProductUnits=[{Id:h.Id,NameAndUnitFactor:h.Name+" - "+h.UnitFactor}],this.RecipeDetails[e].ProductUnitId=h.Id,this.SelectUnit(h.Id,e);return}for(let P=0;P<u.length;P++){let I=this.RecipeDetails.find($=>$.ProductId==t&&$.ProductUnitId==u[P].Id);if(I==null){this.RecipeDetails[e].ProductUnits=[{Id:u[P].Id,NameAndUnitFactor:u[P].Name+" - "+u[P].UnitFactor}],this.RecipeDetails[e].ProductUnitId=u[P].Id,this.SelectUnit(u[P].Id,e);break}I!=null&&P==u.length-1&&this.RecipeDetails.splice(e,1)}this.CalcRecipe()}})}}SelectUnit(t,e){if(t!=null&&t>0){let n=this.RecipeDetails[e].ProductUnits.find(o=>o.Id==t);if(n!=null)this.RecipeDetails[e].ProductUnitId=n.Id,this.RecipeDetails[e].ProductUnitName=n.Name,this.UnitWa(n.Id,e);else{this._Apiservice.DontPlay();return}}}UnitWa(t,e){let n=this.RecipeDetails[e].ProductId;t>0&&n>0&&this._Apiservice.get(`ItemEP/ItemWaUnit?ProductId=${n}&ProductUnitId=${t}`,!1).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:o=>{this.RecipeDetails[e].WA=o.Obj,this.CalcRecipe()}})}ResetWa(){for(let t=0;t<this.RecipeDetails.length;t++){let e=this.RecipeDetails[t];e.ProductUnitId>0&&e.ProductId>0&&this._Apiservice.get(`ItemEP/ItemWaUnit?ProductId=${e.ProductId}&ProductUnitId=${e.ProductUnitId}`,!0).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:n=>{e.WA=n.Obj,this.CalcRecipe()}})}}ChangeSearchApiDetails(t,e,n,o){let u=`${e.searchTerm}`.trim();(u==""||u=="null")&&(e.searchTerm="",u=""),this._AppModeService.CurrentPage+=1;let h={TableName:t,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:u,SearchField:"Name"};if(t=="AccTreeExpenses"&&(h.TableName="AccTree",h.BranchFilter=!0,h.Conditions="AccClass >= 3 And Level = 5"),(t=="DirectProduct"||t=="InDirectProduct")&&(h.TableName="Items",h.Columns=["Id","Name","Code"],t=="DirectProduct"&&(h.Conditions=this.Recipe.ProductId>0?`ProductType = 1 And Id != ${this.Recipe.ProductId}`:"ProductType = 1"),t=="InDirectProduct"&&(h.Conditions=this.Recipe.ProductId>0?`ProductType = 3 And Id != ${this.Recipe.ProductId}`:"ProductType = 3")),t=="ItemUnits"){let P=this.RecipeDetails[n].ProductId==null?0:this.RecipeDetails[n].ProductId;h.Conditions=`ItemId = ${P}`,h.Join=!0,h.JoinTables=["Units U"],h.NoPaging=!0,h.JoinConditions=["T.UnitId = U.Id"],h.Columns=["T.Id","U.Name","T.UnitFactor"],h.SearchField="U.Name"}this._Apiservice.post("Global/GetAll",h,!1).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:P=>{this.HandleResponseDetails(P.Obj,t,n)}})}HandleResponseDetails(t,e,n){this._SharedObjectModelService.TotalItems=0,this._SharedObjectModelService.TotalItems=t.TotalItems,e=="Storages"&&(this.RecipeDetails[n].Storages=this._SharedObjectModelService.RemoveDuplicates(this.RecipeDetails[n].Storages.concat(t.DataReturn),"Id")),(e=="DirectProduct"||e=="InDirectProduct")&&(this.RecipeDetails[n].Items=this._SharedObjectModelService.RemoveDuplicates(this.RecipeDetails[n].Items.concat(t.DataReturn),"Id"),this.RecipeDetails[n].Items=this.RecipeDetails[n].Items.map(o=>M(E({},o),{NameAndCode:o.Code!=null?`${o.Name} - ${o.Code}`:`${o.Name}`}))),e=="ItemUnits"&&(this.RecipeDetails[n].ProductUnits=t.DataReturn.map(o=>M(E({},o),{NameAndUnitFactor:o.UnitFactor!=null?`${o.Name} - ${o.UnitFactor}`:`${o.Name}`}))),e=="AccTreeExpenses"&&(this.RecipeDetails[n].AccTrees=this._SharedObjectModelService.RemoveDuplicates(this.RecipeDetails[n].AccTrees.concat(t.DataReturn),"Id"))}SelectValueDetails(t,e,n){if(t!=null&&t>0){let o=[];e=="AccTree"&&(o=this.RecipeDetails[n].AccTrees),e=="Store"&&(o=this.RecipeDetails[n].Storages);let u=o.find(h=>h.Id==t);if(u!=null)this.RecipeDetails[n][`${e}Id`]=u.Id,this.RecipeDetails[n][`${e}Name`]=u.Name;else{this._Apiservice.DontPlay();return}}else this.RecipeDetails[n][`${e}Id`]=null,this.RecipeDetails[n][`${e}Name`]=[]}Save(){if(this.Recipe.ProductId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.ChooseItem"));return}if(this.Recipe.ProductUnitId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.EnterProductUnit"));return}if(this.Recipe.CostCenterId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.EnterCostCenter"));return}if(this.Recipe.TotalPrice<=0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.TotalPrice"));return}let t=this.RecipeDetails.filter(n=>Number(n.WA)>0||Number(n.Amount)>0);if(t.length==0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.Empty"));return}for(let n=0;n<this.RecipeDetails.length;n++){let o=this.RecipeDetails[n];if(o.RecipeType=Number(o.RecipeType),Number(o.Amount)>0&&o.AccTreeId==null&&(o.RecipeType==this.RecipeType.DirectSalary||o.RecipeType==this.RecipeType.InDirectSalary||o.RecipeType==this.RecipeType.InDirectOther)){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.ChooseAccount"));return}if(Number(o.WA)>0&&(o.RecipeType==this.RecipeType.DirectProduct||o.RecipeType==this.RecipeType.InDirectProduct)){if(o.ProductId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.ChooseItem"));return}if(o.StoreId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.Error.StoreId"));return}}if(o.AccTreeId>0&&Number(o.Amount)<=0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.WA"));return}if((o.ProductId>0||o.StoreId>0)&&Number(o.WA)<=0){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("ProductRecipe.WA"));return}}let e={Id:this.Recipe.Id,DocNo:this.Recipe.DocNo,Notes:this.Recipe.Notes,ProductId:this.Recipe.ProductId,ProductName:this.Recipe.ProductName,ProductUnitId:this.Recipe.ProductUnitId,ProductUnitName:this.Recipe.ProductUnitName,CostCenterId:this.Recipe.CostCenterId,CostCenterName:this.Recipe.CostCenterName,TotalPrice:this.Recipe.TotalPrice,ProductRecipeDetails:t.map(n=>M(E({},n),{Quantity:Number(n.Quantity),WA:Number(n.WA),Amount:Number(n.Amount)}))};e.Id==0&&this._Apiservice.post("ProductRecipeEP/Add",e,!0).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:n=>{this._AppModeService._Toastr.success(this._AppModeService._Translate.instant("Success.AddSuccess")),this.ResetPage(),this.GetPageInfo(),this.DynamicComponent.Paging.DataReturn.push(n.Obj)}}),e.Id>0&&this._Apiservice.put("ProductRecipeEP/Update",e,!0).pipe(b(this._ServiceLifeTime.Destroyed$)).subscribe({next:n=>{this._AppModeService._Toastr.success(this._AppModeService._Translate.instant("Success.UpdateSuccess"));let o=n.Obj,u=this.DynamicComponent.Paging.DataReturn.find(h=>h.Id==o.Id);u!=null&&Object.assign(u,o),this.ResetPage(),this.GetPageInfo()}})}ResetPage(){this.Recipe={Id:0,DocNo:0,DocDate:null,ProductId:null,ProductName:"",ProductUnitId:null,ProductUnitName:"",CostCenterId:null,CostCenterName:"",TotalPrice:0,Amount:"",Items:[],ProductUnits:[],CostCenters:[],RecipeDetails:[]},this.RecipeDetails=[{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.DirectProduct,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.DirectSalary,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.InDirectProduct,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",Items:[],StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],RecipeType:this.RecipeType.InDirectSalary,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""},{Id:0,Name:"",ProductId:null,ProductName:"",StoreId:null,StoreName:"",Storages:[],AccTreeId:null,AccTreeName:"",AccTrees:[],Items:[],RecipeType:this.RecipeType.InDirectOther,ProductUnitId:null,ProductUnitName:"",ProductUnits:[],Quantity:"",Amount:"",WA:""}]}ngOnDestroy(){}};m.\u0275fac=function(e){return new(e||m)(B(xe),B(ue),B(ce),B(K))},m.\u0275cmp=L({type:m,selectors:[["app-recipe-product"]],viewQuery:function(e,n){if(e&1&&j(Ce,5),e&2){let o;Q(o=G())&&(n.DynamicComponent=o.first)}},standalone:!0,features:[J([O]),H],decls:4,vars:6,consts:[["dynamiccomponent",""],["content",""],["Select",""],["SelectProductUnit",""],["SelectStorages",""],["SelectItem22",""],["SelectUnits",""],["SelectAccTreeDetails",""],[3,"OpenModalEvent","ShowToEditeEvent","PageTitle","TablePaging","FullScreen","OutModal","DeleteUrl","GetById"],[1,"modalConent"],[3,"PageTitle"],[1,"col-12","d-flex","flex-wrap","justify-content-","align-items-end","p-1","bg-white"],[1,"col-12","col-md-1","p-1"],["for","DocNo",1,""],["id","DocNo","name","DocNo","type","number",1,"form-control","text-center",3,"disabled","value"],[1,"col-12","col-md-2","p-1"],["for","Notes",1,""],["id","Notes","name","Notes","type","text",1,"form-control","text-center",3,"ngModelChange","ngModel"],[1,""],["id","ngSelectComponent","placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center","col-12",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","dropdownPosition","items","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],["id","ngSelectComponent","placeholder","Search","bindLabel","NameAndUnitFactor","bindValue","Id",1,"p-0","text-center","col-12",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","disabled","dropdownPosition","items","virtualScroll","searchable","ngModel"],["id","ngSelectComponent","placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center","col-12",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","dropdownPosition","items","virtualScroll","searchable","ngModel"],["for","TotalPrice",1,""],["id","TotalPrice","name","TotalPrice","type","number","appNumericInput","",1,"form-control","text-center",3,"value","disabled"],[1,"btn","btn-Refresh","px-2","mb-0","d-block",3,"click"],[1,"modal-body","p-0","m-0","d-flex","flex-wrap","justify-content-center","align-items-start","Invoicemodalbody","bg-white","ProductTable"],[1,"col-12"],[1,"m-0","p-2","col-12"],["id","ProductTable",1,"DivPaging","col-12","table-responsive-vertical","shadow-z-1"],[1,"my-1","text-center"],[1,"table","table-hover","table-striped","table-light","mt-1","mb-0"],[1,"col-2"],[4,"ngFor","ngForOf"],[1,"col-4"],[3,"SaveEvent","UpdateEvent","CloseEvent","Id"],[1,"form-text","text-muted"],[4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center","col-12"],[1,"btn-Add","btn",3,"click"],[1,"mx-1","fw-bold","pi","pi-plus"],[1,"btn-Delete","btn-Page","btn",3,"click"],[1,"mx-1","pi","pi-trash","fw-bold"],["bindLabel","Name","bindValue","Id",1,"p-0","col-12",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","dropdownPosition","placeholder","searchable","virtualScroll","ngModel"],["bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center","col-12",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","dropdownPosition","items","placeholder","virtualScroll","searchable","ngModel"],["bindLabel","NameAndUnitFactor","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","dropdownPosition","items","placeholder","disabled","virtualScroll","searchable","ngModel"],["min","0","type","number","appNumericInput","",1,"form-control","text-center",3,"change","keyup","ngModelChange","id","name","disabled","ngModel"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","col-12",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","dropdownPosition","virtualScroll","searchable","ngModel"],["min","0","type","number","appNumericInput","",1,"form-control","text-center",3,"change","keyup","ngModelChange","id","name","ngModel"],["type","text",1,"form-control","text-center",3,"ngModelChange","id","name","ngModel"]],template:function(e,n){if(e&1){let o=U();l(0,"app-dynamic-component",8,0),R("OpenModalEvent",function(){return c(o),_(n.OpenModal())})("ShowToEditeEvent",function(h){return c(o),_(n.ShowToEdite(h))}),p(),f(2,Xe,196,132,"ng-template",9,1,z)}if(e&2){let o=g(3);S("PageTitle",n.TablePaging.PageTitle)("TablePaging",n.TablePaging)("FullScreen",!0)("OutModal",o)("DeleteUrl",n.TablePaging.DeleteUrl)("GetById",n.TablePaging.GetById)}},dependencies:[de,me,oe,ee,ie,te,re,ne,q,pe,le,_e,ae,Z,Y,X,ge,se]});let a=m;return a})();export{Rt as RecipeProductComponent};
