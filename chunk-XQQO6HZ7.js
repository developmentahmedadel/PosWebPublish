import{g as X,h as Z,j as ie,s as ne}from"./chunk-S52O5BXQ.js";import{a as ee,b as te}from"./chunk-KOJPIKRQ.js";import{i as U}from"./chunk-WL6N6SLT.js";import{a as ae}from"./chunk-JZVD3M6G.js";import"./chunk-34JSETBR.js";import"./chunk-QFTVA365.js";import"./chunk-LNYZIAUP.js";import{k as K}from"./chunk-HYE6JRVA.js";import{a as L,b as z,c as G,d as H}from"./chunk-DVVEKPVL.js";import{b as J}from"./chunk-GTD5WNPP.js";import{c as N,h as W,k as Q,u as $}from"./chunk-M24M3PNC.js";import{c as Y,d as q}from"./chunk-4L6P5Z5M.js";import{G as j,e as R,j as k}from"./chunk-JM67XKKX.js";import{$b as w,Bb as a,Cb as n,Hb as M,Lb as x,Mb as f,Vb as C,Wb as o,Xb as T,Yb as h,Zb as P,_b as y,ac as D,cb as t,cc as F,db as b,dc as A,mc as c,na as V,nc as m,oc as O,ub as v,wb as u,xa as g,ya as I}from"./chunk-VIO7ZK3G.js";import{a as E,b as B}from"./chunk-3EYC4JTX.js";var re=()=>({"min-width":"50rem"}),oe=()=>["Name","Storage","Code"];function le(i,_){if(i&1&&(a(0,"small",33),o(1),n()),i&2){let r=f();t(),P("Loaded ",r.Storages.length," of ",r._SharedObjectModelService.TotalItems,"")}}function pe(i,_){if(i&1&&o(0),i&2){let r=_.item;h(" ",r.Name," ")}}function se(i,_){if(i&1&&(a(0,"small",33),o(1),n()),i&2){let r=f();t(),P("Loaded ",r.Items.length," of ",r._SharedObjectModelService.TotalItems,"")}}function ce(i,_){if(i&1&&o(0),i&2){let r=_.item;h(" ",r.NameAndCode," ")}}function de(i,_){i&1&&(a(0,"tr")(1,"th",32),o(2),c(3,"translate"),n(),a(4,"th",32),o(5),c(6,"translate"),n(),a(7,"th",32),o(8),c(9,"translate"),n(),a(10,"th",32),o(11),c(12,"translate"),n(),a(13,"th",32),o(14),c(15,"translate"),n(),a(16,"th",32),o(17),c(18,"translate"),n(),a(19,"th",32),o(20),c(21,"translate"),n(),a(22,"th",32),o(23),c(24,"translate"),n(),a(25,"th",32),o(26),c(27,"translate"),n(),a(28,"th",32),o(29),c(30,"translate"),n(),a(31,"th",32),o(32),c(33,"translate"),n(),a(34,"th",32),o(35,"-"),n()()),i&2&&(t(2),T(m(3,11,"Table.Name")),t(3),T(m(6,13,"Table.CreateDate")),t(3),T(m(9,15,"Table.Quantity")),t(3),T(m(12,17,"Table.Total")),t(3),T(m(15,19,"Table.Storage")),t(3),T(m(18,21,"Table.Type")),t(3),T(m(21,23,"Table.DocNo")),t(3),T(m(24,25,"Table.DocType")),t(3),T(m(27,27,"Table.QuntityCumulative")),t(3),T(m(30,29,"Table.WA")),t(3),T(m(33,31,"Table.TotalCumulative")))}function me(i,_){i&1&&(a(0,"span",35),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.In")," "))}function _e(i,_){i&1&&(a(0,"span",35),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.Out")," "))}function he(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.Sale")," "))}function ue(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.SaleReturn")," "))}function Se(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.Buy")," "))}function ge(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.BuyReturn")," "))}function Ie(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.Transfer")," "))}function Te(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.StoreAdjustmet")," "))}function fe(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.CreateInitGlRecept")," "))}function ve(i,_){i&1&&(a(0,"span",34),o(1),c(2,"translate"),n()),i&2&&(t(),h(" ",m(2,1,"DocType.TransferBanches")," "))}function Ce(i,_){if(i&1&&(a(0,"span",35),o(1),n()),i&2){let r=f().$implicit;t(),h(" ",r.OutInOutQty,"")}}function xe(i,_){if(i&1&&(a(0,"span",43),o(1),n()),i&2){let r=f().$implicit;t(),h(" ",r.OutInOutQty,"")}}function Me(i,_){if(i&1&&(a(0,"span",35),o(1),n()),i&2){let r=f().$implicit;t(),h(" ",r.OutInPrice.toFixed(2),"")}}function ye(i,_){if(i&1&&(a(0,"span",43),o(1),n()),i&2){let r=f().$implicit;t(),h(" ",r.OutInPrice.toFixed(2),"")}}function we(i,_){if(i&1){let r=M();a(0,"tr")(1,"td")(2,"span",34),o(3),n()(),a(4,"td")(5,"span",34),o(6),c(7,"date"),n()(),a(8,"td")(9,"span",35),o(10),n()(),a(11,"td")(12,"span",35),o(13),n()(),a(14,"td",36)(15,"span",34),o(16),n()(),a(17,"td"),v(18,me,3,3,"span",37)(19,_e,3,3,"span",37),n(),a(20,"td",38)(21,"span",35),o(22),n()(),a(23,"td"),v(24,he,3,3,"span",39)(25,ue,3,3,"span",40)(26,Se,3,3,"span",39)(27,ge,3,3,"span",39)(28,Ie,3,3,"span",39)(29,Te,3,3,"span",39)(30,fe,3,3,"span",40)(31,ve,3,3,"span",39),n(),a(32,"td"),v(33,Ce,2,1,"span",37)(34,xe,2,1,"span",41),n(),a(35,"td")(36,"span",35),o(37),n()(),a(38,"td"),v(39,Me,2,1,"span",37)(40,ye,2,1,"span",41),n(),a(41,"td")(42,"button",42),x("click",function(){let s=g(r).$implicit,e=f();return I(e._SharedObjectModelService.ShowDocument(s.DocType,s.DocNo))}),o(43),c(44,"translate"),n()()()}if(i&2){let r=_.$implicit,l=f();t(3),h(" ",r.ProductName,""),t(3),h(" ",O(7,23,r.DocDate,"d-M-yyyy h:mm:ss a")," "),t(4),h(" ",r.Qty,""),t(3),h(" ",r.TotalAfterVat.toFixed(2),""),t(3),h(" ",r.StoreName," "),t(2),u("ngIf",r.StockType==1),t(),u("ngIf",r.StockType==2),t(3),h(" ",r.DocNo," "),t(2),u("ngIf",r.DocType==1),t(),u("ngIf",r.DocType==2),t(),u("ngIf",r.DocType==3),t(),u("ngIf",r.DocType==4),t(),u("ngIf",r.DocType==5),t(),u("ngIf",r.DocType==11),t(),u("ngIf",r.DocType==12&&r.StockType==1),t(),u("ngIf",r.DocType==15),t(2),u("ngIf",r.OutInOutQty>=0),t(),u("ngIf",r.OutInOutQty<0),t(3),T(r.WA.toFixed(2)),t(2),u("ngIf",r.OutInPrice>=0),t(),u("ngIf",r.OutInPrice<0),t(2),u("disabled",l._AppModeService.DisabledButton),t(),h("",m(44,26,"Table.Show")," ")}}function De(i,_){if(i&1){let r=M();a(0,"p-paginator",44),x("onPageChange",function(s){g(r);let e=f();return I(e.onPageChange(s))}),n()}if(i&2){let r=f();u("first",r.first)("rows",r.rows)("totalRecords",r.Paging.TotalItems)("rowsPerPageOptions",r._Apiservice.RowCount)}}function be(i,_){if(i&1){let r=M();a(0,"p-paginator",45),x("onPageChange",function(s){g(r);let e=f();return I(e.onPageChange(s))}),n()}if(i&2){let r=f();u("first",r.first)("rows",r.rows)("totalRecords",r.Paging.TotalItems)}}var Je=(()=>{let _=class _{constructor(l,s,e){this._SharedObjectModelService=l,this._AppModeService=s,this._Apiservice=e,this.SubscriptionArr=[],this.Paging={PageSize:0,CurrentPage:0,TotalPages:0,TotalItems:0,DataReturn:void 0},this.SearchModel={FromDate:"",ToDate:"",StoreId:null,ProductId:null},this.Storages=[],this.Items=[],this.ItemBalance=0,this.AverageCost=0,this.TotalCapital=0,this.Arr=[],this.first=1,this.rows=10}ngOnInit(){this.SearchModel.FromDate=new Date(this._Apiservice.FromDate()),this.SearchModel.ToDate=new Date(this._Apiservice.ToNowDate())}ChangeSearchApi(l,s){let e=`${s.searchTerm}`.trim();(e==""||e=="null")&&(s.searchTerm="",e=""),this._AppModeService.CurrentPage+=1;let p={TableName:l,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:e,SearchField:"Name"};l=="Storages"&&(p.BranchFilter=!0),l=="Items"&&(p.Columns=["Id","Name","Code"],p.Conditions="ProductType != 2");let S=this._Apiservice.post("Global/GetAll",p,!1).subscribe({next:d=>{d.IsSuccess==!0&&d.Obj!=null?this.HandleResponse(d.Obj,l):this._AppModeService._Toastr.error(d.Message)}});this.SubscriptionArr.push(S)}HandleResponse(l,s){this._SharedObjectModelService.TotalItems=l.TotalItems,s=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(l.DataReturn),"Id")),s=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(l.DataReturn),"Id"),this.Items=this.Items.map(e=>B(E({},e),{NameAndCode:`${e.Name} - ${e.Code}`})))}SelectValue(l,s){if(l!=null&&(l>0||l!="")){let e=[];s=="Store"&&(e=this.Storages),s=="Product"&&(e=this.Items);let p=e.find(S=>S.Id==l);if(p==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${s}Id`]=l,this.SearchModel[`${s}Name`]=p.Name,s=="Branch"&&(this.SearchModel.StoreId=null)}else this.SearchModel[`${s}Id`]=null,this.SearchModel[`${s}Name`]=""}onPageChange(l){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}l.page++,l.first,l.rows,this.rows=l.rows,this.first=l.first;let s={CurrentPage:l.page,PageSize:l.rows,FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId},e=this._Apiservice.post("ItemEP/ProductTransaction",s,!0).subscribe({next:p=>{p.IsSuccess==!0?(console.log(p),this.Paging.CurrentPage=p.Obj.CurrentPage,this.Paging.TotalItems=p.Obj.TotalItems,this.Arr=p.Obj.DataReturn,this.ItemBalance=0,this.AverageCost=0,this.TotalCapital=0,this.ItemBalance=p.OutInQty,this.AverageCost=p.WA.toFixed(2),this.TotalCapital=p.OutInPrice.toFixed(2)):this._AppModeService._Toastr.error(p.Message)}});this.SubscriptionArr.push(e)}Search(){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}let l={FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId,CurrentPage:1,PageSize:this.rows};if(this._Apiservice.ValidateDate(l.FromDate,l.ToDate)==!1){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("StatementOfFinancial.Error.SmallDate"));return}let s=this._Apiservice.post("ItemEP/ProductTransaction",l,!0).subscribe({next:e=>{e.IsSuccess==!0?(this.Paging.CurrentPage=e.Obj.CurrentPage,this.Paging.TotalItems=e.Obj.TotalItems,this.Arr=e.Obj.DataReturn,this.ItemBalance=0,this.AverageCost=0,this.TotalCapital=0,this.ItemBalance=e.OutInQty,this.AverageCost=e.WA.toFixed(2),this.TotalCapital=e.OutInPrice.toFixed(2)):this._AppModeService._Toastr.error(e.Message)}});this.SubscriptionArr.push(s)}trackByMethod(l,s){return s.Id}ngOnDestroy(){for(let l=0;l<this.SubscriptionArr.length;l++)this.SubscriptionArr[l].unsubscribe()}};_.\u0275fac=function(s){return new(s||_)(b(ae),b(J),b(N))},_.\u0275cmp=V({type:_,selectors:[["app-item-transaction"]],standalone:!0,features:[F],decls:70,vars:59,consts:[["ddddd",""],["dddd",""],["SelectFromStore",""],["dt1",""],["clas","bg-light"],["id","container-page",1,"container-page","me-2"],[1,"page-wrapper"],[1,"main-content"],[1,"inner-box"],[1,"title-box","font-weight-normal"],[1,"d-flex","flex-wrap","justify-content-center","align-items-end"],[1,"col-12","col-md-2","px-1"],[1,"my-1"],[1,"formdate"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","showClear","appendTo","showOtherMonths","ngModel","showTime"],[1,"col-12","col-md-2","px-2"],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],[1,"col-12","col-md-3","px-2"],["for","Item"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-md-3","mx-auto","px-2","text-center"],[1,"btn","btn-success","mx-3","px-5","shadow-none",3,"click"],[1,"card","mt-4"],[3,"value","paginator","rows","tableStyle","globalFilterFields"],["pTemplate","header"],["pTemplate","body"],["appendTo","table",3,"first","rows","totalRecords","rowsPerPageOptions","onPageChange",4,"ngIf"],["appendTo","table",3,"first","rows","totalRecords","onPageChange",4,"ngIf"],[1,"table","table-striped","table-hover","my-0","d-none"],[1,"col-1"],[1,"form-text","text-muted"],[1,"text-dark"],[1,"text-dark","text-nowrap"],[1,""],["class","text-dark text-nowrap",4,"ngIf"],[1,"text-nowrap"],["class","text-dark ",4,"ngIf"],["class","text-dark",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-primary","text-white","shadow-none",3,"click","disabled"],[1,"text-danger"],["appendTo","table",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],["appendTo","table",3,"onPageChange","first","rows","totalRecords"]],template:function(s,e){if(s&1){let p=M();a(0,"section",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9),o(6),c(7,"translate"),n(),a(8,"div",10)(9,"div",11)(10,"p",12),o(11),c(12,"translate"),n(),a(13,"div",13,0)(15,"p-calendar",14),D("ngModelChange",function(d){return g(p),w(e.SearchModel.FromDate,d)||(e.SearchModel.FromDate=d),I(d)}),n()()(),a(16,"div",11)(17,"p",12),o(18),c(19,"translate"),n(),a(20,"div",13,1)(22,"p-calendar",14),D("ngModelChange",function(d){return g(p),w(e.SearchModel.ToDate,d)||(e.SearchModel.ToDate=d),I(d)}),n()()(),a(23,"div",15)(24,"p",16),o(25),c(26,"translate"),n(),a(27,"ng-select",17,2),x("clear",function(){return g(p),I(e.Storages=[])})("focus",function(){g(p);let d=C(28);return e.ChangeSearchApi("Storages",d),I(e._AppModeService.ResetCurrentPage())})("keyup",function(){g(p);let d=C(28);return e.ChangeSearchApi("Storages",d),I(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){g(p);let d=C(28);return I(e.ChangeSearchApi("Storages",d))})("close",function(){return g(p),I(e._AppModeService.ResetCurrentPage())})("open",function(){return g(p),I(e._AppModeService.ResetCurrentPage())})("change",function(){return g(p),I(e.SelectValue(e.SearchModel.StoreId,"Store"))}),D("ngModelChange",function(d){return g(p),w(e.SearchModel.StoreId,d)||(e.SearchModel.StoreId=d),I(d)}),v(29,le,2,2,"ng-template",18)(30,pe,1,1,"ng-template",19),n()(),a(31,"div",20)(32,"label",21),o(33),c(34,"translate"),n(),a(35,"ng-select",22,2),x("clear",function(){return g(p),I(e.Items=[])})("focus",function(){g(p);let d=C(28);return e.ChangeSearchApi("Items",d),I(e._AppModeService.ResetCurrentPage())})("keyup",function(){g(p);let d=C(28);return e.ChangeSearchApi("Items",d),I(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){g(p);let d=C(28);return I(e.ChangeSearchApi("Items",d))})("close",function(){return g(p),I(e._AppModeService.ResetCurrentPage())})("open",function(){return g(p),I(e._AppModeService.ResetCurrentPage())})("change",function(){return g(p),I(e.SelectValue(e.SearchModel.ProductId,"Product"))}),D("ngModelChange",function(d){return g(p),w(e.SearchModel.ProductId,d)||(e.SearchModel.ProductId=d),I(d)}),v(37,se,2,2,"ng-template",18)(38,ce,1,1,"ng-template",19),n()(),a(39,"div",23)(40,"button",24),x("click",function(){return g(p),I(e.Search())}),o(41),c(42,"translate"),n()()(),a(43,"div",25)(44,"p-table",26,3),v(46,de,36,33,"ng-template",27)(47,we,45,28,"ng-template",28),n(),v(48,De,1,4,"p-paginator",29)(49,be,1,3,"p-paginator",30),n(),a(50,"table",31)(51,"thead")(52,"tr")(53,"th",32),o(54),c(55,"translate"),n(),a(56,"th",32),o(57),c(58,"translate"),n(),a(59,"th",32),o(60),c(61,"translate"),n()()(),a(62,"tbody")(63,"tr")(64,"td"),o(65),n(),a(66,"td"),o(67),n(),a(68,"td"),o(69),n()()()()()()()()()}if(s&2){let p=C(14),S=C(21);t(6),h(" ",m(7,39,"ItemTransaction.ItemTransaction")," "),t(5),h(" ",m(12,41,"SupplierAccount.FromDate"),""),t(4),u("showClear",e.SearchModel.FromDate!=null&&e.SearchModel.FromDate!="")("appendTo",p)("showOtherMonths",!0),y("ngModel",e.SearchModel.FromDate),u("showTime",!0),t(3),h(" ",m(19,43,"SupplierAccount.ToDate"),""),t(4),u("showClear",e.SearchModel.ToDate!=null&&e.SearchModel.ToDate!="")("appendTo",S)("showOtherMonths",!0),y("ngModel",e.SearchModel.ToDate),u("showTime",!0),t(3),T(m(26,45,"BalanceItemBranch.Store")),t(2),u("items",e.Storages)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",e.SearchModel.StoreId),t(6),h(" ",m(34,47,"BalanceStorage.ItemId"),""),t(2),u("items",e.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",e.SearchModel.ProductId),t(6),T(m(42,49,"Model.Search")),t(3),u("value",e.Arr)("paginator",!1)("rows",e.rows)("tableStyle",A(57,re))("globalFilterFields",A(58,oe)),t(4),u("ngIf",e.Paging.TotalItems>=10),t(),u("ngIf",e.Paging.TotalItems<10),t(5),T(m(55,51,"ItemTransaction.ItemBalance")),t(3),T(m(58,53,"ItemTransaction.AverageCost")),t(3),T(m(61,55,"ItemTransaction.TotalCapital")),t(5),h(" ",e.ItemBalance," "),t(2),h(" ",e.AverageCost," "),t(2),h(" ",e.TotalCapital," ")}},dependencies:[Z,X,K,W,Q,te,ee,U,ne,ie,j,R,$,k,q,Y,H,G,L,z]});let i=_;return i})();export{Je as ItemTransactionComponent};
