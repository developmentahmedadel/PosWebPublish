import{g as ee,h as te,j as ae,s as re}from"./chunk-CCUNZCGD.js";import{a as oe}from"./chunk-6KCN6SOZ.js";import{a as ie,b as ne}from"./chunk-OFCF557E.js";import{i as Z}from"./chunk-PHRVA4P6.js";import"./chunk-5KZZH3PQ.js";import"./chunk-ENJ54XRO.js";import{a as Y,b as q,c as J,d as K}from"./chunk-ZWNSIIKM.js";import"./chunk-KZSRC3MR.js";import{k as X}from"./chunk-TQD4QWDO.js";import{c as z,d as L,g as U}from"./chunk-JS2GAZTB.js";import{F as W,I as $,aa as Q,d as k,da as G,i as N,na as H}from"./chunk-WSHLQXZC.js";import{$b as y,Cb as r,Db as n,Eb as B,Ib as C,Mb as x,Nb as f,Wb as M,X as b,Xb as o,Yb as T,Zb as m,_b as E,ac as w,bc as P,db as i,dc as j,eb as D,ec as A,na as F,nc as c,oc as d,pc as R,vb as v,xa as h,xb as u,ya as I}from"./chunk-J5UB44FZ.js";import{a as O,b as V}from"./chunk-3EYC4JTX.js";var le=()=>({"min-width":"50rem"}),pe=()=>["Name","Storage","Code"];function se(e,s){if(e&1&&(r(0,"small",30),o(1),n()),e&2){let a=f();i(),E("Loaded ",a.Storages.length," of ",a._SharedObjectModelService.TotalItems,"")}}function ce(e,s){if(e&1&&o(0),e&2){let a=s.item;m(" ",a.Name," ")}}function de(e,s){if(e&1&&(r(0,"small",30),o(1),n()),e&2){let a=f();i(),E("Loaded ",a.Items.length," of ",a._SharedObjectModelService.TotalItems,"")}}function me(e,s){if(e&1&&o(0),e&2){let a=s.item;m(" ",a.NameAndCode," ")}}function _e(e,s){e&1&&(r(0,"tr")(1,"th",31),o(2),c(3,"translate"),n(),r(4,"th",31),o(5," \u0627\u0644\u062C\u0647\u0629 "),n(),r(6,"th",31),o(7),c(8,"translate"),n(),r(9,"th",31),o(10),c(11,"translate"),n(),r(12,"th",31),o(13),c(14,"translate"),n(),r(15,"th",31),o(16),c(17,"translate"),n(),r(18,"th",31),o(19),c(20,"translate"),n(),r(21,"th",31),o(22),c(23,"translate"),n(),r(24,"th",31),o(25),c(26,"translate"),n(),r(27,"th",31),o(28),c(29,"translate"),n(),r(30,"th",31),o(31),c(32,"translate"),n(),r(33,"th",31),o(34),c(35,"translate"),n(),r(36,"th",31),o(37,"-"),n()()),e&2&&(i(2),T(d(3,11,"Table.Name")),i(5),T(d(8,13,"Table.DocDate")),i(3),T(d(11,15,"Table.Quantity")),i(3),T(d(14,17,"Table.Total")),i(3),T(d(17,19,"Table.Storage")),i(3),T(d(20,21,"Table.Type")),i(3),T(d(23,23,"Table.DocNo")),i(3),T(d(26,25,"Table.DocType")),i(3),T(d(29,27,"Table.QuntityCumulative")),i(3),T(d(32,29,"Table.WA")),i(3),T(d(35,31,"Table.TotalCumulative")))}function Se(e,s){e&1&&(r(0,"span",33),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.In")," "))}function ge(e,s){e&1&&(r(0,"span",33),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.Out")," "))}function ue(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.Sale")," "))}function he(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.SaleReturn")," "))}function Ie(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.Buy")," "))}function Te(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.BuyReturn")," "))}function fe(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.Transfer")," "))}function ve(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.StoreAdjustmet")," "))}function xe(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.CreateInitGlRecept")," "))}function Me(e,s){e&1&&(r(0,"span",32),o(1),c(2,"translate"),n()),e&2&&(i(),m(" ",d(2,1,"DocType.TransferBanches")," "))}function Ce(e,s){if(e&1&&(r(0,"span",33),o(1),n()),e&2){let a=f().$implicit;i(),m(" ",a.OutInOutQty.toFixed(2),"")}}function ye(e,s){if(e&1&&(r(0,"span",42),o(1),n()),e&2){let a=f().$implicit;i(),m(" ",a.OutInOutQty.toFixed(2),"")}}function we(e,s){if(e&1&&(r(0,"span",33),o(1),n()),e&2){let a=f().$implicit;i(),m(" ",a.OutInPrice.toFixed(2),"")}}function Pe(e,s){if(e&1&&(r(0,"span",42),o(1),n()),e&2){let a=f().$implicit;i(),m(" ",a.OutInPrice.toFixed(2),"")}}function be(e,s){if(e&1){let a=C();r(0,"tr")(1,"td")(2,"span",32),o(3),n()(),r(4,"td")(5,"span",32),o(6),n()(),r(7,"td")(8,"span",32),o(9),c(10,"date"),n()(),r(11,"td")(12,"span",33),o(13),n()(),r(14,"td")(15,"span",33),o(16),n()(),r(17,"td",34)(18,"span",32),o(19),n()(),r(20,"td"),v(21,Se,3,3,"span",35)(22,ge,3,3,"span",35),n(),r(23,"td",36)(24,"span",33),o(25),n()(),r(26,"td"),v(27,ue,3,3,"span",37)(28,he,3,3,"span",38)(29,Ie,3,3,"span",37)(30,Te,3,3,"span",37)(31,fe,3,3,"span",37)(32,ve,3,3,"span",37)(33,xe,3,3,"span",38)(34,Me,3,3,"span",37),n(),r(35,"td"),v(36,Ce,2,1,"span",35)(37,ye,2,1,"span",39),n(),r(38,"td")(39,"span",33),o(40),n()(),r(41,"td"),v(42,we,2,1,"span",35)(43,Pe,2,1,"span",39),n(),r(44,"td")(45,"button",40),x("click",function(){let l=h(a).$implicit,t=f();return I(t._SharedObjectModelService.ShowDocument(l.DocType,l.DocNo))}),o(46),c(47,"translate"),B(48,"i",41),n()()()}if(e&2){let a=s.$implicit,p=f();i(3),m(" ",a.ProductName,""),i(3),m(" ",a.Notes,""),i(3),m(" ",R(10,24,a.DocDate,"d-M-yyyy h:mm:ss a")," "),i(4),m(" ",a.Qty,""),i(3),m(" ",a.TotalAfterVat.toFixed(2),""),i(3),m(" ",a.StoreName," "),i(2),u("ngIf",a.StockType==1),i(),u("ngIf",a.StockType==2),i(3),m(" ",a.DocNo," "),i(2),u("ngIf",a.DocType==1),i(),u("ngIf",a.DocType==2),i(),u("ngIf",a.DocType==3),i(),u("ngIf",a.DocType==4),i(),u("ngIf",a.DocType==5),i(),u("ngIf",a.DocType==11),i(),u("ngIf",a.DocType==12&&a.StockType==1),i(),u("ngIf",a.DocType==15),i(2),u("ngIf",a.OutInOutQty>=0),i(),u("ngIf",a.OutInOutQty<0),i(3),T(a.WA.toFixed(2)),i(2),u("ngIf",a.OutInPrice>=0),i(),u("ngIf",a.OutInPrice<0),i(2),u("disabled",p._AppModeService.DisabledButton),i(),m("",d(47,27,"Table.Show")," ")}}function De(e,s){if(e&1){let a=C();r(0,"p-paginator",43),x("onPageChange",function(l){h(a);let t=f();return I(t.onPageChange(l))}),n()}if(e&2){let a=f();u("first",a._SharedObjectModelService.Paging.CurrentPage)("rows",a._SharedObjectModelService.Paging.PageSize)("totalRecords",a._SharedObjectModelService.Paging.TotalItems)("rowsPerPageOptions",a._Apiservice.RowCount)}}function Ee(e,s){if(e&1){let a=C();r(0,"p-paginator",44),x("onPageChange",function(l){h(a);let t=f();return I(t.onPageChange(l))}),n()}if(e&2){let a=f();u("first",a._SharedObjectModelService.Paging.CurrentPage)("rows",a._SharedObjectModelService.Paging.PageSize)("totalRecords",a._SharedObjectModelService.Paging.PageSize)}}var Xe=(()=>{let s=class s{constructor(p,l,t){this._SharedObjectModelService=p,this._AppModeService=l,this._Apiservice=t,this.SearchModel={FromDate:"",ToDate:"",StoreId:null,ProductId:null},this.Storages=[],this.Items=[]}ngOnInit(){this.SearchModel.FromDate=new Date(this._Apiservice.FromDate()),this.SearchModel.ToDate=new Date(this._Apiservice.ToNowDate())}ChangeSearchApi(p,l){let t=`${l.searchTerm}`.trim();(t==""||t=="null")&&(l.searchTerm="",t=""),this._AppModeService.CurrentPage+=1;let _={TableName:p,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:t,SearchField:"Name"};p=="Storages"&&(_.BranchFilter=!0),p=="Items"&&(_.Columns=["Id","Name","Code"],_.Conditions="ProductType != 2"),this._Apiservice.post("Global/GetAll",_,!1).pipe(b(this._Apiservice.destroy$)).subscribe({next:g=>{g.IsSuccess==!0&&g.Obj!=null?this.HandleResponse(g.Obj,p):this._AppModeService._Toastr.error(g.Message)}})}HandleResponse(p,l){this._SharedObjectModelService.TotalItems=p.TotalItems,l=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(p.DataReturn),"Id")),l=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(p.DataReturn),"Id"),this.Items=this.Items.map(t=>V(O({},t),{NameAndCode:`${t.Name} - ${t.Code}`})))}SelectValue(p,l){if(p!=null&&(p>0||p!="")){let t=[];l=="Store"&&(t=this.Storages),l=="Product"&&(t=this.Items);let _=t.find(g=>g.Id==p);if(_==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${l}Id`]=p,this.SearchModel[`${l}Name`]=_.Name,l=="Branch"&&(this.SearchModel.StoreId=null)}else this.SearchModel[`${l}Id`]=null,this.SearchModel[`${l}Name`]=""}onPageChange(p){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}p.page++,p.first,p.rows,this._SharedObjectModelService.Paging.CurrentPage=p.first,this._SharedObjectModelService.Paging.PageSize=p.rows;let l={CurrentPage:p.page,PageSize:this._SharedObjectModelService.Paging.PageSize,FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId};this._Apiservice.post("ItemEP/ProductTransaction",l,!0).pipe(b(this._Apiservice.destroy$)).subscribe({next:t=>{t.IsSuccess==!0?(this._SharedObjectModelService.Paging.DataReturn=t.Obj.DataReturn,this._SharedObjectModelService.Paging.TotalItems=t.Obj.TotalItems):this._AppModeService._Toastr.error(t.Message)}})}Search(){if(this.SearchModel.FromDate==null||`${this.SearchModel.FromDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.FromDate"));return}if(this.SearchModel.ToDate==null||`${this.SearchModel.ToDate}`.trim()==""){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("Interval.Error.ToDate"));return}this._SharedObjectModelService.Paging.CurrentPage=1;let p={FromDate:this._Apiservice.ConvertISODate(this.SearchModel.FromDate),ToDate:this._Apiservice.ConvertISODate(this.SearchModel.ToDate),StoreId:this.SearchModel.StoreId==null?0:this.SearchModel.StoreId,ProductId:this.SearchModel.ProductId==null?0:this.SearchModel.ProductId,CurrentPage:1,PageSize:this._SharedObjectModelService.Paging.PageSize};if(this._Apiservice.ValidateDate(p.FromDate,p.ToDate)==!1){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("StatementOfFinancial.Error.SmallDate"));return}this._Apiservice.post("ItemEP/ProductTransaction",p,!0).pipe(b(this._Apiservice.destroy$)).subscribe({next:l=>{l.IsSuccess==!0?(this._SharedObjectModelService.Paging.DataReturn=l.Obj.DataReturn,this._SharedObjectModelService.Paging.TotalItems=l.Obj.TotalItems):this._AppModeService._Toastr.error(l.Message)}})}trackByMethod(p,l){return l.Id}ngOnDestroy(){this._Apiservice.destroy$.next(),this._Apiservice.destroy$.complete()}};s.\u0275fac=function(l){return new(l||s)(D(oe),D(U),D($))},s.\u0275cmp=F({type:s,selectors:[["app-item-transaction"]],standalone:!0,features:[j],decls:49,vars:47,consts:[["SelectFromStore",""],["dt1",""],["clas","bg-light"],["id","container-page",1,"container-page","me-2"],[1,"page-wrapper"],[1,"main-content"],[1,"inner-box"],[1,"title-box","font-weight-normal"],[1,"PageTitle","fs-1","fw-bold","px-2"],[1,"d-flex","flex-wrap","justify-content-center","align-items-end"],[1,"col-12","col-md-2","px-1"],[1,"my-1"],[1,"formdate"],["placeholder","D-M-Y","dateFormat","dd-mm-yy","hourFormat","12",1,"shadow-none","text-center","w-100",3,"ngModelChange","ngModel","showTime","showIcon","showOnFocus","showOtherMonths"],[1,"col-12","col-md-2","px-2"],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],[1,"col-12","col-md-3","px-2"],["for","Item"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-md-3","mx-auto","mt-4","mt-md-0","p-2","text-center"],[1,"btn","btn-primary","py-3","mx-3","px-5","shadow-none",3,"click"],[1,"col-12","card","p-0","table-responsive","mt-4"],[3,"value","paginator","rows","tableStyle","globalFilterFields"],["pTemplate","header"],["pTemplate","body"],["appendTo","table",3,"first","rows","totalRecords","rowsPerPageOptions","onPageChange",4,"ngIf"],["appendTo","table",3,"first","rows","totalRecords","onPageChange",4,"ngIf"],[1,"form-text","text-muted"],[1,"col-1"],[1,"text-dark"],[1,"text-dark","text-nowrap"],[1,""],["class","text-dark text-nowrap",4,"ngIf"],[1,"text-nowrap"],["class","text-dark ",4,"ngIf"],["class","text-dark",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-primary","text-white","shadow-none",3,"click","disabled"],[1,"mx-1","pi","pi-search"],[1,"text-danger"],["appendTo","table",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],["appendTo","table",3,"onPageChange","first","rows","totalRecords"]],template:function(l,t){if(l&1){let _=C();r(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"i",8),o(7),c(8,"translate"),n()(),r(9,"div",9)(10,"div",10)(11,"p",11),o(12),c(13,"translate"),n(),r(14,"div",12)(15,"p-calendar",13),P("ngModelChange",function(S){return h(_),w(t.SearchModel.FromDate,S)||(t.SearchModel.FromDate=S),I(S)}),n()()(),r(16,"div",10)(17,"p",11),o(18),c(19,"translate"),n(),r(20,"div",12)(21,"p-calendar",13),P("ngModelChange",function(S){return h(_),w(t.SearchModel.ToDate,S)||(t.SearchModel.ToDate=S),I(S)}),n()()(),r(22,"div",14)(23,"p",15),o(24),c(25,"translate"),n(),r(26,"ng-select",16,0),x("clear",function(){return h(_),I(t.Storages=[])})("focus",function(){h(_);let S=M(27);return t.ChangeSearchApi("Storages",S),I(t._AppModeService.ResetCurrentPage())})("keyup",function(){h(_);let S=M(27);return t.ChangeSearchApi("Storages",S),I(t._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){h(_);let S=M(27);return I(t.ChangeSearchApi("Storages",S))})("close",function(){return h(_),I(t._AppModeService.ResetCurrentPage())})("open",function(){return h(_),I(t._AppModeService.ResetCurrentPage())})("change",function(){return h(_),I(t.SelectValue(t.SearchModel.StoreId,"Store"))}),P("ngModelChange",function(S){return h(_),w(t.SearchModel.StoreId,S)||(t.SearchModel.StoreId=S),I(S)}),v(28,se,2,2,"ng-template",17)(29,ce,1,1,"ng-template",18),n()(),r(30,"div",19)(31,"label",20),o(32),c(33,"translate"),n(),r(34,"ng-select",21,0),x("clear",function(){return h(_),I(t.Items=[])})("focus",function(){h(_);let S=M(27);return t.ChangeSearchApi("Items",S),I(t._AppModeService.ResetCurrentPage())})("keyup",function(){h(_);let S=M(27);return t.ChangeSearchApi("Items",S),I(t._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){h(_);let S=M(27);return I(t.ChangeSearchApi("Items",S))})("close",function(){return h(_),I(t._AppModeService.ResetCurrentPage())})("open",function(){return h(_),I(t._AppModeService.ResetCurrentPage())})("change",function(){return h(_),I(t.SelectValue(t.SearchModel.ProductId,"Product"))}),P("ngModelChange",function(S){return h(_),w(t.SearchModel.ProductId,S)||(t.SearchModel.ProductId=S),I(S)}),v(36,de,2,2,"ng-template",17)(37,me,1,1,"ng-template",18),n()(),r(38,"div",22)(39,"button",23),x("click",function(){return h(_),I(t.Search())}),o(40),c(41,"translate"),n()()(),r(42,"div",24)(43,"p-table",25,1),v(45,_e,38,33,"ng-template",26)(46,be,49,29,"ng-template",27),n(),v(47,De,1,4,"p-paginator",28)(48,Ee,1,3,"p-paginator",29),n()()()()()()}l&2&&(i(7),T(d(8,33,"ItemTransaction.ItemTransaction")),i(5),m(" ",d(13,35,"SupplierAccount.FromDate"),""),i(3),y("ngModel",t.SearchModel.FromDate),u("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),i(3),m(" ",d(19,37,"SupplierAccount.ToDate"),""),i(3),y("ngModel",t.SearchModel.ToDate),u("showTime",!0)("showIcon",!0)("showOnFocus",!0)("showOtherMonths",!0),i(3),T(d(25,39,"BalanceItemBranch.Store")),i(2),u("items",t.Storages)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",t.SearchModel.StoreId),i(6),m(" ",d(33,41,"BalanceStorage.ItemId"),""),i(2),u("items",t.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),y("ngModel",t.SearchModel.ProductId),i(6),T(d(41,43,"Model.Search")),i(3),u("value",t._SharedObjectModelService.Paging.DataReturn)("paginator",!1)("rows",t._SharedObjectModelService.Paging.PageSize)("tableStyle",A(45,le))("globalFilterFields",A(46,pe)),i(4),u("ngIf",t._SharedObjectModelService.Paging.TotalItems>=10),i(),u("ngIf",t._SharedObjectModelService.Paging.TotalItems<10))},dependencies:[te,ee,X,Q,G,ne,ie,Z,re,ae,W,k,H,N,L,z,K,J,Y,q]});let e=s;return e})();export{Xe as ItemTransactionComponent};
