import{a as K}from"./chunk-JZVD3M6G.js";import{a as H,b as $,c as G,d as U}from"./chunk-DVVEKPVL.js";import{b as J}from"./chunk-GTD5WNPP.js";import{c as N,h as L,k as W,u as Q}from"./chunk-M24M3PNC.js";import{c as q,d as z}from"./chunk-4L6P5Z5M.js";import{G as D,d as k}from"./chunk-JM67XKKX.js";import{$b as V,Bb as d,Cb as h,Hb as F,Lb as M,Mb as w,Sb as x,Tb as R,Ub as O,Vb as u,Wb as _,Xb as I,Yb as f,Zb as T,_b as b,ac as A,cb as m,cc as j,db as v,mc as S,na as E,nc as g,ub as B,wb as C,xa as a,ya as o}from"./chunk-VIO7ZK3G.js";import{a as y,b as P}from"./chunk-3EYC4JTX.js";var X=["SelectItems"];function Y(c,s){if(c&1&&(d(0,"small",22),_(1),h()),c&2){let p=w();m(),T("Loaded ",p.Branches.length," of ",p._SharedObjectModelService.TotalItems,"")}}function Z(c,s){if(c&1&&_(0),c&2){let p=s.item;f(" ",p.Name," ")}}function ee(c,s){if(c&1&&(d(0,"small",22),_(1),h()),c&2){let p=w();m(),T("Loaded ",p.Storages.length," of ",p._SharedObjectModelService.TotalItems,"")}}function te(c,s){if(c&1&&_(0),c&2){let p=s.item;f(" ",p.Name,`
`)}}function ne(c,s){if(c&1&&(d(0,"small",22),_(1),h()),c&2){let p=w();m(),T("Loaded ",p.Items.length," of ",p._SharedObjectModelService.TotalItems,"")}}function re(c,s){if(c&1&&_(0),c&2){let p=s.item;f(" ",p.NameAndCode,`
`)}}function ie(c,s){if(c&1&&(d(0,"tr")(1,"td")(2,"span"),_(3),h()(),d(4,"td"),_(5),h()()),c&2){let p=s.$implicit;m(3),f(" ",p.UnitName," "),m(2),f(" ",p.Qty,"")}}var ge=(()=>{let s=class s{constructor(l,r,e){this._SharedObjectModelService=l,this._AppModeService=r,this._Apiservice=e,this.SubscriptionArr=[],this.SearchModel={BranchId:null,StoreId:null,ProductId:null},this.ItemBalanceFrom=[],this.Branches=[],this.Storages=[],this.Items=[]}ngOnInit(){}ChangeSearchApi(l,r){let e=`${r.searchTerm}`.trim();(e==""||e=="null")&&(r.searchTerm="",e=""),this._AppModeService.CurrentPage+=1;let t={TableName:l,Columns:["Id","Name"],Conditions:"",PageSize:this._AppModeService.TabTake,CurrentPage:this._AppModeService.CurrentPage,SearchText:e,SearchField:"Name"};l=="Storages"&&(t.Conditions=`BranchId = ${this.SearchModel.BranchId}`),l=="Items"&&(t.Columns=["Id","Name","Code"],t.Conditions="ProductType != 2");let i=this._Apiservice.post("Global/GetAll",t,!1).subscribe({next:n=>{n.IsSuccess==!0&&n.Obj!=null?this.HandleResponse(n.Obj,l):this._AppModeService._Toastr.error(n.Message)}});this.SubscriptionArr.push(i)}HandleResponse(l,r){this._SharedObjectModelService.TotalItems=l.TotalItems,r=="Branch"&&(this.Branches=this._SharedObjectModelService.RemoveDuplicates(this.Branches.concat(l.DataReturn),"Id")),r=="Storages"&&(this.Storages=this._SharedObjectModelService.RemoveDuplicates(this.Storages.concat(l.DataReturn),"Id")),r=="Items"&&(this.Items=this._SharedObjectModelService.RemoveDuplicates(this.Items.concat(l.DataReturn),"Id"),this.Items=this.Items.map(e=>P(y({},e),{NameAndCode:`${e.Name} - ${e.Code}`})))}SelectValue(l,r){if(l!=null&&(l>0||l!="")){let e=[];r=="Branch"&&(e=this.Branches),r=="Store"&&(e=this.Storages),r=="Product"&&(e=this.Items);let t=e.find(i=>i.Id==l);if(t==null){this._AppModeService.DontPlay();return}else this.SearchModel[`${r}Id`]=l,this.SearchModel[`${r}Name`]=t.Name}else this.SearchModel[`${r}Id`]=null,this.SearchModel[`${r}Name`]="";r=="Branch"&&(this.SearchModel.StoreId=null,this.Storages=[])}Search(){if(this.SearchModel.BranchId==0||this.SearchModel.BranchId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.BranchId"));return}if(this.SearchModel.StoreId==0||this.SearchModel.StoreId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.StoreId"));return}if(this.SearchModel.ProductId==0||this.SearchModel.ProductId==null){this._AppModeService._Toastr.error(this._AppModeService._Translate.instant("BalanceItemBranch.Error.SelectItem"));return}let l=this._Apiservice.post("ItemEP/ProductBalance",this.SearchModel,!0).subscribe({next:r=>{r.IsSuccess==!0&&r.Obj!=null?(console.log(r.Obj),this.ItemBalanceFrom=r.Obj.StorageBalance):this._AppModeService._Toastr.error(r.Message)}});this.SubscriptionArr.push(l)}ngOnDestroy(){for(let l=0;l<this.SubscriptionArr.length;l++)this.SubscriptionArr[l].unsubscribe()}};s.\u0275fac=function(r){return new(r||s)(v(K),v(J),v(N))},s.\u0275cmp=E({type:s,selectors:[["app-balance-item-branch"]],viewQuery:function(r,e){if(r&1&&x(X,5),r&2){let t;R(t=O())&&(e.ngSelectComponent=t.first)}},standalone:!0,features:[j],decls:48,vars:38,consts:[["Select1",""],["SelectFromStore",""],["clas","bg-light"],["id","container-page",1,"container-page","p-0"],[1,"page-wrapper"],[1,"main-content"],[1,"inner-box","p"],[1,"title-box","font-weight-normal"],[1,"d-flex","flex-wrap","align-items-end","mb-3"],[1,"col-12","col-sm-6","col-md-3","px-2"],[1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","change","scrollToEnd","close","open","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],["ng-header-tmp",""],["ng-option-tmp",""],["for","FromStoreId",1,"my-1"],["placeholder","Search","bindLabel","Name","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","disabled","virtualScroll","searchable","ngModel"],["placeholder","Search","bindLabel","NameAndCode","bindValue","Id",1,"p-0","text-center",3,"clear","focus","keyup","scrollToEnd","close","open","change","ngModelChange","items","autofocus","virtualScroll","searchable","ngModel"],[1,"col-12","col-sm-6","col-md-3","px-2","text-center"],[1,"btn","btn-success","mx-2","px-5","py-3","shadow-none","Save",3,"click"],[1,"table","table-striped","table-hover"],[1,"col-2"],[4,"ngFor","ngForOf"],[1,"form-text","text-muted"]],template:function(r,e){if(r&1){let t=F();d(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7),_(6),S(7,"translate"),h(),d(8,"div",8)(9,"div",9)(10,"p",10),_(11),S(12,"translate"),h(),d(13,"ng-select",11,0),M("clear",function(){return a(t),o(e.Branches=[])})("focus",function(){a(t);let n=u(14);return o(e.ChangeSearchApi("Branch",n))})("keyup",function(){a(t);let n=u(14);return o(e.ChangeSearchApi("Branch",n))})("change",function(){a(t);let n=u(14);return o(e.ChangeSearchApi("Branch",n))})("scrollToEnd",function(){a(t);let n=u(14);return o(e.ChangeSearchApi("Branch",n))})("close",function(){return a(t),o(e._AppModeService.CurrentPage=0)})("open",function(){return a(t),o(e._AppModeService.CurrentPage=0)})("change",function(){return a(t),o(e.SelectValue(e.SearchModel.BranchId,"Branch"))}),A("ngModelChange",function(n){return a(t),V(e.SearchModel.BranchId,n)||(e.SearchModel.BranchId=n),o(n)}),B(15,Y,2,2,"ng-template",12)(16,Z,1,1,"ng-template",13),h()(),d(17,"div",9)(18,"p",14),_(19),S(20,"translate"),h(),d(21,"ng-select",15,1),M("clear",function(){return a(t),o(e.Storages=[])})("focus",function(){a(t);let n=u(22);return e.ChangeSearchApi("Storages",n),o(e._AppModeService.ResetCurrentPage())})("keyup",function(){a(t);let n=u(22);return e.ChangeSearchApi("Storages",n),o(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){a(t);let n=u(22);return o(e.ChangeSearchApi("Storages",n))})("close",function(){return a(t),o(e._AppModeService.ResetCurrentPage())})("open",function(){return a(t),o(e._AppModeService.ResetCurrentPage())})("change",function(){return a(t),o(e.SelectValue(e.SearchModel.StoreId,"Store"))}),A("ngModelChange",function(n){return a(t),V(e.SearchModel.StoreId,n)||(e.SearchModel.StoreId=n),o(n)}),B(23,ee,2,2,"ng-template",12)(24,te,1,1,"ng-template",13),h()(),d(25,"div",9)(26,"p",14),_(27),S(28,"translate"),h(),d(29,"ng-select",16,1),M("clear",function(){return a(t),o(e.Items=[])})("focus",function(){a(t);let n=u(22);return e.ChangeSearchApi("Items",n),o(e._AppModeService.ResetCurrentPage())})("keyup",function(){a(t);let n=u(22);return e.ChangeSearchApi("Items",n),o(e._AppModeService.ResetCurrentPage())})("scrollToEnd",function(){a(t);let n=u(22);return o(e.ChangeSearchApi("Items",n))})("close",function(){return a(t),o(e._AppModeService.ResetCurrentPage())})("open",function(){return a(t),o(e._AppModeService.ResetCurrentPage())})("change",function(){return a(t),o(e.SelectValue(e.SearchModel.ProductId,"Product"))}),A("ngModelChange",function(n){return a(t),V(e.SearchModel.ProductId,n)||(e.SearchModel.ProductId=n),o(n)}),B(31,ne,2,2,"ng-template",12)(32,re,1,1,"ng-template",13),h()(),d(33,"div",17)(34,"button",18),M("click",function(){return a(t),o(e.Search())}),_(35),S(36,"translate"),h()()(),d(37,"table",19)(38,"thead")(39,"tr")(40,"th",20),_(41),S(42,"translate"),h(),d(43,"th",20),_(44),S(45,"translate"),h()()(),d(46,"tbody"),B(47,ie,6,2,"tr",21),h()()()()()()()}r&2&&(m(6),f(" ",g(7,24,"BalanceItemBranch.BalanceItemBranch")," "),m(5),I(g(12,26,"BalanceItemBranch.Branch")),m(2),C("items",e.Branches)("autofocus",!1)("virtualScroll",!0)("searchable",!0),b("ngModel",e.SearchModel.BranchId),m(6),I(g(20,28,"BalanceItemBranch.Store")),m(2),C("items",e.Storages)("autofocus",!1)("disabled",e.SearchModel.BranchId==null)("virtualScroll",!0)("searchable",!0),b("ngModel",e.SearchModel.StoreId),m(6),I(g(28,30,"Table.Item")),m(2),C("items",e.Items)("autofocus",!1)("virtualScroll",!0)("searchable",!0),b("ngModel",e.SearchModel.ProductId),m(6),I(g(36,32,"Model.Search")),m(6),I(g(42,34,"Table.Name")),m(3),I(g(45,36,"Table.No")),m(3),C("ngForOf",e.ItemBalanceFrom))},dependencies:[D,k,Q,L,W,z,q,U,G,H,$],styles:[".inner-box[_ngcontent-%COMP%]{min-height:90vh}"]});let c=s;return c})();export{ge as BalanceItemBranchComponent};
